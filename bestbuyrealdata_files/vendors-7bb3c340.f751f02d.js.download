"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[3274],{17896:(e,t,s)=>{s.r(t),s.d(t,{ApiCommunicationProvider:()=>ct,ApiContactUsProvider:()=>lt,BadRequestError:()=>p,ChatContext:()=>rt,ChatInProgressDots:()=>f,Confirmation:()=>S,ConnectionError:()=>h,ConversationType:()=>oe,GenesysChatContext:()=>it,GenesysChatProvider:()=>at,LiveAgent:()=>P,MessageItem:()=>V,MessageStatus:()=>I,Newsletter:()=>ne,NewsletterProvider:()=>mt,NotFoundError:()=>E,OrderCommunicationsForm:()=>Ce,OrderMessageRoleEnum:()=>T,OrderMessageSellerEnum:()=>w,ReplyBox:()=>Le,SendOrderMessageType:()=>ie,UnauthorizedError:()=>b,Unsubscribe:()=>He,UpdatePreferences:()=>je,chatEvents:()=>N,filterCustomerMessages:()=>H,replyBoxformItemName:()=>Ne,sanitizeMessage:()=>U,useGenesysChat:()=>st,useGenesysChatContext:()=>nt});var r,a=s(67294),n=s(36032),i=s(97132),o=s(91036),c=s(69590),l=s(31330);class m extends Error{constructor(e,t,s,r){super(t),this.uri=e,this.statusCode=r,this.name="HttpRequestError",this.statusCode=r,Object.setPrototypeOf(this,m.prototype)}}!function(e){e[e.OK=200]="OK",e[e.Created=201]="Created",e[e.NoContent=204]="NoContent",e[e.MultiStatus=207]="MultiStatus",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.InternalServerError=500]="InternalServerError"}(r||(r={}));var d,u=r;class p extends m{constructor(e,t,s){super(e,t,s,u.BadRequest),this.uri=e,this.name="BadRequestError",Object.setPrototypeOf(this,p.prototype)}}class h extends m{constructor(e,t,s,r,a){super(e,t,s),this.uri=e,this.headers=r,this.cookies=a,this.name="ConnectionError",Object.setPrototypeOf(this,h.prototype)}}class g extends m{constructor(e,t,s,a,n){super(e,t,s,r.InternalServerError),this.uri=e,this.headers=a,this.cookies=n,this.name="InternalServerError",Object.setPrototypeOf(this,g.prototype)}}class E extends m{constructor(e,t,s){super(e,t,s,r.NotFound),this.uri=e,this.name="NotFoundError",Object.setPrototypeOf(this,E.prototype)}}class b extends m{constructor(e,t,s){super(e,t,s,r.Unauthorized),this.uri=e,this.name="UnauthorizedError",Object.setPrototypeOf(this,b.prototype)}}!function(e){e[e.OK=200]="OK",e[e.MultiStatus=207]="MultiStatus",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.InternalServerError=500]="InternalServerError"}(d||(d={}));var A={dotsContainer:"dotsContainer__comSrq",light:"light__comDN3",dot:"dot__comICu",typingLightAnimation:"typingLightAnimation__comdZh",dark:"dark__comOGf",typingDarkAnimation:"typingDarkAnimation__comHme"};const f=e=>{let{className:t="",colourTheme:s="light"}=e;return a.createElement("div",{className:`${A.dotsContainer} ${A[s]} ${t}`},a.createElement("span",{className:A.dot}),a.createElement("span",{className:A.dot}),a.createElement("span",{className:A.dot}))};var _="startShoppingLink__comSPp",C="chevronIcon__comTyZ",v="formHeader__com1Og",y="formDescription__comZAw";const S=e=>{const{title:t,confirmationMessage:s,shoppingLinkProps:r,shoppingLinkText:i,showShoppingLink:o=!0}=e;return a.createElement(a.Fragment,null,a.createElement("h1",{className:v,"data-automation":"communications-confirmation-header"},t),a.createElement("div",{className:y,"data-automation":"communications-confirmation-message"},s),o&&a.createElement("div",{className:_,"data-automation":"communications-confirmation-startShoppingLink"},a.createElement("a",{target:"_top",href:r.href},i),a.createElement(n._Qn,{className:C,color:"blue"})))};var L,N,T,w,I,M=Object.freeze({__proto__:null,default:"data:image/png;base64,/9j/4AAQSkZJRgABAgAAZABkAAD/7AARRHVja3kAAQAEAAAAPAAA/+4ADkFkb2JlAGTAAAAAAf/bAIQABgQEBAUEBgUFBgkGBQYJCwgGBggLDAoKCwoKDBAMDAwMDAwQDA4PEA8ODBMTFBQTExwbGxscHx8fHx8fHx8fHwEHBwcNDA0YEBAYGhURFRofHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8fHx8f/8AAEQgAKAAoAwERAAIRAQMRAf/EAH4AAAEFAQAAAAAAAAAAAAAAAAAEBQYHCAMBAQEBAQEBAAAAAAAAAAAAAAABAgMEBhAAAgEDAwIEBAcBAAAAAAAAAQIDEQQFABIGIRMxIiMHcRQVCFFhoTJCUkMXEQACAgECBgMAAAAAAAAAAAAAAQISBBEDITFBUWEGcYEU/9oADAMBAAIRAxEAPwDVOgDQBoA0AaAjvP8Am2P4Vxi45DfwS3NtbPGjwwbe4TK4jFN5UdC346qWpG9Ctj91PDxaSSth8mtzFcRW7WpSHd66O6MG7m3/ADIpWv601QzcUZD7lcNZx2Ubccyn1G+kkWDHssSyGOML6ikOwbcxZVA61U/lWVFxx/7sByiHjMnDs7DlZx3I4Hih3djeUM9FkasYKmrCo6aVLYtLWTRDPd/h1xzDgWQwlvcpaSSGKbvSKWAEEglIoKdSFpqxejJJaoxxHaYLJq831C6si6tdx2v01IrKYWEDFtgS5dWl2qfFQKk1brrqciScmhkk43jMNNMssHyDZ6OOyw9qGhsroxkt3PmFkV1aNi6p5adST/GIrLQ4BkOJ3HujgbvGZp76w47xm2xlzkrhY4oWlmZ3iQyvLUSnvbe1tJBUivlOsvkaXM0NrBs5XkLT2k8KkBpY2QE+ALKRoDNeF+07kSyQxZLOWdnbRJPHLcY5JmuZVnQqVkL9tSorSn9SQddLnOhNfbb2MzeC5EMtynLwZeKzxrYbHWkMW1PlD0Am3AV8jMNvXx/d01HIqiOntd7WZfgnH58fHLbyXF1ey3FxLbFwzRFUWBDJJsPp0fpQ+Px18v7Rj529CH5HJNN2rKr8dvPX6fT1YrhFuxYWKivY45BdlixI27m3dKfE6nrONm7W3NZTk5N8LStw0+WayZQbVRdr6Y8waANAGgDQH//Z"}),O="chatFrame__combL7",x="active__comQ8j",B="minimized__comKts",F="desktop__com4NH";!function(e){e.INIT_CHAT="INIT_CHAT",e.LAUNCH_CHAT="LAUNCH_CHAT"}(L||(L={})),function(e){e.LIVE_AGENT_FEATURE_LOADED="LIVE_AGENT_FEATURE_LOADED",e.LIVE_AGENT_CHAT_INITIALIZE="LIVE_AGENT_CHAT_INITIALIZE",e.LIVE_AGENT_CHAT_LAUNCH="LIVE_AGENT_CHAT_LAUNCH",e.LIVE_AGENT_CHAT_STARTED="LIVE_AGENT_CHAT_STARTED",e.LIVE_AGENT_CHAT_ENDED="LIVE_AGENT_CHAT_ENDED",e.LIVE_AGENT_CHAT_RESTORE="LIVE_AGENT_CHAT_RESTORE",e.LIVE_AGENT_IFRAME_LOADING="LIVE_AGENT_IFRAME_LOADING",e.LIVE_AGENT_IFRAME_LOADED="LIVE_AGENT_IFRAME_LOADED",e.LIVE_AGENT_MAXIMIZED="LIVE_AGENT_MAXIMIZED",e.LIVE_AGENT_MINIMIZED="LIVE_AGENT_MINIMIZED",e.LIVE_AGENT_AVAILABLE="LIVE_AGENT_AVAILABLE",e.LIVE_AGENT_UNAVAILABLE="LIVE_AGENT_UNAVAILABLE",e.LIVE_CHAT_UPDATE_SALESFORCE_CONFIG="LIVE_CHAT_UPDATE_SALESFORCE_CONFIG",e.LIVE_AGENT_CHAT_STATE_CHANGE="LIVE_AGENT_CHAT_STATE_CHANGE"}(N||(N={}));class P extends a.Component{constructor(e,t){super(e),this.handleFeatureLoaded=()=>{var e,t;this.setState({isInitialized:!0}),null===(t=null===(e=this.props)||void 0===e?void 0:e.onChatFeatureLoaded)||void 0===t||t.call(e)},this.startChat=()=>this.postMessageToIframe(L.LAUNCH_CHAT),this.handleChatStart=e=>{this.props.onChatStart&&this.props.onChatStart(),this.setState({active:!0,isDesktop:e.detail&&"DESKTOP"===e.detail.device})},this.handleAgentAvaileble=()=>{this.props.onChatReady&&this.props.onChatReady()},this.handleAgentUnavaileble=()=>{this.props.onChatUnavailable&&this.props.onChatUnavailable()},this.handleChatEnd=()=>{this.props.onChatEnd&&this.props.onChatEnd(),this.setState({active:!1})},this.handleChatIframeLoad=()=>{var e,t;this.postMessageToIframe(L.INIT_CHAT,Object.assign(Object.assign(Object.assign({},this.props.config),null!==(t=null===(e=this.props)||void 0===e?void 0:e.iframeInitPayload)&&void 0!==t?t:{}),{ADOBE_VISITOR_ID:this.props.adobeVisitorID,AVATAR_IMG:M,LOCALE:this.props.locale}))},this.handleMaximize=()=>this.setState({minimized:!1}),this.handleMinimize=()=>this.setState({minimized:!0}),this.postMessageToIframe=(e,t)=>{this.liveAgentIframe.contentWindow.postMessage({detail:t,eventName:e},"*")},this.state={active:!1,isClientRendered:!1,isDesktop:!1,isInitialized:!1,minimized:!1}}componentDidMount(){"undefined"!=typeof window&&(window.addEventListener(N.LIVE_AGENT_FEATURE_LOADED,this.handleFeatureLoaded),window.addEventListener(N.LIVE_AGENT_CHAT_STARTED,this.handleChatStart),window.addEventListener(N.LIVE_AGENT_AVAILABLE,this.handleAgentAvaileble),window.addEventListener(N.LIVE_AGENT_UNAVAILABLE,this.handleAgentUnavaileble),window.addEventListener(N.LIVE_AGENT_CHAT_ENDED,this.handleChatEnd),window.addEventListener(N.LIVE_AGENT_IFRAME_LOADED,this.handleChatIframeLoad),window.addEventListener(N.LIVE_AGENT_MAXIMIZED,this.handleMaximize),window.addEventListener(N.LIVE_AGENT_MINIMIZED,this.handleMinimize),this.setState({isClientRendered:!0}))}componentWillUnmount(){"undefined"!=typeof window&&(window.removeEventListener(N.LIVE_AGENT_FEATURE_LOADED,this.handleFeatureLoaded),window.removeEventListener(N.LIVE_AGENT_CHAT_STARTED,this.handleChatStart),window.removeEventListener(N.LIVE_AGENT_AVAILABLE,this.handleAgentAvaileble),window.removeEventListener(N.LIVE_AGENT_UNAVAILABLE,this.handleAgentAvaileble),window.removeEventListener(N.LIVE_AGENT_CHAT_ENDED,this.handleChatEnd),window.removeEventListener(N.LIVE_AGENT_IFRAME_LOADED,this.handleChatIframeLoad),window.removeEventListener(N.LIVE_AGENT_MAXIMIZED,this.handleMaximize),window.removeEventListener(N.LIVE_AGENT_MINIMIZED,this.handleMinimize))}render(){const e=O+"            "+(this.props.className?this.props.className:"")+"            "+(this.state.active?x:"")+"            "+(this.state.isDesktop?F:"")+"            "+(this.state.minimized?B:"");return this.state.isClientRendered?a.createElement("iframe",{sandbox:"allow-scripts allow-downloads allow-forms allow-same-origin allow-popups",ref:e=>{this.liveAgentIframe=e},src:this.props.iframeSrc,className:e}):null}}!function(e){e.customer="CUSTOMER",e.operator="OPERATOR",e.seller="SELLER",e.other="OTHER"}(T||(T={})),function(e){e.marketplace="MARKETPLACE",e.bestbuy="BESTBUY"}(w||(w={})),function(e){e[e.pending=0]="pending",e[e.sending=1]="sending",e[e.sent=2]="sent",e[e.error=3]="error"}(I||(I={}));const k=["div","a","p","h1","h2","h3","h4","h5","h6","strong","em","abbr","acronym","address","bdo","blockquote","cite","q","code","ins","del","dfn","kbd","pre","samp","var","br","ul","ol","li","dl","dt","dd","table","tr","td","th","tbody","thead","tfoot","col","colgroup","caption"],D={a:["href","target"]},H=e=>e.filter(e=>e.sender.role===T.customer),U=e=>{if(e&&e.content){e.content=o(e.content,{allowedAttributes:D,allowedTags:k});const t=e.content;t&&/.*From:(.|\n|\r)*Subject:(.|\n|\r)*/gi.test(t)&&(e.content=t.replace(/From:(.|\n|\r)*Subject:(.|\n|\r)*/gi,""))}};var R=(0,i.defineMessages)({mpCommunicationMessageAttachment:{id:"pages.mpCommunication.message.attachment"},mpCommunicationMessageBbyLabel:{id:"pages.mpCommunication.message.bby.label"},mpCommunicationMessageBbySupport:{id:"pages.mpCommunication.message.to.bby.support"},mpCommunicationMessageEscalation:{id:"pages.mpCommunication.message.escalation"},mpCommunicationMessageLabel:{id:"pages.mpCommunication.message.label"}});const j=()=>a.createElement("svg",{width:"9",height:"16",viewBox:"0 0 9 16",fill:"none",xmlns:"http://www.w3.org/2000/svg","aria-hidden":!0},a.createElement("path",{d:"M7.9 3.5C7.65 3.5 7.45 3.7 7.45 3.95V11.95C7.4 13.7 5.95 15.05 4.25 15C4.2 15 4.2 15 4.15 15C2.4 15.1 0.95 13.75 0.85 12.05C0.85 12 0.85 12 0.85 11.95V2.95C0.85 2.85 0.95 0.9 2.9 0.9C4.85 0.9 4.95 2.75 4.95 2.95V10.45C4.95 10.75 4.85 11.05 4.7 11.3C4.55 11.45 4.35 11.5 4.2 11.5C4 11.5 3.85 11.45 3.7 11.3C3.5 11 3.4 10.7 3.4 10.35V3.95C3.4 3.7 3.2 3.5 2.95 3.5C2.7 3.5 2.5 3.7 2.5 3.95V10.35C2.5 10.9 2.7 11.5 3.05 11.9C3.7 12.55 4.75 12.55 5.4 11.9C5.75 11.5 5.95 10.95 5.9 10.4V2.9C5.85 1.95 5.15 0 2.95 0C0.75 0 0.05 1.9 0 2.95V11.95C0 12 0.15 15.9 4.2 15.9C8.25 15.9 8.4 12 8.4 11.95V3.95C8.4 3.7 8.2 3.5 7.9 3.5C7.95 3.5 7.95 3.5 7.9 3.5Z",fill:"#001E73"}));var G={bold:"bold__comGp0",messageItem:"messageItem__comeTL",messageContainer:"messageContainer__com6aB",title:"title__comxyG",messageCUSTOMER:"messageCUSTOMER__comOxm",date:"date__comc6i",recipient:"recipient__commxN",messageSELLER:"messageSELLER__comaLA",messageOPERATOR:"messageOPERATOR__comnWD",icon:"icon__com3c5",dateMessage:"dateMessage__comnbd",escalatedStatus:"escalatedStatus__comgKN",escalatedStatusIcon:"escalatedStatusIcon__comobW",attachmentIcon:"attachmentIcon__comnI5",attachmentText:"attachmentText__comQKF"};const V=e=>{let{message:t}=e;const s=t.sender.role,r=t.messageEscalation&&s===T.customer;U(t);return a.createElement("div",{className:`${G.messageItem} ${G[`message${s}`]}`},a.createElement("div",null,a.createElement("div",{className:G.messageContainer},a.createElement("div",{className:G.title},(()=>{switch(s){case T.seller:return a.createElement(a.Fragment,null,t.sender.fullName);case T.operator:return a.createElement(a.Fragment,null,a.createElement(n.P6y,{isAriaHidden:!0,className:G.icon,viewBox:"0 1 16 8"}),a.createElement(i.FormattedMessage,Object.assign({},R.mpCommunicationMessageBbyLabel)));default:return a.createElement(i.FormattedMessage,Object.assign({},R.mpCommunicationMessageLabel))}})()),r&&a.createElement("span",{className:`${G.bold} ${G.recipient}`},a.createElement(i.FormattedMessage,Object.assign({},R.mpCommunicationMessageBbySupport))),t.content&&a.createElement("div",{dangerouslySetInnerHTML:{__html:t.content}}),t.attachmentExists&&a.createElement("div",{className:G.attachmentText},a.createElement("div",{className:G.attachmentIcon}," ",a.createElement(j,null)," "),a.createElement(i.FormattedMessage,Object.assign({},R.mpCommunicationMessageAttachment)))),a.createElement("div",{className:G.date},r&&a.createElement("span",{className:`${G.bold} ${G.escalatedStatus}`},a.createElement("span",{className:G.escalatedStatusIcon}),a.createElement(i.FormattedMessage,Object.assign({},R.mpCommunicationMessageEscalation))),a.createElement(n.k7W,{date:t.created,year:"numeric",month:"short",day:"2-digit",displayTime:!0,className:G.dateMessage,hour:"2-digit",minute:"2-digit"}))))};var Z=(0,i.defineMessages)({newsletterEmailAddressAriaLabel:{id:"pages.newsletter.email.address.ariaLabel"},newsletterEmailAddressLabel:{id:"pages.newsletter.email.address.label"},newsletterEmailErrorMessage:{id:"pages.newsletter.email.error"},newsletterPostalCodeErrorMessage:{id:"pages.newsletter.postalCode.error"},newsletterPostalCodeInfo:{id:"pages.newsletter.postalCode.info"},newsletterPostalCodeInfoForPreferenceCentre:{id:"pages.newsletter.postalCode.info.preference.centre"},newsletterPostalCodeLabel:{id:"pages.newsletter.postalCode.label"},newsletterSubscribeButton:{id:"pages.newsletter.button.signup"},newsletterSubscribeDisclaimerPrivacyPolicy:{id:"pages.newsletter.subscribeDisclaimerPrivacyPolicy"},newsletterSubscribeDisclaimerText:{id:"pages.newsletter.subscribeDisclaimerText"}}),W="formContainer__comOl8",q="formEmailInput__comg4l",$="postalWrapper__comZhZ",z="emailWrapper__comZd0",K="formPostalCodeInput__combgG",Y="formItemInfo__comjnw",Q="formPostalCodeInfo__com3gE",J="newsletterDisclaimerText__comUgr",X="newsletterPrivacyPolicyLink__comYEn",ee="formButton__com61j",te="formInlineContainer__comJNp",se="formEmailInputInlineButton__comWHE",re="formButtonInlineButton__com3Q6";const ae=e=>{let{handleError:t,handleSubmit:s,isLoading:r,privacyPolicyLink:o,intl:c,advanced:l=!1,contentFromCMS:m,hideDisclaimer:d=!1,isSignedOutPreferenceCentre:u=!1}=e;return a.createElement(n.l09,{onSubmit:s,onError:t,scrollToErrors:!1},a.createElement("div",{className:l?W:te},a.createElement("div",{className:z},a.createElement(n.IIB,{className:l?q:se,name:"email",validators:[n.C1W,n.HYN],errorMsg:m?m.emailError:c.formatMessage(Z.newsletterEmailErrorMessage),label:l?c.formatMessage(Z.newsletterEmailAddressLabel):"",placeholder:l?"":m?m.emailAddressPlaceholder:c.formatMessage(Z.newsletterEmailAddressLabel),extraAttrs:{"aria-haspopup":!1,"aria-label":m?m.emailAriaLabel:c.formatMessage(Z.newsletterEmailAddressAriaLabel),"data-automation":"email-address-input",type:"email"}})),l&&a.createElement(a.Fragment,null,a.createElement("div",{className:$},a.createElement(n.IIB,{asyncValidators:[(0,n.BSk)(6),n.Zez],className:K,name:"postalCode",validators:[n.C1W,n.BdW],formatter:"*** ***",errorMsg:c.formatMessage(Z.newsletterPostalCodeErrorMessage),label:c.formatMessage(Z.newsletterPostalCodeLabel),maxLength:7,extraAttrs:{"aria-haspopup":!1,"aria-label":m?m.emailAriaLabel:c.formatMessage(Z.newsletterEmailAddressAriaLabel),"data-automation":"postalCode-input",type:"postalCode"}})),a.createElement("div",{className:`${Y} ${Q}`,"data-automation":"newsletter-form-postal-code-info"},u?a.createElement(i.FormattedMessage,Object.assign({},Z.newsletterPostalCodeInfoForPreferenceCentre)):a.createElement(i.FormattedMessage,Object.assign({},Z.newsletterPostalCodeInfo)))),a.createElement(n.zxk,{className:l?ee:re,appearance:"secondary",type:"submit",shouldFitContainer:!1,isDisabled:r,extraAttrs:{"data-automation":"subscribe-newsletter-button"}},m?m.emailSignUpButton:a.createElement(i.FormattedMessage,Object.assign({},Z.newsletterSubscribeButton))),l&&!d&&a.createElement("div",{className:`${Y} ${J}`,"data-automation":"newsletter-email-sign-up-disclaimer-text"},a.createElement(i.FormattedMessage,Object.assign({},Z.newsletterSubscribeDisclaimerText)),a.createElement(n.rUS,{href:o,targetSelf:!1,className:X},a.createElement(i.FormattedMessage,Object.assign({},Z.newsletterSubscribeDisclaimerPrivacyPolicy))),".")))},ne=e=>{const t=(0,i.useIntl)();return a.createElement(ae,Object.assign({},e,{intl:t}))};var ie,oe;!function(e){e.contactBby="CONTACTBBYC",e.priceMatch="PRICEMATCH",e.return="RETURN",e.other="OTHER"}(ie||(ie={})),function(e){e.initial="INITIAL",e.orderStatus="ORDERSTATUS",e.generalQuestion="GENERALQUESTION",e.priceMatch="PRICEMATCH",e.return="RETURN",e.marketPlace="MARKETPLACE"}(oe||(oe={}));var ce="errorMsg__com5Zf",le="successMessageHeader__com6zQ",me="successMessageBody__compxK",de="buttons__comXfj",ue="cancelButton__com6Q1",pe=(0,i.defineMessages)({cancelBtn:{id:"components.orderCommunicationsForm.form.cancel"},errorHeader:{id:"components.orderCommunicationsForm.error.header"},meassageSelectError:{id:"components.orderCommunicationsForm.form.message.select.error"},messageError:{id:"components.orderCommunicationsForm.form.message.error"},messageHeader:{id:"components.orderCommunicationsForm.form.message.header"},messageHeader_bbycPriceMatch_itemOne:{id:"components.orderCommunicationsForm.form.message.header.bbyc.priceMatch.item.one"},messageHeader_bbycPriceMatch_itemThree:{id:"components.orderCommunicationsForm.form.message.header.bbyc.priceMatch.item.three"},messageHeader_bbycPriceMatch_itemTwo:{id:"components.orderCommunicationsForm.form.message.header.bbyc.priceMatch.item.two"},messageHeader_bbycPriceMatch_title:{id:"components.orderCommunicationsForm.form.message.header.bbyc.priceMatch.title"},messageHeader_bbycReturns_itemOne:{id:"components.orderCommunicationsForm.form.message.header.bbyc.returns.item.one"},messageHeader_bbycReturns_title:{id:"components.orderCommunicationsForm.form.message.header.bbyc.returns.title"},pleaseSelect:{id:"components.orderCommunicationsForm.form.pleaseSelect"},selectLabel:{id:"components.orderCommunicationsForm.form.selectLabel"},submitBtn:{id:"components.orderCommunicationsForm.form.submit"},submitBtn_priceMatch:{id:"components.orderCommunicationsForm.form.submit.priceMatch"},submitBtn_returns:{id:"components.orderCommunicationsForm.form.submit.returns"},successBody:{id:"components.orderCommunicationsForm.success.body"},successHeader:{id:"components.orderCommunicationsForm.success.header"},topic_delivery:{id:"components.orderCommunicationsForm.topics.delivery"},topic_orderStatus:{id:"components.orderCommunicationsForm.topics.orderStatus"},topic_other:{id:"components.orderCommunicationsForm.topics.other"},topic_priceMatch:{id:"components.orderCommunicationsForm.topics.priceMatch"},topic_product:{id:"components.orderCommunicationsForm.topics.product"},topic_requestReceipt:{id:"components.orderCommunicationsForm.topics.requestReceipt"},topic_returns:{id:"components.orderCommunicationsForm.topics.returns"}});const he={delivery:pe.topic_delivery,orderStatus:pe.topic_orderStatus,other:pe.topic_other,priceMatch:pe.topic_priceMatch,product:pe.topic_product,requestReceipt:pe.topic_requestReceipt,returns:pe.topic_returns};var ge;!function(e){e[e.pending=0]="pending",e[e.sending=1]="sending",e[e.sent=2]="sent",e[e.error=3]="error"}(ge||(ge={}));const Ee=e=>{let{type:t,intl:s,successMessageProps:r}=e;switch(t){case ge.error:return a.createElement(n.PBl,{message:s.formatMessage(pe.errorHeader)});case ge.sent:return a.createElement(a.Fragment,null,a.createElement("div",{className:le},a.createElement(n.rCG,{message:r.successHeader})),a.createElement("p",{className:me},r.successBody));default:return null}},be=e=>{let{status:t,onCancel:s,onSubmit:r,onSelectTopic:o,className:c,topic:l,successMessageProps:m,intl:d}=e;const u=t===ge.error||t===ge.sent,{formatMessage:p}=d;return a.createElement("div",{className:c},a.createElement(n.aNw,{loading:!u,resizeWhenLoading:!0},a.createElement("div",{className:ce},a.createElement(Ee,{type:t,intl:d,successMessageProps:m}))),a.createElement(n.aNw,{loading:t===ge.sent,resizeWhenLoading:!0},a.createElement(n.l09,{onSubmit:r},a.createElement("fieldset",null,!l&&a.createElement(n.PhF,{name:"topic",handleSyncChange:o,label:d.formatMessage(pe.selectLabel),errorMsg:d.formatMessage(pe.meassageSelectError),controllable:!0,validators:[n.C1W]},a.createElement("option",{value:""},d.formatMessage(pe.pleaseSelect)),a.createElement("option",{value:"product"},d.formatMessage(he.product)),a.createElement("option",{value:"other"},d.formatMessage(he.other)),a.createElement("option",{value:"orderStatus"},d.formatMessage(he.orderStatus)),a.createElement("option",{value:"requestReceipt"},d.formatMessage(he.requestReceipt)),a.createElement("option",{value:"delivery"},d.formatMessage(he.delivery))),a.createElement("label",{htmlFor:"content",className:"contentLabel"},function(e){return e?"priceMatch"===e?Ae():"returns"===e?fe():a.createElement(i.FormattedMessage,{id:pe.messageHeader.id}):a.createElement(i.FormattedMessage,{id:pe.messageHeader.id})}(l)),a.createElement(n.Kx8,{name:"content",rows:10,validators:[n.C1W],errorMsg:p(pe.messageError)})),a.createElement("div",{className:de},s&&a.createElement(n.zxk,{isDisabled:t===ge.sending,appearance:"transparent",type:"button",onClick:s,className:ue},p(pe.cancelBtn)),a.createElement(n.zxk,{isDisabled:t===ge.sending,appearance:"secondary",type:"submit"},p(function(e){return e?"priceMatch"===e?pe.submitBtn_priceMatch:"returns"===e?pe.submitBtn_returns:pe.submitBtn:pe.submitBtn}(l)))))))};const Ae=()=>a.createElement("div",{className:"textAreaHeader"},a.createElement(i.FormattedMessage,{id:pe.messageHeader_bbycPriceMatch_title.id}),a.createElement("ul",null,a.createElement("li",null,a.createElement(i.FormattedMessage,{id:pe.messageHeader_bbycPriceMatch_itemOne.id})),a.createElement("li",null,a.createElement(i.FormattedMessage,{id:pe.messageHeader_bbycPriceMatch_itemTwo.id})),a.createElement("li",null,a.createElement(i.FormattedMessage,{id:pe.messageHeader_bbycPriceMatch_itemThree.id})))),fe=()=>a.createElement("div",{className:"textAreaHeader"},a.createElement(i.FormattedMessage,{id:pe.messageHeader_bbycReturns_title.id}),a.createElement("ul",null,a.createElement("li",null,a.createElement(i.FormattedMessage,{id:pe.messageHeader_bbycReturns_itemOne.id}))));class _e extends a.Component{constructor(e){super(e),this.handleSubmit=(e,t,s)=>{t.preventDefault();const r=this.props.topic?this.props.topic:this.state.selectedTopic;if(r){if(this.state.status===ge.sending)return;this.setState({status:ge.sending});const{communicationProvider:e}=this.props,{content:t}=s;return e.sendOrderMessage(this.props.orderNumber,this.props.poNumber,this.props.locale,{content:t.value,context:{sellerId:this.props.sellerId},escalate:!1,sender:Object.assign({},this.props.sender),topic:this.props.intl.formatMessage(he[r]),type:this.getTopicType(he[r])}).then(this.onPostSuccess).catch(this.onPostError)}},this.getTopicType=e=>{switch(e){case pe.topic_returns:return ie.return;case pe.topic_priceMatch:return ie.priceMatch;default:return ie.other}},this.onPostError=e=>{this.props.onError&&this.props.onError(e),this.setState({status:ge.error})},this.onPostSuccess=()=>{this.props.onSuccess&&this.props.onSuccess(),this.setState({status:ge.sent})},this.handleTopicSelectChange=(e,t)=>{this.setState({selectedTopic:t})},this.state={status:ge.pending}}render(){return a.createElement(be,Object.assign({},this.props,this.state,{onCancel:this.props.onCancel,onSubmit:this.handleSubmit,onSelectTopic:this.handleTopicSelectChange}))}}const Ce=e=>{const t=(0,i.useIntl)();return a.createElement(_e,Object.assign({},e,{intl:t}))};var ve={replyInput:"replyInput__comG5R",replySubmitButton:"replySubmitButton__comRxP",replyBoxChildContainer:"replyBoxChildContainer__comGgJ",container:"container__com0gZ"},ye=(0,i.defineMessages)({replyBoxButton:{id:"components.replyBox.form.button"},replyBoxButtonAriaLabel:{id:"components.replyBox.input.replyBoxButtonAriaLabel"},replyBoxGlobalErrorMessage:{id:"components.replyBox.form.global.error.message"},replyBoxInputAriaLabel:{id:"components.replyBox.input.replyBoxInputAriaLabel"},replyBoxInputErrorMessage:{id:"components.replyBox.input.error.message"},replyBoxInputPlaceholder:{id:"components.replyBox.input.placeholder"}});const Se=e=>{let{children:t,globalErrorMessage:s,intl:{formatMessage:r},messageStatus:i,onSubmit:o,placeHolderMessage:c}=e;const l=c||r(Object.assign({},ye.replyBoxInputPlaceholder)),m=s||r(Object.assign({},ye.replyBoxGlobalErrorMessage)),[d,u]=a.useState(""),[p,h]=a.useState(i===I.error),g=a.useCallback((e,t,s)=>{t.preventDefault(),o(s)},[o]),E=a.useCallback((e,t)=>{p&&h(!1),u(t)},[p]);return a.useEffect(()=>{h(i===I.error),i!==I.sent&&i!==I.pending||u("")},[i]),a.createElement("div",{className:ve.container},p&&a.createElement(n.PBl,{message:m}),a.createElement(n.l09,{name:Ne.form,onSubmit:g},a.createElement("div",{className:ve.replyBoxForm},a.createElement(n.Kx8,{name:Ne.textarea,errorMsg:r(Object.assign({},ye.replyBoxInputErrorMessage)),validators:[n.C1W],placeholder:l,className:ve.replyInput,value:d,handleSyncChange:E,maxLength:1e3,autoComplete:"off",extraAttrs:{"aria-label":r(ye.replyBoxInputAriaLabel)},rows:5}),a.createElement(n.zxk,{type:"submit",appearance:"secondary",extraAttrs:{"aria-label":r(ye.replyBoxButtonAriaLabel),"data-automation":"submitButton"},className:ve.replySubmitButton},r(Object.assign({},ye.replyBoxButton))))),!!t&&a.createElement("div",{className:ve.replyBoxChildContainer},t))},Le=e=>{const t=(0,i.useIntl)();return a.createElement(Se,Object.assign({},e,{intl:t}))},Ne={form:"replyMessageThread",textarea:"replybox"};var Te="EmailCampaignPreferencesBox__comdma",we="EmailCampaignPreferencesBoxTitle__comDI9",Ie="EmailCampaignPreferencesBoxDescription__comQYg",Me="radioLabel__comL5f",Oe="subscriptionOptions__com3CW";const xe=e=>{let{fetchLoading:t,title:s,description:r,options:i,name:o,className:c="",handleSyncChange:l,selectedValue:m}=e;return a.createElement("div",{className:`${Te} ${c}`,"data-automation":`email-campaign-preferences-box-${o}`},!!s&&a.createElement("h3",{className:we,"data-automation":"email-campaign-preferences-box-title"},s),!!r&&a.createElement("p",{className:Ie,"data-automation":"email-campaign-preferences-box-description"},r),t?a.createElement(a.Fragment,null,i.map((e,t)=>a.createElement(n.oYE.Title,{key:t,maxWidth:200}))):a.createElement(n.FXm,{name:o,value:m,extraAttrs:{"data-automation":`${o}-radio-group`},handleSyncChange:l,className:Oe},i.map((e,t)=>a.createElement(n.EUY,{key:t,label:e.label,selectedValue:e.value,className:Me,extraAttrs:{"data-automation":`${o}-radio-button-${e.value}`}}))))};var Be="formContainer__com6wl",Fe="formButton__comSjO",Pe="firstEmailCampaignPreferencesBox__comO0f",ke="loadingSpinner__comDYG",De=(0,i.defineMessages)({unsubscribeBabySamplerEmailsDescription:{id:"pages.unsubscribe.babySampler.description"},unsubscribeBabySamplerEmailsTitle:{id:"pages.unsubscribe.babySampler.title"},unsubscribeGeekSquadEmailsDescriptions:{id:"pages.unsubscribe.geekSquad.description"},unsubscribeGeekSquadEmailsTitle:{id:"pages.unsubscribe.geekSquad.title"},unsubscribeOptionSubscribe:{id:"pages.unsubscribe.option.subscribe"},unsubscribeOptionUnsubscribe:{id:"pages.unsubscribe.option.unsubscribe"},unsubscribeOptionWeekly:{id:"pages.unsubscribe.option.weekly"},unsubscribePromoEmailsDescriptions:{id:"pages.unsubscribe.promo.description"},unsubscribePromoEmailsTitle:{id:"pages.unsubscribe.promo.title"},unsubscribeUnsubscribeAll:{id:"pages.unsubscribe.option.unsubscribeAll"},unsubscribeUpdateButton:{id:"pages.unsubscribe.update.button"}});class He extends a.Component{constructor(e){super(e),this.whiteListedStateKeys=["bbyAll"],this.handleChange=(e,t)=>{const s=Object.assign(Object.assign({},this.state),{bbyAll:"",[e]:t});this.isUnsubAll(s)&&(s.bbyAll="unsubscribeAll"),this.setState(Object.assign({},s))},this.isUnsubAll=e=>{let t=!1;for(const s in e)if(!this.whiteListedStateKeys.includes(s)){if("unsubscribe"!==e[s])return!1;t=!0}return t},this.handleUnsubAll=(e,t)=>{if(!t)return;const s={bbyAll:"unsubscribeAll",geekSquad:"unsubscribe",promo:"unsubscribe"};this.state.babySampler&&(s.babySampler="unsubscribe"),this.setState(Object.assign({},s))},this.createMapableEmailCampaignList=()=>{const{campaignList:e}=this.props;return[...e,{frequency:"",frequencyOptions:["unsubscribeAll"],name:"bbyAll"}].filter(this.filterBabySampler)},this.filterBabySampler=e=>"babySampler"!==e.name||"unsubscribe"!==e.frequency,this.generateOptionsList=e=>e.frequencyOptions.map(e=>({label:this.props.intl.messages[`pages.unsubscribe.option.${e}`],value:e})),this.handleFormSubmit=(e,t,s)=>{const{email:r,language:a,postalCode:n}=this.props,i=Object.assign(Object.assign({},s),{campaigns:Object.assign({},this.state),email:r,language:a,postalCode:n});this.props.handleSubmit(e,t,i)},this.state={bbyAll:"",geekSquad:"unsubscribe",promo:"subscribe"}}componentWillReceiveProps(e){if(!c(e.campaignList,this.props.campaignList)){const t=e.campaignList.reduce((e,t)=>(e[t.name]=t.frequency,e),{});this.isUnsubAll(t)&&(t.bbyAll="unsubscribeAll"),this.setState(Object.assign({},t))}}render(){const{handleError:e,fetchLoading:t,submitLoading:s,intl:r}=this.props;return a.createElement("div",{className:Be,"data-automation":"form-container"},a.createElement(n.l09,{onSubmit:this.handleFormSubmit,onError:e,scrollToErrors:!1},this.createMapableEmailCampaignList().map((e,s)=>{const n=this.generateOptionsList(e);return a.createElement(xe,{key:s,title:r.messages[`pages.unsubscribe.${e.name}.title`]||"",description:r.messages[`pages.unsubscribe.${e.name}.description`]||"",options:n,name:e.name,fetchLoading:t,handleSyncChange:"bbyAll"===e.name?this.handleUnsubAll:this.handleChange,className:0===s?Pe:"",selectedValue:this.state[`${e.name}`]})}),a.createElement(n.zxk,{appearance:"secondary",className:Fe,type:"submit",shouldFitContainer:!1,isDisabled:s,extraAttrs:{"data-automation":"update-unsubscribe-button"}},s?a.createElement(n.TKf,{isLight:!0,width:"24px",containerClass:ke}):a.createElement(i.FormattedMessage,Object.assign({},De.unsubscribeUpdateButton)))))}}var Ue={formContainer:"formContainer__comPSP",formButton:"formButton__comjEu",firstEmailCampaignPreferencesBox:"firstEmailCampaignPreferencesBox__com1CY",postalHeader:"postalHeader__com40Y",postalMessaging:"postalMessaging__comGS0",postalInput:"postalInput__comNAZ",languageLabel:"languageLabel__comcwX",postalLabel:"postalLabel__com-ly",postalWrapper:"postalWrapper__comEJO",radioLabel:"radioLabel__comRjb",loadingSpinner:"loadingSpinner__comS6x"},Re=(0,i.defineMessages)({preferencesBabySamplerEmailsDescription:{id:"pages.preferences.babySampler.description"},preferencesBabySamplerEmailsTitle:{id:"pages.preferences.babySampler.title"},preferencesGeekSquadEmailsDescriptions:{id:"pages.preferences.geekSquad.description"},preferencesGeekSquadEmailsTitle:{id:"pages.preferences.geekSquad.title"},preferencesLanguageInput:{id:"pages.preferences.language.input"},preferencesOptionSubscribe:{id:"pages.preferences.option.subscribe"},preferencesOptionUnsubscribe:{id:"pages.preferences.option.unsubscribe"},preferencesOptionWeekly:{id:"pages.preferences.option.weekly"},preferencesPostalError:{id:"pages.preferences.postal.error"},preferencesPostalInput:{id:"pages.preferences.postal.input"},preferencesPostalParagraph:{id:"pages.preferences.postal.messaging"},preferencesPostalTitle:{id:"pages.preferences.postal.title"},preferencesPromoEmailsDescriptions:{id:"pages.preferences.promo.description"},preferencesPromoEmailsTitle:{id:"pages.preferences.promo.title"},preferencesUnsubscribeAll:{id:"pages.preferences.option.unsubscribeAll"},preferencesUpdateButton:{id:"pages.preferences.update.button"}});class je extends a.Component{constructor(e){super(e),this.whiteListedStateKeys=["bbyAll"],this.handleChange=(e,t)=>{const s=Object.assign(Object.assign({},this.state),{bbyAll:"",[e]:t});this.isUnsubAll(s)&&(s.bbyAll="unsubscribeAll"),this.setState(Object.assign({},s))},this.isUnsubAll=e=>{let t=!1;for(const s in e)if(!this.whiteListedStateKeys.includes(s)){if("unsubscribe"!==e[s])return!1;t=!0}return t},this.handleUnsubAll=(e,t)=>{if(!t)return;const s={bbyAll:"unsubscribeAll",geekSquad:"unsubscribe",promo:"unsubscribe"};this.state.babySampler&&(s.babySampler="unsubscribe"),this.setState(Object.assign({},s))},this.createMapableEmailCampaignList=()=>{const{campaignList:e}=this.props;return[...e,{frequency:"",frequencyOptions:["unsubscribeAll"],name:"bbyAll"}].filter(this.filterCampaigns)},this.filterCampaigns=e=>!(["babySampler","geekSquad"].includes(e.name)&&"unsubscribe"===e.frequency),this.generateOptionsList=e=>e.frequencyOptions.map(e=>({label:this.props.intl.messages[`pages.preferences.option.${e}`],value:e})),this.handleFormSubmit=(e,t,s)=>{const r=Object.assign(Object.assign({},s),{campaigns:Object.assign({},this.state)});this.props.handleSubmit(e,t,r)},this.state={bbyAll:"",geekSquad:"unsubscribe",promo:"subscribe"}}componentWillReceiveProps(e){if(!c(e.campaignList,this.props.campaignList)){const t=e.campaignList.reduce((e,t)=>(e[t.name]=t.frequency,e),{});this.isUnsubAll(t)&&(t.bbyAll="unsubscribeAll"),this.setState(Object.assign({},t))}}render(){const{handleError:e,fetchLoading:t,submitLoading:s,intl:r,email:o,postalCode:c,language:l}=this.props;return a.createElement("div",{className:Ue.formContainer,"data-automation":"form-container"},a.createElement(n.l09,{onSubmit:this.handleFormSubmit,onError:e,scrollToErrors:!1},this.createMapableEmailCampaignList().map((e,s)=>a.createElement(xe,{key:s,title:r.messages[`pages.preferences.${e.name}.title`]||"",description:r.messages[`pages.preferences.${e.name}.description`]||"",options:this.generateOptionsList(e),name:e.name,fetchLoading:t,handleSyncChange:"bbyAll"===e.name?this.handleUnsubAll:this.handleChange,className:0===s?Ue.firstEmailCampaignPreferencesBox:"",selectedValue:this.state[`${e.name}`]})),a.createElement("h2",{className:Ue.postalHeader,"data-automation":"preferences-postal-title"},a.createElement(i.FormattedMessage,Object.assign({},Re.preferencesPostalTitle))),a.createElement("p",{className:Ue.postalMessaging,"data-automation":"preferences-postal-messaging"},a.createElement(i.FormattedMessage,Object.assign({},Re.preferencesPostalParagraph))),a.createElement(n.IIB,{name:"email",extraAttrs:{"data-automation":"hidden-email-input",type:"hidden"},value:o}),a.createElement("div",{className:Ue.postalLabel,"data-automation":"postal-code-label"},a.createElement(i.FormattedMessage,Object.assign({},Re.preferencesPostalInput))),t?a.createElement(n.oYE.Title,{maxWidth:200}):a.createElement(n.IIB,{className:[Ue.postalInput,Ue.postalWrapper].join(" "),name:"postalCode",asyncValidators:[(0,n.BSk)(6),n.Zez],maxLength:7,formatter:"*** ***",validators:[n.C1W,n.BdW],errorMsg:r.messages["pages.preferences.postal.error"],value:c||"",extraAttrs:{"data-automation":"preferences-postal-input"}}),a.createElement("h2",{className:Ue.languageLabel,"data-automation":"email-language-label"},a.createElement(i.FormattedMessage,Object.assign({},Re.preferencesLanguageInput))),t?a.createElement(a.Fragment,null,a.createElement(n.oYE.Title,{maxWidth:200}),a.createElement(n.oYE.Title,{maxWidth:200})):a.createElement(n.FXm,{name:"language",value:l||"",extraAttrs:{"data-automation":"language-radio-group"}},a.createElement(n.EUY,{label:"English",selectedValue:"en",className:Ue.radioLabel}),a.createElement(n.EUY,{label:"FranÃ§ais",selectedValue:"fr",className:Ue.radioLabel})),a.createElement(n.zxk,{appearance:"secondary",className:Ue.formButton,type:"submit",shouldFitContainer:!1,isDisabled:s,extraAttrs:{"data-automation":"update-preferences-button"}},s?a.createElement(n.TKf,{isLight:!0,width:"24px",containerClass:Ue.loadingSpinner}):a.createElement(i.FormattedMessage,Object.assign({},Re.preferencesUpdateButton)))))}}function Ge(e,t,s,r){return new(s||(s=Promise))(function(a,n){function i(e){try{c(r.next(e))}catch(e){n(e)}}function o(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s(function(e){e(t)})).then(i,o)}c((r=r.apply(e,t||[])).next())})}"function"==typeof SuppressedError&&SuppressedError;var Ve="genesysFrame__comYNo",Ze="genesysChatExpanded__comazW",We="genesysChatLauncherOnly__comMZo";const qe="GENESYS_DESKTOP_VIEW",$e="GENESYS_DATABASE_SET",ze="GENESYS_LAUNCHER_READY",Ke="GENESYS_SCRIPT_INITIALIZED",Ye="GENESYS_LAUNCHER_CLOSED",Qe="GENESYS_MESSENGER_CLOSED",Je="GENESYS_MESSENGER_OPENED",Xe="GENESYS_MOBILE_VIEW",et="OPEN_GENESYS_CHAT",tt="*",st=()=>{const e=(0,a.useRef)(null),t=(0,a.useRef)(null),s=(0,a.useRef)(null),[r,n]=(0,a.useState)(!1),[i,o]=(0,a.useState)(!1),[c,l]=(0,a.useState)(!1),[m,d]=(0,a.useState)(!1),u=()=>{o(!0),e.current&&(e.current.classList.add(Ze),e.current.classList.remove(We))},p=()=>{var t;if(!(null===(t=e.current)||void 0===t?void 0:t.contentWindow))return;const s=window.innerWidth<600?Xe:qe;e.current.contentWindow.postMessage({eventName:s},tt)};(0,a.useEffect)(()=>{if("undefined"!=typeof window){if(c){const r=t=>{var s,r;if(t.data&&t.data.eventName)switch(t.preventDefault(),t.stopPropagation(),t.data.eventName){case Je:u();break;case Qe:o(!1),e.current&&(e.current.classList.remove(Ze),e.current.classList.add(We)),p();break;case Ye:n(!1),e.current&&e.current.classList.remove(We);break;case ze:null===(r=null===(s=null==e?void 0:e.current)||void 0===s?void 0:s.contentWindow)||void 0===r||r.postMessage({eventName:et},tt),u(),d(!0);break;case Ke:p();break;default:console.log("Message from chat:",t.data)}},a=()=>{p()};t.current=r,s.current=a,window.addEventListener("message",r),window.addEventListener("resize",a)}return()=>{t.current&&window.removeEventListener("message",t.current),s.current&&window.removeEventListener("resize",s.current)}}},[c]),(0,a.useEffect)(()=>()=>{t.current&&(window.removeEventListener("message",t.current),t.current=null),s.current&&(window.removeEventListener("resize",s.current),s.current=null),e.current&&e.current.parentNode&&(e.current.remove(),e.current=null)},[]);const h=(0,a.useCallback)(t=>{var s;if(!t||!t.chatUrl||!t.lang)return void console.error("openChat requires chatUrl and lang parameters");const r=((e,t)=>{if("undefined"==typeof window)return null;const s="genesys-bby-chat-iframe",r=document.createElement("iframe"),a=`${e}?lang=${t}`;return r.setAttribute("src",a),r.setAttribute("class",Ve),r.setAttribute("id",s),r.setAttribute("data-automation",s),document.body.appendChild(r),r})(t.chatUrl,t.lang);r&&(e.current=r,l(!0),(null===(s=e.current)||void 0===s?void 0:s.contentWindow)&&t.data&&e.current.contentWindow.postMessage({customAttributes:t.data,eventName:$e},tt))},[c]);return{closeChat:(0,a.useCallback)(()=>Ge(void 0,void 0,void 0,function*(){var r;return(null===(r=e.current)||void 0===r?void 0:r.contentWindow)&&e.current.contentWindow.postMessage({eventName:Qe},tt),new Promise(r=>{requestAnimationFrame(()=>{t.current&&(window.removeEventListener("message",t.current),t.current=null),s.current&&(window.removeEventListener("resize",s.current),s.current=null),e.current&&e.current.parentNode&&(e.current.remove(),e.current=null),l(!1),n(!1),o(!1),d(!1),r()})})}),[]),isChatOpen:c,isLoading:c&&!m,isMinimized:c&&!i,launcherVisible:r,messengerOpened:i,openChat:h,resizePostMessage:p}},rt=a.createContext(null),at=e=>{let{children:t}=e;const s=st();return a.createElement(rt.Provider,{value:s},t)},nt=()=>{const e=a.useContext(rt);if(null===e)throw new Error("useGenesysChatContext must be used within a GenesysChatProvider");return e},it=at;class ot{constructor(e,t){var s=this;this.hostUrl=e,this.csrfTokenProvider=t,this.generateHttpHeaders=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Ge(s,void 0,void 0,function*(){const t=Object.assign(Object.assign({},e),{"Content-Type":"application/json"});return l.jx.isUserSignedIn()&&this.addAccessToken(t),yield this.addCsrfToken(t),t})},this.makeNetworkRequest=function(e,t,a){let n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"POST";return Ge(s,void 0,void 0,function*(){let s;try{s=yield fetch(this.hostUrl+e,{body:JSON.stringify(a),credentials:"include",headers:t,method:n})}catch(t){const s=new h(`${this.hostUrl}${e}`,`Error connecting to ${this.hostUrl}${e}`,t);return Promise.reject(s)}if(s.status===r.InternalServerError){const t=new g(`${this.hostUrl}${e}`,"InternalServerError");return Promise.reject(t)}return s})},this.addAccessToken=e=>{const t=l.jx.getAccessToken();t&&(e.Authorization="Bearer "+t)},this.addCsrfToken=e=>Ge(this,void 0,void 0,function*(){let t=l.jx.getCsrfToken();t||(yield this.csrfTokenProvider.getCsrfToken(),t=l.jx.getCsrfToken()),t&&(e["X-TX"]=t)}),this.hostUrl=e,this.csrfTokenProvider=t}handleError(e,t,s){return Ge(this,void 0,void 0,function*(){switch(e){case r.BadRequest:return Promise.reject(new p(t,s));case r.InternalServerError:return Promise.reject(new g(t,s));case r.Unauthorized:return Promise.reject(new b(t,s));default:return Promise.reject(new m(t,s))}})}}class ct extends ot{constructor(e,t){super(e,t),this.sendOrderMessage=(e,t,s,a)=>Ge(this,void 0,void 0,function*(){a.context.sellerId||(a.context.sellerId="bbyca");const n={Accept:"application/vnd.bestbuy.orderconversation+json","Accept-Language":s},i=`communications/orders/${e}/shipments/${t}/messages`,o=yield this.generateHttpHeaders(n),c=yield this.makeNetworkRequest(i,o,a);return c.status!==r.OK&&c.status!==r.Created?this.handleError(c.status,this.hostUrl+i):c}),this.sendMpReturnMessage=(e,t,s)=>Ge(this,void 0,void 0,function*(){const a=`marketplace/${l.jx.isUserSignedIn()?"orders":"guest-orders"}/${e}/return/messages`,n={Accept:"application/json","Accept-Language":t},i=yield this.generateHttpHeaders(n),o=yield this.makeNetworkRequest(a,i,s);return o.status!==r.OK?this.handleError(o.status,this.hostUrl+a):o}),this.sendMpReturnMiraklRequest=(e,t,s)=>Ge(this,void 0,void 0,function*(){const a=`marketplace/returns/orders/${e}`,n={Accept:"application/json","Accept-Language":t},i=yield this.generateHttpHeaders(n),o=yield this.makeNetworkRequest(a,i,s);return o.status!==r.OK?this.handleError(o.status,this.hostUrl+a):o}),this.getOrderMessageHistory=(e,t,s,a,n)=>Ge(this,void 0,void 0,function*(){const i=`communications/${l.jx.isUserSignedIn()?"orders":"guest-orders"}/${e}/shipments/${t}/messages?sellerType=${a}`,o={Accept:"application/vnd.bestbuy.orderconversation+json","Accept-Language":n,"Seller-Id":s},c=yield this.generateHttpHeaders(o),m=yield this.makeGetNetworkRequest(i,c);if(m.status===r.OK){return yield m.json()}return m.status===r.NoContent?null:this.handleError(m.status,this.hostUrl+i)}),this.makeGetNetworkRequest=(e,t)=>Ge(this,void 0,void 0,function*(){let s;try{s=yield fetch(this.hostUrl+e,{credentials:"include",headers:t,method:"GET"})}catch(t){const s=new h(this.hostUrl+e,`Error connecting to ${this.hostUrl+e}`,t);return Promise.reject(s)}if(s.status===r.InternalServerError){const t=new g(this.hostUrl+e,"InternalServerError");return Promise.reject(t)}return s})}}class lt extends ot{constructor(e,t){super(e,t),this.sendContactUsMessage=(e,t)=>Ge(this,void 0,void 0,function*(){const s={Accept:"application/json","Accept-Language":e},a="/bbyc/contact-us/messages",n=yield this.generateHttpHeaders(s),i=yield this.makeNetworkRequest(a,n,t);return i.status!==r.OK&&i.status!==r.Created?this.handleError(i.status,this.hostUrl+a):i})}}class mt{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;this.addSubscriber=e=>Ge(this,void 0,void 0,function*(){const t=this.newsletterApiUrl+(this.newsletterApiUrl.indexOf("bestbuy.ca/api/communications")>-1?"/marketing-cloud":"/express-consent")+"/subscribe",s={email:e.email,language:e.language,optedOut:!1,postalCode:e.postalCode||"X0X 0X0"},a=yield fetch(t,{body:JSON.stringify(s),headers:{Accept:"application/json;charset=UTF-8","Accept-Language":e.locale,"Content-Type":"application/json;charset=UTF-8"},method:"POST"});return a.status===r.OK?a.status:Promise.reject(new m(t,"Failed to subscribe",void 0,a.status))}),this.getSubscriber=e=>Ge(this,void 0,void 0,function*(){const t=`${this.newsletterApiUrl+"/marketing-cloud/preferences"}?email=${e.email}`,s=yield fetch(t,{headers:{Accept:"application/json;charset=UTF-8","Accept-Language":e.locale,"Content-Type":"application/json;charset=UTF-8"},method:"GET"});return s.status===r.OK?s.json():s.status===r.NotFound?Promise.reject(new E(t,"Email not found in subscriber's list")):Promise.reject(new m(t,"Failed to fetch subscriber",void 0,s.status))}),this.updateSubscriberPreferences=e=>Ge(this,void 0,void 0,function*(){const t=this.newsletterApiUrl+"/marketing-cloud/preferences",s={campaignList:e.campaignList,email:e.email,language:e.language,optedOut:this.isOptedOut(e.campaignList),postalCode:e.postalCode||"M5G 2C3"},a=yield fetch(t,{body:JSON.stringify(s),headers:{Accept:"application/json;charset=UTF-8","Accept-Language":e.locale,"Content-Type":"application/json;charset=UTF-8"},method:"PUT"});return a.status===r.OK?a.status:Promise.reject(new m(t,"Failed to update subscription",void 0,a.status))}),this.getOneTrustLinkToken=(e,t)=>Ge(this,void 0,void 0,function*(){const s=`${this.newsletterApiUrl+(this.newsletterApiUrl.indexOf("bestbuy.ca/api/communications")>-1?"/marketing-cloud":"/express-consent")+"/preferences/link-token"}/${e}`,a=yield fetch(s,{headers:{Accept:"application/json;charset=UTF-8","Accept-Language":t,"Content-Type":"application/json;charset=UTF-8"},method:"GET"});return a.status===r.OK?a.json():a.status===r.NotFound?Promise.reject(new E(s,"Email not found in subscriber's list")):Promise.reject(new m(s,"Failed to fetch subscriber",void 0,a.status))}),this.isOptedOut=e=>{let t=!0;return e.forEach(e=>{if("unsubscribe"!==e.frequency)return t=!1}),t},this.newsletterApiUrl=e,this.newsletterApiUrl+=`/v${String(t)}`}}},32127:(e,t,s)=>{s.d(t,{ap:()=>k});var r=s(77057),a=s(18691),n=s(68658),i=s(99086),o=s(55713),c=s(54097),l=s(9503),m=s(73897),d=s(54393),u=s(67410),p=s(65489),h=s(50863),g=s(18159),E=s(81533),b=s(73123),A=s(91419),f=s(8571),_=s(34547),C=s(69217),v=s(7710),y=s.n(v);const S=(0,r.Z)([f.Z,e=>"undefined"===e,e=>"null"===e]),L=(0,r.Z)([(0,a.Z)(Array),(0,a.Z)(String),n.Z,(0,a.Z)(Boolean)]),N=(0,i.Z)(S,(0,o.Z)(""),c.Z),T=(0,l.Z)(m.Z,_.Z),w=(0,i.Z)(T,d.Z,(0,o.Z)("")),I=(0,l.Z)(Object.entries,(0,u.Z)(w),p.Z,(0,u.Z)(h.Z),(0,g.Z)(_.Z),(0,E.Z)(" ")),M=(0,i.Z)(L,N,I),O=(0,l.Z)((0,u.Z)(M),(0,g.Z)(_.Z),(0,E.Z)(" "),h.Z),x=(0,i.Z)(Array.isArray,O,N);(0,b.Z)((e,t)=>(0,i.Z)((0,o.Z)((0,_.Z)(e)),x,(0,o.Z)(t)));class B extends Error{constructor(){let e=arguments.length>1?arguments[1]:void 0;super(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"-"),this.innerError=e,this.name="WebappError",Object.setPrototypeOf(this,B.prototype)}toJSON(){return y()(this)}}var F,P;!function(e){e[e.ProductApi=0]="ProductApi",e[e.CustomerReviewApi=1]="CustomerReviewApi",e[e.SearchApi=2]="SearchApi",e[e.AvailabilityApi=3]="AvailabilityApi",e[e.LocationApi=4]="LocationApi",e[e.SellerApi=5]="SellerApi",e[e.CategoryApi=6]="CategoryApi",e[e.RemoteConfigApi=7]="RemoteConfigApi",e[e.AddToCartApi=8]="AddToCartApi",e[e.StoreLocationApiUrl=9]="StoreLocationApiUrl"}(F||(F={}));!function(e){e[e.OK=200]="OK",e[e.Accepted=201]="Accepted",e[e.NotFound=404]="NotFound",e[e.InternalServerError=500]="InternalServerError"}(P||(P={}));const k=new class{constructor(){this.isDTMEnabled=()=>{const{s:e}="undefined"==typeof window?{}:window;return!!e&&!!e.tl}}send(e){let{linkName:t,el:s=!0,variableOverrides:r=null,doneAction:a="navigate"}=e;const n=this.isDTMEnabled();if(this.isDTMEnabled()){const{s:e}=window,n=e;n.linkTrackVars="",n.linkTrackEvents="",n.tl(s,"o",t,r,a)}return n}dispatchEvent(e){let{category:t,action:r,label:a}=e,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"#root";const i=((null===s.g||void 0===s.g?void 0:s.g.document)||(null===window||void 0===window?void 0:window.document)).querySelector(n);if(!t||!r||!a)throw new B("DTMTracker: Could not dispatch analytics-ui-event: Missing parameters");"undefined"!=typeof window&&null!==i&&i.dispatchEvent(new CustomEvent("analytics-ui-event",{detail:{action:`${t}:${r}:${a}`}}))}};"function"==typeof SuppressedError&&SuppressedError;(0,C.Z)((e,t)=>"#"===t),(0,l.Z)((0,A.Z)("-"),d.Z)}}]);