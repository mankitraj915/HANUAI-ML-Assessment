/*!
 * cxbus
 * @version: 2.2.1
 * @license: Genesys Cloud Services, Inc.
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("cxbus",[],t):"object"==typeof exports?exports.cxbus=t():e.cxbus=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=0)}([function(e,t,n){var r;void 0===(r=function(){"use strict";function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}!function(){var a=n(1).Promise,i=Ge(),u="color:red;font-weight:bold",s="color:white;background:#6495ed",c="color:#555;font-style:italic",l="color:#6495ed;font-weight:bold",f=!1,d=!1,m=[],p={},b={},g={},h={},y=[],v={},w={},D={},x={},I={},N=[],C=window.Genesys&&window.Genesys.q&&W(window.Genesys.q,U)?window.Genesys.q:[],j=!1,k=null,E=!0,T=!1,_="",P="",M="plugin.min.js",B={},O={},S=!0,A=!1,X="*",G="*",L=!1,F=!1,J=!1,U="array",R=function(){},q={last:null,value:null},H="Could not load plugin file in given location. Check your plugins path option.";function Y(e){if(W(e=function(e){var t={};for(var n in e)t[fe(n)]=e[n];return t}(e),"object")){if(W(e.debug,"boolean")&&(j=e.debug),W(e.name,"string")&&e.name.trim().length>0&&(k=e.name.trim()),W(e.queue,U)&&e.debug,W(e.async,"boolean")&&(S=e.async),W(e.log,"boolean")&&(E=e.log),W(e.logstore,"boolean")&&(T=e.logstore),W(e.pluginspath,"string")&&(_=je(e.pluginspath)),W(e.modulespath,"string")&&(P=je(e.modulespath)),W(e.pluginfilenameformat,"string")&&(M=e.pluginfilenameformat),W(e.pluginmap,"object")&&(B=e.pluginmap),W(e.pluginmap,"string"))try{B=JSON.parse(e.pluginmap)}catch(t){xe("%cInvalid plugin map JSON. Ignoring "+e.pluginmap,u)}if(W(e.modulemap,"object")&&(O=e.modulemap),W(e.modulemap,"string"))try{O=JSON.parse(e.modulemap)}catch(t){xe("%cInvalid module map JSON. Ignoring "+e.modulemap,u)}if(W(e.childdomain,"string")&&(F||(X=e.childdomain,F=!0)),W(e.parentdomain,"string")&&(J||(G=e.parentdomain,J=!0)),W(e.allowtypescript,"boolean")&&(L=e.allowtypescript),W(e.childmode,"boolean")&&1==e.childmode)A=e.childmode,d=!0,(window.opener||window.parent).postMessage({type:"CXBus.childCallout",registry:Object.keys(b),busID:i,busName:k},G);B=Q(B),O=Q(O),xe("%cGenesys configuration changed",s)}}function W(e,t){return t===U?!!Array.isArray(e):o(e)==t}function $(e,t,n){return De(e,(function(r,a){var c=fe(e),d=b[c];f&&!d&&void 0===t?We({type:"CXBus.remoteExecution",subType:"registerPlugin",busID:i,pluginName:e}).then((function(e){"pass"===e.resolution?$(e.pluginName,!0).then((function(e){r(e)})):"fail"===e.resolution&&$(e.pluginName,!1).then((function(e){a(e)}))})):!f||f&&!d&&!0===t?"string"!=o(e)||d?d&&a("%cCan't register plugin "+Ie(e)+" -- Name is already taken",u,l,u):(b[c]={name:e,namespace:e,interface:ue(e),events:{},commands:{},data:{},buffer:[],ready:!1,busID:n||i},h[c]={events:[],commands:[]},b[c].busID==i&&xe("%c New Plugin Registered:"+Ie(" "+e),s,l),function(e){var t=e.interface;t.registerCommand("COMMANDS",(function(t){se(e,"Commands"),t.resolve()})),t.registerCommand("EVENTS",(function(t){se(e,"Events"),t.resolve()})),t.registerCommand("LOAD",(function(e){e.resolve()}))}(b[c]),b[c].interface.initData=w[c]||{},r(b[c].interface),w[c]&&delete w[c]):f&&!1===t&&a("%cCan't register plugin "+Ie(e)+" -- Name is already taken",u,l,u)}))}function V(e){return"function"==o(e)&&(y.push(e),!0)}function z(e){e&&!e.mID&&(e.mID=Ge());for(var t=0;t<y.length;t++)y[t](e)}function Q(e){var t={};for(var n in e)t[fe(n)]=e[n];return t}function K(e,t){return De(e||"unknown",(function(e,n){xe(t,u,l,u),n()}))}function Z(e){return"string"==typeof e&&e.length>0&&e.trim().length>0}function ee(e,t,n){var r=fe(e),a=M.replace("plugin",r),u=B[r]||void 0,c=!1;return"object"==o(u)?("string"==o(u.target)&&(c=u.target),"boolean"==o(u.module)&&u.module,"string"==o(u.src)&&(a=u.src)):"string"==o(u)?a=u:!1===u&&(a=!1),w[r]=t||{},function(e){for(var t in e.split(".").length>1&&(e=e.split(".")[0]),b)if(fe(t)==fe(e))return!0;return!1}(e)||D[fe(e)]?K(e,"%cCan't load plugin ("+Ie(e)+") -- This plugin is already loaded or an unexpected error occurred."):Z(n)?We({type:"CXBus.remoteExecution",subType:"loadPlugin",busID:i,targetBus:n,pluginName:e,data:t}):(w[r]=t||{},Z(c)?We({type:"CXBus.remoteExecution",subType:"loadPlugin",busID:i,targetBus:c,pluginName:e,data:t}):(xe("%cLoading plugin: "+a,l),De(e,(function(t,n){var r=function(n){!function(e){D[fe(e)]=!0}(e),t(n)},o=function(){n("Could not load plugin file: "+a)};!1===a?(xe("%cNotice: "+a+" was prevented from loading by the current plugin mapping configuration.",s),n()):ae(u?a:_+a,r,o)}))))}function te(e){return De("loadFile",(function(t,n){if(function(e){return x[e]}(e))xe("%cCan't load file ("+e+") -- This file was already loaded",u,l,u),n();else{xe("%cLoading file: "+e,l),ae(e,(function(n){!function(e){x[e]=!0}(e),t(n)}),(function(){n("Could not load file: "+e)}))}}))}function ne(e,t){return De("loadJSON",(function(t,n){var r=new XMLHttpRequest;r.overrideMimeType("application/json"),r.open("GET",e,!0),r.onreadystatechange=function(){4==r.readyState&&"200"==r.status?r.responseText&&t(r.responseText):"200"!=r.status&&0!=r.status&&n("loadJSON failed with status code: "+r.status)},r.send(null)}))}function re(e){var t=fe(e);return De("loadModule",(function(e,n){if(t&&I[t])setTimeout((function(){e(I[t])}),0);else{var r="module.mod.js".replace("module",t),a=O[t],i=""!==P?P:_,u=function(n){e(I[t])},c=function(){n("Could not load module: "+t)},l=!1;"object"==o(a)?("string"==o(a.target)&&a.target,"boolean"==o(a.module)&&(l=a.module),"string"==o(a.src)&&(r=a.src)):"string"==o(a)?r=a:!1===a&&(r=!1),!1===r?(xe("%cNotice: "+r+" was prevented from loading by the current module mapping configuration.",s),n()):ae(a?r:i+r,u,c,l)}}))}function oe(e,t){var n=fe(e);return!I[n]&&(I[n]=t,!0)}function ae(e,t,n,r){if(!e)return n&&n(),!1;if(e.match(".js$")||e.match(".ts$")&&!0===j&&!0===L){var o=document.createElement("script");return o.src=e,o.type=!0===r||e.match(".ts$")?"module":"text/javascript",o.onload=t,o.onerror=n,o.charset="UTF-8",document.head.appendChild(o),!0}return xe("%cError: ("+e+") is not recognized as a javascript file.",u),n&&n(),!1}function ie(e,t){b[fe(e)].ready=!0,function(e){var t=fe(e),n=b[t].buffer||[],r=0;for(r=0;r<n.length;r++)!function(e){var t=be(e.command);xe(Ie(e.commander)+" called the command: "+Ie(e.command),l,c,l),t&&Ne((function(){t(e)}))}(n[r]);b[t].buffer=[]}(e),he(e,"ready",t||{},!0)}function ue(e){var t=function(){try{j&&console.log&&console.log.apply(this,arguments)}catch(e){}};return t.info=function(){try{j&&console.info&&console.info.apply(this,arguments)}catch(e){}},t.warn=function(){try{j&&console.warn&&console.warn.apply(this,arguments)}catch(e){}},t.error=function(){try{j&&console.error&&console.error.apply(this,arguments)}catch(e){}},{publish:function(t,n){return he(e,t,n)},publishDirect:function(t,n){return he(e,t,n,!1,!0)},republish:function(t,n){return he(e,t,n,!0)},subscribe:function(t,n){return ve(e,t,n)},unsubscribe:function(t){return function(e,t){var n=me(e),r=fe(t);if(n&&g[r]&&g[r].subscribers){for(var o=[],a=0;a<g[r].subscribers.length;a++)g[r].subscribers[a].subscriber!=e&&o.push(g[r].subscribers[a]);return o.length>0?g[r].subscribers=o:delete g[fe(t)],xe(Ie(e)+" unsubscribed from "+Ie(t),l,c,l),!0}return!1}(e,t)},command:function(t,n){return we({commander:e,command:t,data:n})},before:function(e,t){return r=t,!!le(n=e)&&(v[n]||(v[n]=[]),v[n].push(r),!0);var n,r},registerCommand:function(t,n){return ge(e,t,n)},registerEvents:function(t){!function(e,t){var n=me(e);W(t=t||[],"string")&&(t=[t]);if(n&&t.length>0){for(var r=0;r<t.length;r++)n.events[t[r]]||(n.events[t[r]]=!0,h[fe(e)].events.push(t[r]));return xe(Ie(e)+" registered the events: %c"+t.join(", "),l,c,l),!0}}(e,t)},namespace:function(){return e+""},subscribers:function(){return function(e){var t={};for(var n in g)if(n.match(fe(e))){t[n]||(t[n]=[]);for(var r=0;r<g[n].subscribers.length;r++)t[n].push(g[n].subscribers[r].subscriber)}return t}(e)},data:function(t,n){return 2===arguments.length&&"undefined"==o(arguments[1])?ce(e,t,n,!0):ce(e,t,n)},registry:function(){return h},initData:{},log:t,ready:function(){return ie(e)}}}function se(e,t){for(var n in xe("%cList of "+t+" for: "+Ie(e.namespace),s,l),e[fe(t)])xe("%c"+n,s)}function ce(e,t,n,r){return function(e,t,n,r){var a=fe(e);if("undefined"!=o(n)||"undefined"==o(n)&&r){var i;b[a].data[t]?i=b[a].data[t].value:b[a].data[t]=q;o(i);var u=o(n),s={};s.last=i,s.value=n,s.time=_e();var c="data."+t;i==n&&o(i)==o(n)||(he(e,"data",b[a].data),he(e,c,s),he(e,"string"==u?c+":'"+s.value+"'":c+":"+s.value,s,!1,!0)),b[a].data[t]=s}}(e,t,n,r),function(e,t){var n=fe(e);if(b[n].data[t])return b[n].data[t].value;if(e&&!t&&b[n])return b[n].data||{};var r=le(t),o=b[fe(r)];if(t=t.replace(r+".",""),o&&o.data[t])return o.data[t].value;return}(e,t)}function le(e){return e.split(".")[0]}function fe(e){return"string"==typeof e?e.toLowerCase():e}function de(e,t){return fe(e)===fe(t)}function me(e){return b[fe(e)]||b[le(fe(e))]||!1}function pe(e){var t=fe(e);return!!b[t]||!!be(t)}function be(e){var t=fe(e).split(".")||[],n=!1;return 2==t.length&&(n=me(t[0]))&&n.commands[t[1]]||!1}function ge(e,t,n){var r=fe(t),o=me(e);return!!o&&(o.commands[r]||h[fe(e)].commands.push(t),o.commands[r]=n,o.busID==i&&xe(Ie(e)+" registered the command: "+Ie(t),l,c,l),f&&Fe({id:i,childID:i,busID:i,type:"CXBus.remoteExecution",subType:"registerCommand",namespace:e,commandName:t}),!0)}function he(e,t,n,r,o,a){var u=fe(Ce([e,t])),s=Ie(e)+" published: "+Ie(t),f=fe(e)+".*",d=(n=n||{},{time:_e(),publisher:e,event:u,eventName:t,data:n||{}});if(!0===r&&(g[u]?(g[u].republish=!0,g[u].data=n):g[u]={subscribers:[],republish:!0,data:n}),o||a||xe(s,l,c,l),g[u]){o&&!a&&xe(s,l,c,l);for(var m=g[u].subscribers,p=0;p<m.length;p++)Ne(m[p].callback,d)}if(g[f])for(m=g[f].subscribers,p=0;p<m.length;p++)Ne(m[p].callback,d);if(g["*"])for(m=g["*"].subscribers,p=0;p<m.length;p++)Ne(m[p].callback,d);return a||Je("publish",{busID:i,childID:i,event:u,eventName:t,publisher:e,republish:r,direct:o,data:n}),z({type:"publish",time:_e(),source:e,target:u,data:n||{}}),!0}function ye(e,t,n,r){xe(Ie(t)+" republished: "+Ie(e),l,c,l),Ne(n,{time:_e(),publisher:t,event:e,data:r}),z({type:"publish",time:_e(),source:t,target:e,data:r||{}})}function ve(e,t,n){if("string"==typeof t){var r=me(e),o=me(t),a=fe(t);if(n&&r)return g[a]||(g[a]={subscribers:[],republish:!1}),g[a].subscribers.push({subscriber:e,callback:n}),xe(Ie(e)+" subscribed to "+Ie(t),l,c,l),!0===g[a].republish&&o&&ye(t,o.namespace,n,g[a].data||{}),Je("subscribe",{busID:i,childID:i,eventName:t,subscriber:e}),t}else if(Array.isArray(t))for(var u=t,s=0;s<u.length;s++)ve(e,u[s],n);return!1}function we(e){var t=e.commander,n=e.command,r=(fe(n),e.data),a=e.resolveBuff,s=e.rejectBuff,d=e.buffered;r=r||{},n&&1===n.split(".").length&&(n=Ce([t,n])),d||(r=function(e,t){for(var n=v[e]||[],r=0;r<n.length;r++)"object"==o(t)&&!1!==t&&null!=t&&(t=n[r](t));return t}(n,r));var m=be(n),p=le(n),g=b[fe(p)];if(z({type:"command",time:_e(),source:t,target:n,data:r||{}}),f&&!g)return We({type:"CXBus.remoteExecution",subType:"command",busID:i,pluginName:p,commandName:n,commander:t,data:r});if(!f&&g&&g.busID!=i)return e.message?(e.message.targetID=g.busID,We(e.message)):We({type:"CXBus.remoteExecution",subType:"command",busID:i,pluginName:p,commandName:n,commander:t,data:r,targetID:g.busID});if(g&&g.busID==i){var h=De(n,(function(f,d){var h={time:_e(),commander:t,command:n,resolve:a||f,reject:s||d,data:r||{}};"object"==o(r)&&!1!==r&&null!=r?g&&g.busID==i&&(xe(Ie(t)+" called the command: "+Ie(n),l,c,l),g.ready||p==t?m?m(h):(e.message&&(e.message.resolution="fail",e.message.resolutionData="Command does not exist"),h.reject("Command does not exist")):g.ready||(xe("%c"+Ie(p)+" is loading and/or has not yet called its ready() method. Your command call ("+n+") has been buffered and will be executed once the plugin has loaded and/or called its ready() method.",u,u,u),function(e,t){b[fe(e)].buffer.push(t)}(p,h))):(e.message.resolution="fail",e.message.resolutionData="Command was cancelled by a 'before' function.",h.reject("Command was cancelled by a 'before' function.")),e.message&&"fail"==e.message.resolution&&We(e.message)}));return e.message&&h.then((function(t){e.message.resolution="pass",e.message.resolutionData=t,We(e.message)})).catch((function(t){e.message.resolution="fail",e.message.resolutionData=t,We(e.message)})),h}return f||g?void 0:De(n,(function(o,a){xe("%c'"+p+"' plugin not currently registered. Attempting to load plugin from configured path ("+_+").",l),ee(p).then((function(){we({commander:t,command:n,data:r,resolveBuff:o,rejectBuff:a,buffered:!0})}),(function(){e.message.resolution="fail",e.message.resolutionData=H,a(H)}))}))}function De(e,t){var n=new a(t);return n.catch((function(t){xe("%cError ("+Ie(e)+"): ",u,u,u),console.error&&t&&console.error(t)})),n}function xe(e,t,n,r,a,i){try{E&&(T&&N.push(e+""),j&&console&&console.log&&"string"==o(e)&&("%c"==e.substr(e.length-2,2)&&(e=e.substr(0,e.length-2)),console.log.apply(this,arguments)))}catch(e){Ve("logging error!")}}function Ie(e){return"%c"+e+"%c"}function Ne(e,t,n,r){S||r?setTimeout((function(){e(t)}),n||0):e(t)}function Ce(e){return e.join(".")}function je(e){return e&&"/"!=e[e.length-1]?e+"/":e}function ke(){if(d)C.push(arguments);else{var e=arguments,t=e[0]||"";switch(t){case"registerPlugin":$(e[1]).then(e[2]||R,e[3]||R);break;case"command":"function"==o(e[2])?we({commander:"Genesys",command:e[1],data:{}}).then(e[2]||R,e[3]||R):we({commander:"Genesys",command:e[1],data:e[2]||{}}).then(e[3]||R,e[4]||R);break;case"subscribe":"string"!=o(e[1])&&!Array.isArray(e[1])||"function"!=o(e[2])||ve("Genesys",e[1],e[2]);break;case"monitor":"function"==o(e[1])&&V(e[1]);break;case"registerChild":Oe(e[1]);break;case"registerModule":oe(e[1],e[2]);break;case"executeQueue":Te();break;case"loadPlugin":"function"!=typeof e[3]?ee(e[1],e[2],e[3]).then(e[4]||R,e[5]||R):ee(e[1],e[2],!1).then(e[3]||R,e[4]||R);break;case"loadFile":te(e[1]).then(e[2]||R,e[3]||R);break;case"loadModule":re(e[1]).then(e[2]||R,e[3]||R);break;case"loadJSON":ne(e[1]).then(e[2]||R,e[3]||R);break;case"configure":if(!e[1])return Ee();Y(e[1]||{});break;case"lookup":return pe(e[1]);default:return!1}}return!0}function Ee(){return xe("CXBus Configuration\n----------------------------\nDEBUG: \t\t\t\t\t"+j+"\nBUS_NAME: \t\t\t\t"+k+"\nPLUGINS_PATH: \t\t\t"+(_||'""')+"\nMODULES_PATH: \t\t\t"+(P||'""')+"\nPLUGIN_FILENAME_FORMAT: "+M+"\nMODULE_FILENAME_FORMAT: module.mod.js\nPLUGIN_MAP: \t\t\t"+JSON.stringify(B)+"\nMODULE_MAP: \t\t\t"+JSON.stringify(O)+"\nASYNC: \t\t\t\t\t"+S+"\nCHILD_MODE: \t\t\t"+A+"\nCHILD_DOMAIN: \t\t\t"+X+"\nPARENT_DOMAIN: \t\t\t"+G+"\nALLOW_TYPESCRIPT: \t\t"+L),{debug:j,name:k,pluginsPath:_,modulesPath:P,pluginFilenameFormat:M,moduleFilenameFormat:"module.mod.js",pluginMap:B,moduleMap:O,async:S,childMode:A,childDomain:X,parentDomain:G,allowTypeScript:L}}function Te(e){if(C){xe("%cExecuting "+C.length+" items from the queue...",s);for(var t=0;t<C.length;t++)ke.apply(this,C[t])}}function _e(){return(new Date).getTime()}if(window.Genesys)for(var Pe=Object.keys(window.Genesys),Me=0;Me<Pe.length;Me++)ke[Pe[Me]]=window.Genesys[Pe[Me]];window.Genesys=ke,$("Genesys"),"function"==o(n(3))&&n(4)&&(void 0===(r=function(){return window.Genesys}.apply(t,[]))||(e.exports=r));var Be={};function Oe(e){return!!e&&(e.contentWindow&&(e=e.contentWindow),Be[id]={id:id,name:void 0,busID:void 0,intvl:setInterval((function(){Se(e,id)}),500),callAttempts:0,registered:!1,window:e,registry:[]},Se(e,id),!0)}function Se(e,t){e.postMessage({type:"CXBus.parentCallout",childID:t,busID:i,busName:k},X),Be[t].callAttempts++}function Ae(e,t,n,r){Be[t]&&!Be[t].registered?(clearInterval(Be[t].intvl),Be[t].registered=_e(),Be[t].registry=r,Be[t].busID=busID,Be[t].busName=n):(Be[t]={id:t,busID:t,busName:n,intvl:!1,callAttempts:0,registered:_e(),window:e,registry:r},e.postMessage({type:"CXBus.parentCallback",busID:i,busName:k},X))}function Xe(e,t,n,r){d=!1,f=e,t,Te()}function Ge(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}))}function Le(e,t){Be[e]&&(t=t||{},Be[e].window.postMessage(t,X))}function Fe(e){f&&f.postMessage(e,G)}function Je(e,t){if((t=t||{}).subType=e,t.type="CXBus.broadcast",f)Fe(t);else for(var n in Be)Le(n,t)}var Ue,Re,qe=document.getElementById("genesys-cxbus"),He={},Ye={src:0,charset:0,id:0,type:0,queue:0,pluginmap:0,modulemap:0};if(qe){for(Me=0;Me<qe.attributes.length;Me++)Ue=fe(qe.attributes[Me].nodeName),"true"===(Re=qe.attributes[Me].nodeValue)&&(Re=!0),"false"===Re&&(Re=!1),Ye[Ue]||(He[Ue]=Re);Y(He)}function We(e){var t;if(e.id)t=e.id;else{for(t=Ge();p[t];)t=Ge();e.id=t}return De("remoteExecution",(function(n,r){if(p[t]={success:n,fail:r},$e())if(e.resolution)Le(e.busID,e);else if(Z(e.targetBus)){var o=function(e){for(var t in Be){var n=Be[t];if(de(n.busName,e))return n.id}return!1}(e.targetBus);o&&Le(o,e)}else e.targetID&&Le(e.targetID,e);else A&&e.id!=i&&Fe(e)}))}function $e(){return!A}function Ve(){var e=Array.prototype.slice.call(arguments);e.unshift("["+window.name+"]")}window.addEventListener("message",(function(e){if(e.data){if($e()){if(X!=e.origin&&"*"!=X)return;if("CXBus.childCallout"!=e.data.type&&"CXBus.childCallback"!=e.data.type&&"CXBus.remoteExecution"!=e.data.type&&(t=e.data.busID,n=e.source,!Be[t]||Be[t].window!==n))return}var t,n;m.push(e),function(){for(;m.length>0;){var e=m.shift(),t=e.data,n=p[t.id];switch(t.type){case"CXBus.parentCallout":A&&Xe(e.source,t.busID,t.busName,t.parentRegistry);break;case"CXBus.childCallout":A||Ae(e.source,t.busID,t.busName,t.registry);break;case"CXBus.parentCallback":A&&Xe(e.source,t.busID,t.busName,t.parentRegistry);break;case"CXBus.childCallback":A||Ae(e.source,t.busID,t.busName,t.registry);break;case"CXBus.broadcast":f||Je(e.data.subType,t);var r=fe(t.eventName),o=g[r]||!1;switch(e.data.subType){case"subscribe":if(void 0===t.eventData&&o&&!0===o.republish){var a=me(t.eventName);t.eventNamespace=a?a.namespace:"",t.eventData=o.data||{},t.subType="republish",Le(t.busID,t)}break;case"publish":he(t.publisher,t.eventName,t.data,t.republish,t.direct,!0);break;case"republish":for(var u=null,s=0;s<o.subscribers.length;s++)o.subscribers[s].subscriber==t.subscriber&&(u=o.subscribers[s].callback);u&&ye(t.eventName,t.eventNamespace,u,t.eventData||{})}break;case"CXBus.remoteExecution":switch(t.subType){case"loadPlugin":var c=p[t.id];t.resolution?t.resolution&&c&&("pass"==t.resolution?c.success(t.resolutionData):"fail"==t.resolution&&c.fail(t.resolutionData),f||t.busID==i||We(t),delete p[t.id]):de(k,t.targetBus)&&ee(t.pluginName,t.data).then((function(){return t.resolution="pass",We(t)}),(function(){return t.resolution="fail",t.resolutionData=H,We(t)}));break;case"registerPlugin":f||(me(t.pluginName)?(t.resolution="fail",Le(t.busID,t)):(t.resolution="pass",Le(t.busID,t),$(t.pluginName,!0,t.busID))),n&&t.resolution&&("pass"==t.resolution?n.success(t):"fail"==t.resolution&&n.fail(t));break;case"registerCommand":f||ge(t.namespace,t.commandName,R);break;case"command":c=p[t.id];var l=le(t.commandName),d=b[fe(l)];if(t.resolution)t.resolution&&c&&("pass"==t.resolution?c.success(t.resolutionData):"fail"==t.resolution&&c.fail(t.resolutionData),f||t.busID==i||We(t),delete p[t.id]);else if(!f&&d&&d.busID&&d.busID!=i)t.targetID=d.busID,We(t),z({type:"command",time:_e(),source:t.commander,target:t.commandName,data:t.data||{}});else if(d&&d.busID&&d.busID==i)we({commander:t.commander,command:t.commandName,data:t.data,message:t});else if(!f&&!d)return t.resolution="fail",t.resolutionData="Plugin does not exist and no plugins path is configured",We(t)}}}}()}}),!1)}()}.apply(t,[]))||(e.exports=r)},function(e,t,n){(function(r){var o;!function(r){var a=r.Promise,i=a&&"resolve"in a&&"reject"in a&&"all"in a&&"race"in a&&function(){var e;return new a((function(t){e=t})),"function"==typeof e}();t?(t.Promise=i?a:x,t.Polyfill=x):void 0===(o=function(){return i?a:x}.call(t,n,t,e))||(e.exports=o);var u=function(){};function s(e){return"[object Array]"===Object.prototype.toString.call(e)}var c,l="undefined"!=typeof setImmediate?setImmediate:setTimeout,f=[];function d(){for(var e=0;e<f.length;e++)f[e][0](f[e][1]);f=[],c=!1}function m(e,t){f.push([e,t]),c||(c=!0,l(d,0))}function p(e){var t=e.owner,n=t.state_,r=t.data_,o=e[n],a=e.then;if("function"==typeof o){n="fulfilled";try{r=o(r)}catch(e){y(a,e)}}b(a,r)||("fulfilled"===n&&g(a,r),"rejected"===n&&y(a,r))}function b(e,t){var n;try{if(e===t)throw new TypeError("A promises callback cannot return that same promise.");if(t&&("function"==typeof t||"object"==typeof t)){var r=t.then;if("function"==typeof r)return r.call(t,(function(r){n||(n=!0,t!==r?g(e,r):h(e,r))}),(function(t){n||(n=!0,y(e,t))})),!0}}catch(t){return n||y(e,t),!0}return!1}function g(e,t){e!==t&&b(e,t)||h(e,t)}function h(e,t){"pending"===e.state_&&(e.state_="sealed",e.data_=t,m(w,e))}function y(e,t){"pending"===e.state_&&(e.state_="sealed",e.data_=t,m(D,e))}function v(e){var t=e.then_;e.then_=void 0;for(var n=0;n<t.length;n++)p(t[n])}function w(e){e.state_="fulfilled",v(e)}function D(e){e.state_="rejected",v(e)}function x(e){if("function"!=typeof e)throw new TypeError("Promise constructor takes a function argument");if(this instanceof x==!1)throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.");this.then_=[],function(e,t){function n(e){y(t,e)}try{e((function(e){g(t,e)}),n)}catch(e){n(e)}}(e,this)}x.prototype={constructor:x,state_:"pending",then_:null,data_:void 0,then:function(e,t){var n={owner:this,then:new this.constructor(u),fulfilled:e,rejected:t};return"fulfilled"===this.state_||"rejected"===this.state_?m(p,n):this.then_.push(n),n.then},catch:function(e){return this.then(null,e)}},x.all=function(e){if(!s(e))throw new TypeError("You must pass an array to Promise.all().");return new this((function(t,n){var r=[],o=0;function a(e){return o++,function(n){r[e]=n,--o||t(r)}}for(var i,u=0;u<e.length;u++)(i=e[u])&&"function"==typeof i.then?i.then(a(u),n):r[u]=i;o||t(r)}))},x.race=function(e){if(!s(e))throw new TypeError("You must pass an array to Promise.race().");return new this((function(t,n){for(var r,o=0;o<e.length;o++)(r=e[o])&&"function"==typeof r.then?r.then(t,n):t(r)}))},x.resolve=function(e){return e&&"object"==typeof e&&e.constructor===this?e:new this((function(t){t(e)}))},x.reject=function(e){return new this((function(t,n){n(e)}))}}("undefined"!=typeof window?window:void 0!==r?r:"undefined"!=typeof self?self:this)}).call(this,n(2))},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t){e.exports=function(){throw new Error("define cannot be used indirect")}},function(e,t){(function(t){e.exports=t}).call(this,{})}])}));