/*! For license information please see vendors-98fba592.25b745ad.js.LICENSE.txt */
"use strict";(self.__LOADABLE_LOADED_CHUNKS__=self.__LOADABLE_LOADED_CHUNKS__||[]).push([[1032],{31330:(e,t,a)=>{a.d(t,{Dz:()=>yr,NI:()=>ge,TR:()=>qr,ZC:()=>Dr,jx:()=>m,kv:()=>$r,zG:()=>Pr});var r=a(36032),s=a(67294),n=a(13412),o=a(8575),i=a(40944),c=a(73935);var l,d={exports:{}};l=d,function(){var e={}.hasOwnProperty;function t(){for(var e="",t=0;t<arguments.length;t++){var s=arguments[t];s&&(e=r(e,a(s)))}return e}function a(a){if("string"==typeof a||"number"==typeof a)return a;if("object"!=typeof a)return"";if(Array.isArray(a))return t.apply(null,a);if(a.toString!==Object.prototype.toString&&!a.toString.toString().includes("[native code]"))return a.toString();var s="";for(var n in a)e.call(a,n)&&a[n]&&(s=r(s,n));return s}function r(e,t){return t?e?e+" "+t:e+t:e}l.exports?(t.default=t,l.exports=t):window.classNames=t}();var u=d.exports;const m={buildCreateAccountUrl:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en-CA",a=arguments.length>2?arguments[2]:void 0;const r="undefined"!=typeof window?window.location.href:"";return`${e}/global/create-account?redirectUrl=${encodeURIComponent(a||r)}&lang=${encodeURIComponent(t)}`},buildSignInUrl:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"en-CA",a=arguments.length>2?arguments[2]:void 0,r=arguments.length>3?arguments[3]:void 0;const s="undefined"!=typeof window?window.location.href:"";return`${e}/global/signin?redirectUrl=${encodeURIComponent(a||s)}&lang=${encodeURIComponent(t)}`+(r?`&contextId=${encodeURIComponent(r)}`:"")},getAccessToken:()=>{const e=p("ta");return e||null},getCsrfToken:()=>{const e=p("tx");return e||null},getCustomerIdCookie:()=>{const e=p("cid");if(!e)return null;try{return JSON.parse(decodeURIComponent(e))}catch(e){return null}},getRecognizedIdToken:()=>{const e=p("tir");return e||null},isUserRecognized:()=>"undefined"!=typeof document&&!!p("tir"),isUserSignedIn:()=>"undefined"!=typeof document&&!!p("ta")};function p(e){if("undefined"!=typeof document){const t=new RegExp("(?:(?:^|.*;\\s*)"+e+"\\s*\\=\\s*([^;]*).*$)|^.*$");return document.cookie.replace(t,"$1")}return null}var h="greetingMessage__accRI0",g="authenticatedUnknown__acc9oW",C="SignInOutNavIcon__acchY9",b="signIn__acc0sQ",f="accountIcon__acc-Vr",E="accountLabel__accaZJ",y="popover__acce--",v="popoverWrapper__acca-3",N="popoverBox__accaA8",A="popoverTitle__accmrb",w="popoverContent__accDdj",S="popoverHeader__accSJ3",L="popoverClose__accyeS",M="popoverCloseIcon__accx6e";const x=e=>{let{dataAutomation:t,dataTestId:a,triggerRef:n,title:o,content:i,onClose:c,className:l,signInNavClicked:d,popoverCloseAriaLabel:m,srText:p}=e;const h=(0,s.useRef)(null),g=(0,s.useRef)(null),C=(0,s.useCallback)(()=>{g.current&&(clearTimeout(g.current),g.current=null)},[]),b=(0,s.useCallback)(()=>{C(),g.current=setTimeout(()=>{"function"==typeof c&&c()},12e3)},[C,c]);(0,s.useEffect)(()=>(d||b(),C),[b]);return(0,s.useEffect)(()=>{const e=e=>{var t,a;const r=e.target,s=document.getElementById("onetrust-banner-sdk");(null==s?void 0:s.contains(r))||(null===(t=null==h?void 0:h.current)||void 0===t?void 0:t.contains(r))||(null===(a=null==n?void 0:n.current)||void 0===a?void 0:a.contains(r))||c()};return document.addEventListener("click",e,!0),()=>document.removeEventListener("click",e,!0)},[c,n]),(0,s.useEffect)(()=>{const e=e=>{var t,a;const r=e.relatedTarget;(null===(t=null==h?void 0:h.current)||void 0===t?void 0:t.contains(r))||(null===(a=null==n?void 0:n.current)||void 0===a?void 0:a.contains(r))||c()},t=h.current;return t&&t.addEventListener("focusout",e),()=>{t&&t.removeEventListener("focusout",e)}},[c,n]),s.createElement("div",{ref:h,"data-automation":t,"data-testid":a,className:u([y,l]),onMouseEnter:()=>{C()},onMouseLeave:()=>{d||b()}},p,s.createElement("div",{className:v},s.createElement("div",{className:N},s.createElement("div",{className:S},s.createElement("p",{className:A},o),s.createElement(r.zxk,{onClick:c,className:L,extraAttrs:{"aria-label":m}},s.createElement(r.x8P,{className:M,viewBox:"0 0 32 32"}))),s.createElement("div",{className:w},i))))};var I={signInContainer:"signInContainer__accIuT",SignInOutNavIcon:"SignInOutNavIcon__accz1Y",signInSkeletonContainer:"signInSkeletonContainer__acc7xN",signInSkeletonLoading:"signInSkeletonLoading__acc95h",skeletonMaskCircle:"skeletonMaskCircle__accbps",accountIcon:"accountIcon__accw-9",accountLabel:"accountLabel__accGna",authUnknownSvg:"authUnknownSvg__accgCX",signInPromptText:"signInPromptText__accsJF",signInPromptSubtext:"signInPromptSubtext__acc9oy",signInPromptButton:"signInPromptButton__accWbI",signInButton:"signInButton__accoi7",srOnly:"srOnly__accqir",skeletonMaskRect:"skeletonMaskRect__accIbZ",signIn:"signIn__accXt1",analyticsLabel:"analyticsLabel__acc1wX",indicator:"indicator__accbX3"};const _=e=>{let{messages:t}=e;return s.createElement("div",{role:"status","aria-live":"polite","aria-atomic":"true",className:I.srOnly},t.signInPromptScreenReaderText)},P=e=>{let{messages:t,signInUrl:a,createAccountUrl:n,onNavigation:o}=e;return s.createElement(s.Fragment,null,s.createElement("p",{className:I.signInPromptText},t.signInPromptText),s.createElement("div",{className:I.signInPromptSubtext},s.createElement(r.LE,{isAriaHidden:!0,color:"blue"}),s.createElement("p",null,s.createElement("span",null,t.signInPromptSubtext1))),s.createElement("div",{className:I.signInPromptSubtext},s.createElement(r.SNH,{isAriaHidden:!0,color:"blue"}),s.createElement("p",null,s.createElement("span",null,t.signInPromptSubtext2))),s.createElement(r.zxk,{className:u([I.signInPromptButton,I.signInButton]),appearance:"secondary",shouldFitContainer:!0,onClick:()=>{sessionStorage.setItem("SignInPromptClicked","true"),o(a)}},t.signInButton),s.createElement(r.zxk,{className:I.signInPromptButton,appearance:"tertiary",shouldFitContainer:!0,onClick:()=>{sessionStorage.setItem("CreateAccountPromptClicked","true"),o(n)}},t.createAnAccountButton))};var k=e=>s.createElement("svg",{className:e.className,"data-automation":e.className,fill:"#FFFFFF",viewBox:"0 0 32 32",height:"24",width:"24",xmlns:"http://www.w3.org/2000/svg","aria-hidden":e.isAriaHidden},s.createElement("path",{d:"M12.14,12A3.86,3.86,0,1,1,16,15.87,3.85,3.85,0,0,1,12.14,12Zm13.93,12.3V23.08A8.71,8.71,0,0,0,23,16.44a1,1,0,1,0-1.25,1.46,6.8,6.8,0,0,1,2.39,5.18v3.13a13,13,0,0,1-16.28,0V23.08a6.83,6.83,0,0,1,4.67-6.45,5.8,5.8,0,1,0-1.41-1.52,8.78,8.78,0,0,0-5.19,8v1.25A13.08,13.08,0,1,1,29.08,16,13,13,0,0,1,26.07,24.33ZM16,1A15,15,0,1,0,31,16,15,15,0,0,0,16,1Z"}),s.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}));const T={createAnAccountButton:"Create an Account",popoverCloseAriaLabel:"Close",signInButton:"Sign In",signInNav:"My Best Buy Account",signInPromptScreenReaderText:"Sign in to your free My Best Buy account to get the most out of your shopping experience.",signInPromptSubtext1:"Stay up to date on orders and receipts.",signInPromptSubtext2:"Discover exclusive offers.",signInPromptText:"Sign in to your free My Best Buy account to get the most out of your shopping experience."},D={createAnAccountButton:"Créez un compte",popoverCloseAriaLabel:"Fermer",signInButton:"Ouvrez une session",signInNav:"Mon compte Best Buy",signInPromptScreenReaderText:"Ouvrez une session dans votre compte Mon Best Buy gratuit pour profiter au maximum de votre expérience de magasinage",signInPromptSubtext1:"Restez au courant des commandes et des reçus.",signInPromptSubtext2:"Découvrez des offres exclusives.",signInPromptText:"Ouvrez une session dans votre compte mon Best Buy gratuit pour profiter au maximum de votre expérience de magasinage."},B=e=>{let{hiddenAnalyticsLabel:t,redirectUrl:a,cieServiceUrl:n,locale:o}=e;const[i,c]=s.useState(!1),[l,d]=s.useState(!1),u=s.useRef(null),p=o.startsWith("fr")?D:T;s.useEffect(()=>{n&&c(!0)},[n]);const{signInUrl:h,createAccountUrl:g}=(e=>{let{cieServiceUrl:t,locale:a,redirectUrl:r}=e;const n=s.useMemo(()=>m.buildSignInUrl(t,a,r),[t,a,r]);return{createAccountUrl:s.useMemo(()=>m.buildCreateAccountUrl(t,a,r),[t,a,r]),signInUrl:n}})({cieServiceUrl:n,locale:o,redirectUrl:a}),{showSignInPrompt:y,updateSignInPromptStatus:v}=(()=>{const[e,t]=s.useState(!1);return s.useEffect(()=>{if(!sessionStorage.getItem("signInPromptDismissed")){const e=setTimeout(()=>{t(!0)},3e3);return()=>clearTimeout(e)}},[]),{showSignInPrompt:e,updateSignInPromptStatus:s.useCallback(e=>{e||sessionStorage.setItem("signInPromptDismissed","true"),t(e)},[])}})(),N=s.useCallback(e=>{window.location.href=e},[]),A=s.useCallback(e=>{e.preventDefault(),d(!0),v(!y)},[v,y]);return n?i?s.createElement("div",{className:I.signInContainer,ref:u},s.createElement("a",{className:`${I.SignInOutNavIcon} ${I.signIn} ${C} ${b}`,"data-automation":"sign-in-link","aria-label":p.signInNav,onClick:A,href:"#"},s.createElement(k,{className:`${I.accountIcon} ${f}`,isAriaHidden:!0}),s.createElement("span",{className:I.indicator}),function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return s.createElement(s.Fragment,null,!!t&&s.createElement("span",{className:I.analyticsLabel}," ",t," "),s.createElement("span",{className:`${I.accountLabel} ${E}`,"data-automation":"sign-in-text"},e.signInNav))}(p,t)),y&&s.createElement(x,{className:I.signInPopover,triggerRef:u,title:o.includes("en")?s.createElement(r.sYn,{isAriaHidden:!0}):s.createElement(r.MVs,{isAriaHidden:!0}),content:s.createElement(P,{messages:p,signInUrl:h,createAccountUrl:g,onNavigation:N}),onClose:()=>v(!1),srText:s.createElement(_,{messages:p}),dataAutomation:"sign-in-prompt",dataTestId:"sign-in-prompt",signInNavClicked:l,popoverCloseAriaLabel:p.popoverCloseAriaLabel})):s.createElement("div",{className:I.signInSkeletonContainer},s.createElement("div",{className:I.skeletonMaskCircle}),s.createElement("div",{className:I.skeletonMaskRect}),s.createElement(r.oYE.Line,{className:I.signInSkeletonLoading})):null};var $={flyoutMenuWrapper:"flyoutMenuWrapper__accnn9",flyoutMenu:"flyoutMenu__accfOi",greetingMessage:"greetingMessage__accwJX",flyoutContainerProfile:"flyoutContainerProfile__accxk8",authenticatedUnknown:"authenticatedUnknown__accN8v",accountIcon:"accountIcon__accKOa",flyoutMenuChevron:"flyoutMenuChevron__accl7T",flyoutMenuButton:"flyoutMenuButton__accfOS",myAccountLink:"myAccountLink__acc09q",flyoutChevronContainer:"flyoutChevronContainer__acck78",myAccountLinkContainer:"myAccountLinkContainer__accz-T",unknownUserIconContainer:"unknownUserIconContainer__acc4SF",analyticsGreetingsText:"analyticsGreetingsText__accPbX",greetingMenuContainer:"greetingMenuContainer__accZ1N",iconGreetingLinkContainer:"iconGreetingLinkContainer__acc2KF"},O=e=>s.createElement("svg",{className:`${e.className} ${I.authUnknownSvg}`,"data-name":"Layer 1",viewBox:"0 0 32 32",fill:"#FFFFFF","aria-hidden":e.isAriaHidden},s.createElement("path",{d:"M16,15.87A3.84,3.84,0,1,0,12.14,12,3.85,3.85,0,0,0,16,15.87Z"}),s.createElement("path",{d:"M29.08,16A13.08,13.08,0,1,0,5.93,24.33V23.08a8.78,8.78,0,0,1,5.19-8A5.71,5.71,0,0,1,10.21,12a5.8,5.8,0,1,1,2.32,4.6,6.83,6.83,0,0,0-4.67,6.45v3.13a13,13,0,0,0,16.28,0V23.08a6.8,6.8,0,0,0-2.39-5.18A1,1,0,1,1,23,16.44a8.71,8.71,0,0,1,3.07,6.64v1.25A13,13,0,0,0,29.08,16Z"})),F="containerProfile__accswN",V="letterProfile__accbyU";const U=e=>{const t=e.firstName.substr(0,1);return s.createElement("div",{className:`${F}${e.className?` ${e.className}`:""}`,"data-automation":"container-profile"},s.createElement("span",{className:V,"data-automation":"letter-profile","aria-hidden":e.isAriaHidden},t))},z={greetingMessage:"Hi,",greetingUnknownFirstNameMessage:"Welcome back!"},H={greetingMessage:"Bonjour,",greetingUnknownFirstNameMessage:"Bienvenue!"};var R="greetingContainer__acczfd",j="greetingMessage__acch2x";const W=e=>{const{locale:t,firstName:a,profileInitialClassName:r}=e,n=t.startsWith("fr")?H:z,o=a?`${n.greetingMessage} ${a}!`:`${n.greetingUnknownFirstNameMessage}`;return s.createElement("div",{className:R,"data-automation":"greeting-container"},a?s.createElement(U,{firstName:a,className:r,isAriaHidden:!0}):s.createElement("div",{className:`${g} ${$.authenticatedUnknown}`,"data-automation":"authenticated-unknown"},s.createElement(O,{className:"authenticatedUnknown",isAriaHidden:!0})),s.createElement("span",{className:`${j} ${h} ${$.greetingMessage}`,"data-automation":"greeting-message"},o))},Y=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"analytics-set-activitymap";const a=[];if(sessionStorage.AEDBacklog){let e=sessionStorage.getItem("AEDBacklog");null===e?e="":a.push(JSON.parse(e))}const r=window.frames["adobe-launch-iframe"]&&window.frames["adobe-launch-iframe"].contentWindow.s&&window.frames["adobe-launch-iframe"].contentWindow.s.pageName||window.s&&window.s.pageName||"",s={event:t,linkName:e,location:window.parent.location,prevPage:r};a.push(s),sessionStorage.setItem("AEDBacklog",JSON.stringify(a))};var K;!function(e){e.eVar34="eVar34"}(K||(K={}));const X=e=>{var t,a,r;(null===(a=null===(t=null===window||void 0===window?void 0:window.frames)||void 0===t?void 0:t["adobe-launch-iframe"])||void 0===a?void 0:a.contentWindow.AppEventData)?null===(r=null===window||void 0===window?void 0:window.frames)||void 0===r||r["adobe-launch-iframe"].contentWindow.AppEventData.push(e):window&&window.AppEventData&&window.AppEventData.push(e)};function q(e,t,a,r){return new(a||(a=Promise))(function(s,n){function o(e){try{c(r.next(e))}catch(e){n(e)}}function i(e){try{c(r.throw(e))}catch(e){n(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof a?t:new a(function(e){e(t)})).then(o,i)}c((r=r.apply(e,t||[])).next())})}"function"==typeof SuppressedError&&SuppressedError;class G extends Error{constructor(e,t){super(e),this.innerError=t,this.name="CieUtilityError",Object.setPrototypeOf(this,G.prototype)}}class Z extends G{constructor(e,t,a,r){super(t,a),this.uri=e,this.statusCode=r,this.name="HttpRequestError",this.statusCode=r,Object.setPrototypeOf(this,Z.prototype)}}var J;!function(e){e[e.OK=200]="OK",e[e.MultiStatus=207]="MultiStatus",e[e.BadRequest=400]="BadRequest",e[e.Unauthorized=401]="Unauthorized",e[e.Forbidden=403]="Forbidden",e[e.NotFound=404]="NotFound",e[e.Conflict=409]="Conflict",e[e.UnprocessableEntity=422]="UnprocessableEntity",e[e.InternalServerError=500]="InternalServerError",e[e.PreconditionFailed=412]="PreconditionFailed"}(J||(J={}));var Q=J;class ee extends Z{constructor(e,t,a){super(e,t,a,Q.BadRequest),this.uri=e,this.name="BadRequestError",Object.setPrototypeOf(this,ee.prototype)}}class te extends ee{constructor(e,t,a){super(e,t,a),this.uri=e,this.name="ResourceAlreadyExistsError",Object.setPrototypeOf(this,te.prototype)}}class ae extends Z{constructor(e,t,a,r,s){super(e,t,a),this.uri=e,this.headers=r,this.cookies=s,this.name="ConnectionError",Object.setPrototypeOf(this,ae.prototype)}}class re extends Z{constructor(e,t,a){super(e,t,a,Q.Conflict),this.uri=e,this.name="DuplicateError",Object.setPrototypeOf(this,re.prototype)}}class se extends Z{constructor(e,t,a){super(e,t,a,Q.Forbidden),this.uri=e,this.name="ForbiddenError",Object.setPrototypeOf(this,se.prototype)}}class ne extends Z{constructor(e,t,a,r,s){super(e,t,a,J.InternalServerError),this.uri=e,this.headers=r,this.cookies=s,this.name="InternalServerError",Object.setPrototypeOf(this,ne.prototype)}}class oe extends ee{constructor(e,t,a){super(e,t,a),this.uri=e,this.name="PasswordBasicCriteriaFailedError",Object.setPrototypeOf(this,oe.prototype)}}class ie extends ee{constructor(e,t,a){super(e,t,a),this.uri=e,this.name="PasswordBlacklistedError",Object.setPrototypeOf(this,ie.prototype)}}class ce extends ee{constructor(e,t,a,r){super(e,t,a),this.uri=e,this.errorResponseValue=r,this.errorResponseValue=r,this.name="PasswordEditFormError",Object.setPrototypeOf(this,ce.prototype)}}class le extends Z{constructor(e,t,a){super(e,t,a,J.Unauthorized),this.uri=e,this.name="UnauthorizedError",Object.setPrototypeOf(this,le.prototype)}}class de extends Z{constructor(e,t,a){super(e,t,a,Q.UnprocessableEntity),this.uri=e,this.name="UnprocessableEntityError",Object.setPrototypeOf(this,de.prototype)}}class ue extends Z{constructor(e,t,a){super(e,t,a,J.PreconditionFailed),this.uri=e,this.name="PreconditionFailedError",Object.setPrototypeOf(this,ue.prototype)}}class me{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];this.apiUrl=e,this.apiVersion=t,this.isAccountSource=a,this.apiUrl=e.endsWith("/")?e.slice(0,-1):e,this.apiUrl+=null!==t&&t>1?`/v${String(t)}`:"",this.isAccountSource=a}handleError(e,t,a,r){return q(this,void 0,void 0,function*(){switch(e){case J.BadRequest:if(r&&r.indexOf("INVALID_PASSWORD")>-1){if(r[1])throw new ce(t,a,void 0,r[1]);throw new ce(t,a)}throw new ee(t,a);case J.Conflict:throw new re(t,a);case J.UnprocessableEntity:if("already_exists"===a)throw new te(t,a);throw new de(t,a);case J.Unauthorized:throw new le(t,a);case J.Forbidden:throw new se(t,a);case J.InternalServerError:throw new ne(t,a);case J.PreconditionFailed:throw new ue(t,a);default:throw new Z(t,a)}})}}const pe=(e,t)=>q(void 0,void 0,void 0,function*(){const a="string"==typeof e?e:e.url;let r;try{r=yield fetch(e,t)}catch(e){const t=new ae(a,`Error connecting to ${a}`,e);return Promise.reject(t)}if(r.status===J.InternalServerError.valueOf()){const e=new ne(a,"InternalServerError");return Promise.reject(e)}return r});class he extends me{constructor(e){super(e)}getCsrfToken(){return q(this,void 0,void 0,function*(){const e=o.parse(`${this.apiUrl}/refresh`),t=o.format(e),a=yield pe(t,{credentials:"include",method:"get"});if(a.status!==J.OK.valueOf()){const e=yield a.json();return Promise.reject(new Z(t,e.error))}})}}class ge extends me{constructor(e){super(e)}signOut(){return q(this,void 0,void 0,function*(){const e=m.getAccessToken();let t=m.getCsrfToken();if(!t){const e=new he(this.apiUrl);yield e.getCsrfToken(),t=m.getCsrfToken()}const a=o.parse(`${this.apiUrl}/signout`),r=o.format(a),s=yield pe(r,{credentials:"include",headers:{Accept:"application/vnd.bestbuy+json",Authorization:`bearer ${e||""}`,ContentType:"application/json","X-TX":`${t}`},method:"post"});if(s.status!==J.OK.valueOf()){const e=yield s.json();return Promise.reject(new Z(r,e.error))}})}}var Ce=e=>s.createElement("svg",{className:e.className,"data-automation":e.className,fill:"#FFFFFF",viewBox:"0 0 32 32",height:"24",width:"24",xmlns:"http://www.w3.org/2000/svg"},s.createElement("path",{d:"M24.28,17H10.21a1,1,0,0,1,0-1.92H24.28L19.09,9.85a1,1,0,1,1,1.37-1.36l6.81,6.81h0a1,1,0,0,1,.29.69.94.94,0,0,1-.3.7l-6.81,6.81a1,1,0,0,1-1.37-1.36ZM6.36,27.57h3.85a1,1,0,1,1,0,1.93H5.39a1,1,0,0,1-1-1V3.46a1,1,0,0,1,1-1h4.82a1,1,0,1,1,0,1.93H6.36Z"}),s.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}));const be={signOutAriaLabel:"Sign out of your account",signOutNav:"Sign Out"},fe={signOutAriaLabel:"Vous déconnecter de votre compte",signOutNav:"Déconnexion"};var Ee="SignInOutNavLink__accytj",ye="accountIcon__accRDs",ve="accountLabel__accyJq",Ne="signOut__accAvw";const Ae=e=>{let{locale:t,cieServiceUrl:a,className:r,onSignOutSuccess:n,hideIcon:o,isButton:i=!1,onKeyDown:c}=e;const l=t.startsWith("fr")?fe:be,d=s.useCallback(()=>{q(void 0,void 0,void 0,function*(){const e=new ge(a);yield e.signOut(),n&&n()})},[n]);return i?s.createElement("button",{className:`${Ee} ${Ne} ${null!=r?r:""}`,"data-automation":"sign-out-link","aria-label":l.signOutAriaLabel,onClick:d,onKeyDown:c},!o&&s.createElement(Ce,{className:ye}),s.createElement("span",{className:ve,"data-automation":"sign-out-text"},l.signOutNav)):s.createElement("a",{className:`${Ee} ${Ne} ${null!=r?r:""}`,"data-automation":"sign-out-link","aria-label":l.signOutAriaLabel,tabIndex:0,href:"#",onClick:d,onKeyDown:c},!o&&s.createElement(Ce,{className:ye}),s.createElement("span",{className:ve,"data-automation":"sign-out-text"},l.signOutNav))},we={accountDashboard:"Dashboard",accountDashboardAriaLabel:"Navigate to Dashboard",accountDashboardUrl:"/account/en-ca",addresses:"Addresses",addressesAriaLabel:"Navigate to Addresses",addressesUrl:"/account/en-ca/addresses",closeButton:"Close",membership:"Membership",membershipArialLabel:"Navigate to Membership",membershipUrl:"/subscription/en-ca/membership",monthlySubscription:"Monthly Subscription",monthlySubscriptionAriaLabel:"Navigate to Monthly Subscription",monthlySubscriptionUrl:"/subscription/en-ca",myBestBuy:"My Best Buy",orderHistory:"Order History",orderHistoryAriaLabel:"Navigate to Order History",orderHistoryUrl:"/order/en-ca/order-history",paymentMethods:"Payment Methods",paymentMethodsAriaLabel:"Navigate to Payment Methods",paymentUrl:"/account/en-ca/credit-cards",personalDetails:"Personal Details",personalDetailsAriaLabel:"Navigate to Personal Details",personalDetailsUrl:"/account/en-ca/personal-details",preferenceCenter:"Preference Centre",preferenceCenterAriaLabel:"Navigate to Preference Centre",preferenceCenterUrl:"/account/en-ca/preference-centre"},Se={accountDashboard:"Tableau de bord",accountDashboardAriaLabel:"Naviguer vers le tableau de bord",accountDashboardUrl:"/account/fr-ca",addresses:"Adresses",addressesAriaLabel:"Naviguer vers les adresses",addressesUrl:"/account/fr-ca/adresses",closeButton:"Fermer le menu",membership:"Abonnement",membershipArialLabel:"Naviguer vers l’abonnement",membershipUrl:"/subscription/fr-ca/abonnement",monthlySubscription:"Adhésion mensuelle",monthlySubscriptionAriaLabel:"Naviguer vers l’adhésion mensuelle",monthlySubscriptionUrl:"/subscription/fr-ca",myBestBuy:"My Best Buy",orderHistory:"Historique des commandes",orderHistoryAriaLabel:"Naviguer vers l’historique des commandes",orderHistoryUrl:"/order/fr-ca/historique-des-commandes",paymentMethods:"Méthodes de paiement",paymentMethodsAriaLabel:"Naviguer vers les méthodes de paiement",paymentUrl:"/account/fr-ca/cartes-de-credit",personalDetails:"Coordonnées personnelles",personalDetailsAriaLabel:"Naviguer vers les coordonnées personnelles",personalDetailsUrl:"/account/fr-ca/coordonnees-personnelles",preferenceCenter:"Centre de préférences",preferenceCenterAriaLabel:"Naviguer vers le centre de préférences",preferenceCenterUrl:"/account/fr-ca/centre-preferences"};var Le="accountMenuContent__accInm",Me="myBestBuy__acc9FD",xe="myBestBuyLogo__accI-z",Ie="closeButton__accmDS",_e="accountMenuContentIcons__accrRJ",Pe="myAccountSvg__accDQI",ke="linkWithIcon__acctJ-",Te="divider__accJtz",De="flyoutMenuContent__accFn7";const Be=e=>{let{cieServiceUrl:t,locale:a,accountDashboardUrl:o,onSignOutSuccess:i,isFlyoutMenu:c,onMenuClose:l,flyoutMenuButtonRef:d}=e;const[u,m]=(0,s.useState)(!1),p=(0,s.useRef)(null),h=(0,s.useRef)(null),g=a.startsWith("fr")?Se:we,C=s.useMemo(()=>[{ariaLabel:g.accountDashboardAriaLabel,dataAutomation:"my-account-link",icon:s.createElement(k,{className:Pe}),id:1,link:g.accountDashboardUrl,text:g.accountDashboard},{ariaLabel:g.orderHistoryAriaLabel,dataAutomation:"order-history",icon:s.createElement(r.AyW,{className:Pe}),id:2,link:g.orderHistoryUrl,text:g.orderHistory},{ariaLabel:g.membershipArialLabel,dataAutomation:"membership-link",icon:s.createElement(r.tzR,{className:Pe}),id:3,link:g.membershipUrl,text:g.membership},{ariaLabel:g.monthlySubscriptionAriaLabel,dataAutomation:"subscription-link",icon:s.createElement(r.A0Y,{className:Pe}),id:4,link:g.monthlySubscriptionUrl,text:g.monthlySubscription},{ariaLabel:g.paymentMethodsAriaLabel,dataAutomation:"payment-method-link",icon:s.createElement(r.aBT,{className:Pe}),id:5,link:g.paymentUrl,text:g.paymentMethods},{ariaLabel:g.addressesAriaLabel,dataAutomation:"addresses-link",icon:s.createElement(r.oHT,{className:Pe}),id:6,link:g.addressesUrl,text:g.addresses},{ariaLabel:g.personalDetailsAriaLabel,dataAutomation:"personal-details-link",icon:s.createElement(r.MnY,{className:Pe,viewBox:"0 0 21 20"}),id:7,link:g.personalDetailsUrl,text:g.personalDetails},{ariaLabel:g.preferenceCenterAriaLabel,dataAutomation:"preference-centre-link",icon:s.createElement(r.Mib,{className:Pe}),id:8,link:g.preferenceCenterUrl,text:g.preferenceCenter}],[g]),b=s.useCallback(()=>{X(c?{event:"Sign_Out_From_GlobalHeader"}:{event:"Sign_Out_From_LeftDrawerNavigation"}),i&&i()},[c,i]),f=()=>{var e;m(!1),l&&l(),d&&(null===(e=d.current)||void 0===e||e.focus())};return s.createElement("ul",{ref:p,className:`${Le}${c?` ${_e}`:""}`,"data-automation":"account-menu-content"},s.createElement("li",{className:Me,"data-automation":"my-bestbuy-logo"},s.createElement("span",null,(()=>{const e=a.includes("en")?r.sYn:r.MVs;return s.createElement(e,{className:xe,ariaLabel:g.myBestBuy})})())),s.createElement("hr",{className:Te}),C.map(e=>s.createElement(s.Fragment,null,s.createElement("li",{key:e.id},s.createElement("a",{className:c?ke:"",onClick:()=>{return t=e.text,window.sessionStorage.setItem("eVar34",`account;${t}`),n.N8.customLink(`Account Menu Click: ${t}`),void Y("My Account");var t},href:e.link,"data-automation":e.dataAutomation,onKeyDown:t=>((e,t)=>{switch(e.key){case"Escape":f();break;case"Tab":e.shiftKey&&0===C.findIndex(e=>e.id===t)&&(m(!0),setTimeout(()=>{var e,t;null===(t=null===(e=h.current)||void 0===e?void 0:e.querySelector("button"))||void 0===t||t.focus()},0),e.preventDefault())}})(t,e.id),"aria-label":e.ariaLabel},c&&e.icon,s.createElement("span",null,e.text))),s.createElement("hr",{className:Te}))),s.createElement("li",null,s.createElement(Ae,{locale:a,cieServiceUrl:t,onSignOutSuccess:b,className:c?ke:"",hideIcon:!c,isButton:!0,onKeyDown:e=>{switch(e.key){case"Tab":!e.shiftKey&&m(!0);break;case"Escape":f()}}})),u&&s.createElement("li",{ref:h},s.createElement("hr",{className:Te}),s.createElement(r.zxk,{appearance:"tertiary",className:Ie,shouldFitContainer:!0,extraAttrs:{"data-automation":"account-menu-content-close-button"},onClick:f,onKeyDown:e=>{var t;switch(e.key){case"Tab":if(!e.shiftKey){const a=null===(t=p.current)||void 0===t?void 0:t.querySelector('a, button, input, select, textarea, [tabindex]:not([tabindex="-1"])');null==a||a.focus(),e.preventDefault()}break;case"Enter":case"Escape":case" ":f(),e.preventDefault()}}},g.closeButton)))};var $e;!function(e){e.ADD="add",e.EDIT="edit"}($e||($e={}));var Oe,Fe=$e;!function(e){e.CA="Canada",e.US="United States"}(Oe||(Oe={}));var Ve,Ue,ze,He,Re=Oe;!function(e){e.AB="Alberta",e.BC="British Columbia",e.PE="Prince Edward Island",e.MB="Manitoba",e.NB="New Brunswick",e.NS="Nova Scotia",e.NU="Nunavut",e.ON="Ontario",e.QC="Quebec",e.SK="Saskatchewan",e.NL="Newfoundland and Labrador",e.NT="Northwest Territories",e.YT="Yukon"}(Ve||(Ve={})),function(e){e.AB="Alberta",e.BC="Colombie-Britannique",e.PE="Île-du-Prince-Édouard",e.MB="Manitoba",e.NB="Nouveau-Brunswick",e.NS="Nouvelle-Écosse",e.NU="Nunavut",e.ON="Ontario",e.QC="Québec",e.SK="Saskatchewan",e.NL="Terre-Neuve et Labrador",e.NT="Territoires du Nord-Ouest",e.YT="Yukon"}(Ue||(Ue={})),function(e){e.AK="Alaska",e.AL="Alabama",e.AZ="Arizona",e.CA="California",e.NC="North Carolina",e.SC="South Carolina",e.CO="Colorado",e.CT="Connecticut",e.ND="North Dakota",e.DC="District of Columbia",e.DE="Delaware",e.FL="Florida",e.GA="Georgia",e.HI="Hawaii",e.ID="Idaho",e.IL="Illinois",e.IN="Indiana",e.IA="Iowa",e.KS="Kansas",e.KY="Kentucky",e.LA="Louisiana",e.ME="Maine",e.MD="Maryland",e.MA="Massachusetts",e.MI="Michigan",e.MN="Minnesota",e.MS="Mississippi",e.MO="Missouri",e.MT="Montana",e.NE="Nebraska",e.NV="Nevada",e.NH="New Hampshire",e.NJ="New Jersey",e.NY="New York",e.NM="New Mexico",e.OH="Ohio",e.OK="Oklahoma",e.OR="Oregon",e.PA="Pennsylvania",e.RI="Rhode Island",e.TN="Tennessee",e.TX="Texas",e.UT="Utah",e.VT="Vermont",e.VA="Virginia",e.WV="West Virginia",e.WA="Washington",e.WI="Wisconsin",e.WY="Wyoming"}(ze||(ze={})),function(e){e.AK="Alaska",e.AL="Alabama",e.AZ="Arizona",e.CA="Californie",e.NC="Caroline du Nord",e.SC="Caroline du Sud",e.CO="Colorado",e.CT="Connecticut",e.ND="Dakota du Nord",e.DC="District de Columbia",e.DE="Delaware",e.FL="Floride",e.GA="Georgie",e.HI="Hawaii",e.ID="Idaho",e.IL="Illinois",e.IN="Indiana",e.IA="Iowa",e.KS="Kansas",e.KY="Kentucky",e.LA="Louisiane",e.ME="Maine",e.MD="Maryland",e.MA="Massachusetts",e.MI="Michigan",e.MN="Minnesota",e.MS="Mississippi",e.MO="Missouri",e.MT="Montana",e.NE="Nebraska",e.NV="Nevada",e.NH="New Hampshire",e.NJ="New Jersey",e.NY="New York",e.NM="Nouveau Mexique",e.OH="Ohio",e.OK="Oklahoma",e.OR="Oregon",e.PA="Pennsylvanie",e.RI="Rhode Island",e.TN="Tennessee",e.TX="Texas",e.UT="Utah",e.VT="Vermont",e.VA="Virginie",e.WV="Virginie de l'Ouest",e.WA="Washington",e.WI="Wisconsin",e.WY="Wyoming"}(He||(He={}));const je={AB:["^T\\d[ABCEGHJKLMNPRSTVWXYZ]\\s?(\\d[ABCEGHJKLMNPRSTVWXYZ]\\d)$"],BC:["^V\\d[ABCEGHJKLMNPRSTVWXYZ]\\s?(\\d[ABCEGHJKLMNPRSTVWXYZ]\\d)$"],MB:["^R\\d[ABCEGHJKLMNPRSTVWXYZ]\\s?(\\d[ABCEGHJKLMNPRSTVWXYZ]\\d)$"],NB:["^E\\d[ABCEGHJKLMNPRSTVWXYZ]\\s?(\\d[ABCEGHJKLMNPRSTVWXYZ]\\d)$"],NL:["^A\\d[ABCEGHJKLMNPRSTVWXYZ]\\s?(\\d[ABCEGHJKLMNPRSTVWXYZ]\\d)$"],NS:["^B\\d[ABCEGHJKLMNPRSTVWXYZ]\\s?(\\d[ABCEGHJKLMNPRSTVWXYZ]\\d)$"],NT:["^(X0[EG]|X1A)\\s?(\\d[ABCEGHJKLMNPRSTVWXYZ]\\d)$"],NU:["^X0[ABC]\\s?(\\d[ABCEGHJKLMNPRSTVWXYZ]\\d)$"],ON:["^(?!(K1A\\s?(0C9|0G3|0G4|0H3|0H4|0J2|0J9|0M3|0M5|0M8|0N2|0N9|0S5|1C9|1G6|1K5|1K8|1L2|1L4|0M6|1H3|0M7)))[KLMNP]\\d[ABCEGHJKLMNPRSTVWXYZ]\\s?(\\d[ABCEGHJKLMNPRSTVWXYZ]\\d)$"],PE:["^C\\d[ABCEGHJKLMNPRSTVWXYZ]\\s?(\\d[ABCEGHJKLMNPRSTVWXYZ]\\d)$"],QC:["^(K1A\\s?(0C9|0G3|0G4|0H3|0H4|0J2|0J9|0M3|0M5|0M8|0N2|0N9|0S5|1C9|1K5|1G6|1K8|1L2|1L4|0M6|1H3|0M7))|(^[GHJ]\\d[ABCEGHJKLMNPRSTVWXYZ]\\s?(\\d[ABCEGHJKLMNPRSTVWXYZ]\\d))$"],SK:["^S\\d[ABCEGHJKLMNPRSTVWXYZ]\\s?(\\d[ABCEGHJKLMNPRSTVWXYZ]\\d)$"],YT:["^(Y0[AB]|Y1A)\\s?(\\d[ABCEGHJKLMNPRSTVWXYZ]\\d)$"]},We={addressAriaLabel:"Enter or edit your address",addressErrorMsg:"Please enter a valid address.",addressLabel:"Address",billingInfoCheckbox:"Use my contact information for billing.",cityAriaLabel:"Enter or edit your city",cityErrorMsg:"Please enter a valid city.",cityLabel:"City",countryAriaLabel:"Select a country",countryErrorMsg:"Please select a country.",countryLabel:"Country",countryOptionCanada:"Canada",countryOptionUS:"United States",firstNameAriaLabel:"Enter or edit your first Name",firstNameErrorMsg:"Please enter your first name.",firstNameLabel:"First Name",friendlyNameAriaLabel:"Give address a nickname",friendlyNameErrorMsg:"Please use standard characters.",friendlyNameHelper:"Example: My House",friendlyNameLabel:"Address Nickname (Optional)",lastNameAriaLabel:"Enter or edit your last Name",lastNameErrorMsg:"Please enter your last name.",lastNameLabel:"Last Name",phoneExtensionAriaLabel:"Enter or edit your phone extension",phoneExtensionErrorMsg:"Please enter a numeric extension up to 6 digits.",phoneExtensionLabel:"Ext. (Optional)",phoneNumberAriaLabel:"Enter or edit your phone number",phoneNumberErrorMsg:"Please enter a 10-digit phone number, including the area code.",phoneNumberLabel:"Phone Number",phoneUsageHint:" We’ll only call you if there’s an issue with the order.",postalCodeAriaLabel:"Enter or edit your postal code",postalCodeErrorMsg:"Please enter a valid postal code.",postalCodeLabel:"Postal Code",postalCodeRegionMismatchErrorMsg:"Please enter a valid postal code for the province selected.",provinceAriaLabel:"Select a province",provinceErrorMsg:"Please select a province.",provinceLabel:"Province",stateAriaLabel:"Select a state",stateErrorMsg:"Please select a state.",stateLabel:"State",zipCodeErrorMsg:"Please enter a valid zip code.",zipCodeLabel:"Zip Code"},Ye={addressAriaLabel:"Entrez ou modifiez votre adresse",addressErrorMsg:"Veuillez entrer une adresse valide.",addressLabel:"Adresse",billingInfoCheckbox:"Utilisez mes coordonnées pour la facturation.",cityAriaLabel:"Entrez ou modifiez votre ville",cityErrorMsg:"Veuillez entrer une ville valide.",cityLabel:"Ville",countryErrorMsg:"Veuillez sélectionner un pays.",countryLabel:"Pays",countryOptionCanada:"Canada",countryOptionUS:"États Unis",firstNameAriaLabel:"Entrez ou modifiez votre prénom",firstNameErrorMsg:"Veuillez entrer votre prénom.",firstNameLabel:"Prénom",friendlyNameAriaLabel:"Donnez un surnom à l’adresse",friendlyNameErrorMsg:"Veuillez utiliser des caractères standard.",friendlyNameHelper:"Exemple: Ma maison",friendlyNameLabel:"Surnom de l’adresse (optionnel)",lastNameAriaLabel:"Entrez ou modifiez votre nom de famille",lastNameErrorMsg:"Veuillez entrer votre nom de famille.",lastNameLabel:"Nom de famille",phoneExtensionAriaLabel:"Entrez ou modifiez votre numéro de poste",phoneExtensionErrorMsg:"Veuillez saisir un nombre jusqu’à un maximum de 6 chiffres.",phoneExtensionLabel:"Ext. (facultatif)",phoneNumberAriaLabel:"Entrez ou modifiez votre numéro de téléphone",phoneNumberErrorMsg:"Veuillez entrer un numéro de téléphone de 10 chiffres, incluant l’indicatif régional.",phoneNumberLabel:"Numéro de téléphone",phoneUsageHint:"Nous vous appellerons uniquement en cas de problème avec la commande.",postalCodeAriaLabel:"Entrez ou modifiez votre code postal",postalCodeErrorMsg:"Veuillez entrer un code postal valide.",postalCodeLabel:"Code postal",postalCodeRegionMismatchErrorMsg:"Veuillez entrer un code postal valide pour la province sélectionnée.",provinceAriaLabel:"Sélectionnez une province",provinceErrorMsg:"Veuillez sélectionner une province.",provinceLabel:"Province",stateAriaLabel:"Sélectionnez un état",stateErrorMsg:"Veuillez sélectionner une state.",stateLabel:"State",zipCodeAriaLabel:"Entrez ou modifiez votre code postal",zipCodeErrorMsg:"Veuillez entrer un code postal valide.",zipCodeLabel:"Code postal"};var Ke,Xe="required__acckor",qe="addAddressForm__accuow",Ge="input__accfwB",Ze="medium__acc6Hj",Je="large__accPlJ",Qe="addressFormTitle__accgYO",et="uppercase__acckli",tt="disabledDropdownArrow__accT3I",at="addressProvPostalContainer__accVzi",rt="addressPhoneContainer__acc2CD",st="addressNicknameContainer__acc8XI",nt="billingInfoCheckbox__accrPr",ot="largeItemsDisclaimer__accvbn",it="largeItemsDisclaimerIcon__accpVJ",ct="largeItemsDisclaimerText__accIab",lt="clear__accqEy",dt="addressInputContainer__accBMV",ut="extPhoneEntry__accw34";!function(e){e.firstName="firstName",e.lastName="lastName",e.friendlyName="friendlyName",e.addressLine1="addressLine1",e.city="city",e.countryCode="countryCode",e.postalCode="postalCode",e.regionCode="regionCode",e.phoneNumber="phoneNumber",e.primaryPhoneExtension="primaryPhoneExtension"}(Ke||(Ke={}));const mt=e=>{let{actionToPerform:t,addressDetails:a,addressHeading:n,handlePhoneNumberError:o,hideAddressNicknameInput:i,hideCountryInput:c,locale:l,lockCountryToCanada:d=!1,onFieldFocusHandler:u,hasPhoneNumberError:m,showBillingInfoCheckbox:p,largeItemsDisclaimerText:h,hideIconsFromScreenReaders:g=!1}=e;const C=s.useMemo(()=>[{element:"addressLine1",field:"Line1"},{element:"city",field:"City"},{element:"postalCode",field:"PostalCode"},{element:"regionCode",field:"ProvinceCode"},{element:"countryCode",field:"CountryIso2",mode:8}],[]),b=l.startsWith("fr")?Ye:We,f={addressLine1:(null==a?void 0:a.addressLine1)||"",city:(null==a?void 0:a.city)||"",countryCode:(null==a?void 0:a.countryCode)||"",firstName:(null==a?void 0:a.firstName)||"",friendlyName:(null==a?void 0:a.friendlyName)||"",lastName:(null==a?void 0:a.lastName)||"",phoneNumber:(null==a?void 0:a.primaryPhoneNumber)||"",postalCode:(null==a?void 0:a.postalCode)||"",primaryPhoneExtension:(null==a?void 0:a.primaryPhoneExtension)||"",regionCode:(null==a?void 0:a.regionCode)||""},[E,y]=s.useState(!1),[v,N]=s.useState(p&&a?f:{addressLine1:"",city:"",countryCode:"CA",firstName:"",friendlyName:"",lastName:"",phoneNumber:"",postalCode:"",primaryPhoneExtension:"",regionCode:""}),[A,w]=s.useState(!0),S=t===Fe.EDIT;s.useEffect(()=>{r.ZQW.setFields(C,I,{countries:{codesList:"CAN"},culture:l,key:"DB98-WX79-XM39-ZX59"})},[p?v:void 0]),s.useEffect(()=>{m&&y(m)},[m]),s.useEffect(()=>{S&&a&&N({addressLine1:a.addressLine1,city:a.city,countryCode:a.countryCode,firstName:a.firstName,friendlyName:a.friendlyName?a.friendlyName:"",lastName:a.lastName,phoneNumber:a.primaryPhoneNumber,postalCode:a.postalCode,primaryPhoneExtension:a.primaryPhoneExtension?a.primaryPhoneExtension:"",regionCode:a.regionCode})},[S,a]);const L=s.useCallback(e=>{if(e.length>0){const t=je[v.regionCode],a=new RegExp(t);if(t&&!a.test(e.toUpperCase()))return!1}return!0},[v]),M=s.useCallback((e,t)=>{E?y(!1):m&&o&&(o(),y(!1))},[E,m,o]),x=s.useCallback(e=>(t,a,r)=>{Ke.phoneNumber&&r&&y(!0),e===(Ke.firstName||Ke.lastName||Ke.phoneNumber||Ke.primaryPhoneExtension)&&((e,t)=>e!==t)(a,v[e])&&w(!1);const s=v;s[e]=a,N(Object.assign({},s))},[v]),I=s.useCallback(e=>{N(Object.assign(Object.assign({},v),e))},[v]),_=s.useCallback((e,t)=>{N(Object.assign(Object.assign({},v),{countryCode:t,postalCode:""}))},[v]),P=e=>S&&a?`${f[e]}`:p&&a?`${v[e]}`:"",k=s.useCallback(function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=arguments.length>2?arguments[2]:void 0;const n=(e,t)=>{"number"!=typeof t&&N(Object.assign(Object.assign({},v),{postalCode:t}))},o=L(v.postalCode),i=o||!(0,r.BdW)(v.postalCode)?b.postalCodeErrorMsg:b.postalCodeRegionMismatchErrorMsg;return"CA"===e||t?s.createElement(r.IIB,{asyncValidators:[(0,r.BSk)(6),r.Zez],className:`${Ge} ${Ze} ${et} ${Xe}`,errorMsg:i,error:!o,extraAttrs:{"aria-label":b.postalCodeAriaLabel,"data-automation":"postalCodeInput","aria-required":"true"},formatter:"*** ***",label:b.postalCodeLabel,maxLength:7,name:Ke.postalCode,handleSyncChange:x(Ke.postalCode),validators:[r.C1W,r.BdW,L],value:a,handleAsyncChange:n,onFocus:u}):s.createElement(r.IIB,{asyncValidators:[(0,r.BSk)(5),r.YTV],className:`${Ge} ${Ze} ${et} ${Xe}`,errorMsg:b.zipCodeErrorMsg,extraAttrs:{"data-automation":"zipCodeInput","aria-required":"true"},formatter:"#####",label:b.zipCodeLabel,maxLength:5,name:Ke.postalCode,handleSyncChange:x(Ke.postalCode),validators:[r.C1W,r.OOO],value:a,handleAsyncChange:n,onFocus:u})},[v]);return s.createElement(s.Fragment,null,s.createElement("div",{className:qe},!!n&&s.createElement("h4",{className:`${Qe} ${Ge} ${Je}`},n),p&&a&&!S?s.createElement(r.XZJ,{className:nt,extraAttrs:{"data-testid":"billingInfoCheckbox"},label:b.billingInfoCheckbox,name:"billingInfo",handleAsyncChange:()=>{if(A){const e=Object.assign(Object.assign({},v),{firstName:"",lastName:"",phoneNumber:"",primaryPhoneExtension:""});N(e),w(!1)}else{const e={firstName:f.firstName,lastName:f.lastName,phoneNumber:f.phoneNumber,primaryPhoneExtension:f.primaryPhoneExtension},t=Object.assign(Object.assign({},v),e);N(t),w(!0)}},value:A?"checked":""}):null,s.createElement("div",{className:dt},s.createElement(r.IIB,{asyncValidators:[r.ddX],className:`${Ge} ${Ze} ${Xe}`,errorMsg:b.firstNameErrorMsg,extraAttrs:{"aria-label":b.firstNameAriaLabel,"aria-required":"true","data-automation":"firstNameInput"},label:b.firstNameLabel,maxLength:29,name:Ke.firstName,handleSyncChange:x(Ke.firstName),validators:[r.C1W],value:P(Ke.firstName),onFocus:u}),s.createElement(r.IIB,{asyncValidators:[r.ddX],className:`${Ge} ${Ze} ${Xe}`,errorMsg:b.lastNameErrorMsg,extraAttrs:{"aria-label":b.lastNameAriaLabel,"aria-required":"true","data-automation":"lastNameInput"},label:b.lastNameLabel,maxLength:29,name:Ke.lastName,handleSyncChange:x(Ke.lastName),validators:[r.C1W],value:P(Ke.lastName),onFocus:u})),s.createElement("div",{className:rt},s.createElement(r.IIB,{asyncValidators:[(0,r.BSk)(10),r.JDc],className:`${Ge} ${Ze} ${Xe}`,errorMsg:b.phoneNumberErrorMsg,extraAttrs:{"aria-label":b.phoneNumberAriaLabel,"aria-required":"true","data-automation":"phoneInput",inputMode:"numeric"},formatter:"(###) ###–####",label:b.phoneNumberLabel,maxLength:14,name:Ke.phoneNumber,type:"tel",handleAsyncChange:M,handleSyncChange:x(Ke.phoneNumber),value:P(Ke.phoneNumber),validators:[r.C1W,(0,r.EiV)(10)],helperTxt:E?"":b.phoneUsageHint,onFocus:u}),s.createElement(r.IIB,{asyncValidators:[r.iM,(0,r.BSk)(6)],className:` ${ut} ${Ge} ${Ze}`,errorMsg:b.phoneExtensionErrorMsg,extraAttrs:{"aria-label":b.phoneExtensionAriaLabel,"data-automation":"extensionInput",inputMode:"numeric"},label:b.phoneExtensionLabel,name:Ke.primaryPhoneExtension,handleSyncChange:x(Ke.primaryPhoneExtension),value:S&&a&&a.primaryPhoneExtension?`${a.primaryPhoneExtension}`:"",validators:[r.iM,(0,r.BSk)(6)],onFocus:u})),s.createElement(r.IIB,{asyncValidators:[r.RHU],className:`${Ge} ${Je} ${Xe}`,errorMsg:b.addressErrorMsg,extraAttrs:{"aria-label":b.addressAriaLabel,"aria-required":"true","data-automation":"addressInput"},label:b.addressLabel,maxLength:70,name:Ke.addressLine1,handleSyncChange:x(Ke.addressLine1),type:"text",validators:[r.C1W],value:v.addressLine1,onFocus:u,children:h?s.createElement("div",{className:ot},s.createElement(r.kIV,{isAriaHidden:g,className:it}),s.createElement("p",{className:ct},h)):null}),s.createElement("div",{className:dt},s.createElement(r.IIB,{asyncValidators:[r.RHU],className:`${Ge} ${Ze} ${Xe}`,errorMsg:b.cityErrorMsg,extraAttrs:{"aria-label":b.cityAriaLabel,"aria-required":"true","data-automation":"cityInput"},label:b.cityLabel,maxLength:30,handleSyncChange:x(Ke.city),name:Ke.city,type:"text",value:v.city,validators:[r.C1W],onFocus:u}),s.createElement("div",{className:at},function(e,t){let a=arguments.length>3?arguments[3]:void 0;return"CA"===e||arguments.length>2&&void 0!==arguments[2]&&arguments[2]?s.createElement(r.cNM,{className:`${Ge} ${Ze} ${Xe}`,controllable:!0,errorMsg:b.provinceErrorMsg,extraAttrs:{"aria-label":b.provinceAriaLabel,"aria-required":"true","data-automation":"regionCodeSelector","aria-haspopup":"true"},label:b.provinceLabel,locale:t,name:Ke.regionCode,handleSyncChange:x(Ke.regionCode),validators:[r.C1W],value:a,isAriaHiddenForIcons:g}):s.createElement(r.OW4,{className:`${Ge} ${Ze} ${Xe}`,controllable:!0,extraAttrs:{"aria-label":b.stateAriaLabel,"aria-required":"true","data-automation":"regionCodeSelector"},name:Ke.regionCode,handleSyncChange:x(Ke.regionCode),validators:[r.C1W],value:a,locale:t,errorMsg:b.stateErrorMsg,label:b.stateLabel,isAriaHiddenForIcons:g})}(v.countryCode,l,d,v.regionCode),k(v.countryCode,d,v.postalCode))),!c&&s.createElement(r.PhF,{className:`${Ge} ${Ze} ${lt} ${d&&tt}`,controllable:!0,errorMsg:b.countryErrorMsg,extraAttrs:Object.assign({"aria-label":b.countryAriaLabel,"data-automation":"countryInput","aria-required":"true","aria-haspopup":"true"},d&&{disabled:"disabled"}),label:b.countryLabel,name:Ke.countryCode,value:v.countryCode,handleSyncChange:(e,t)=>{"number"!=typeof t&&(_(e,t),x(Ke.countryCode)(e,t))},validators:[r.C1W],isAriaHiddenForIcons:g},s.createElement("option",{value:"CA"},b.countryOptionCanada),!d&&s.createElement("option",{value:"US"},b.countryOptionUS))),!i&&s.createElement("div",{className:st},s.createElement(r.IIB,{asyncValidators:[e=>new RegExp("^[a-zA-Z0-9À-ſ\\s`~,\\-_+=.'#!@$%^*()?{}\\[\\]:;|\\/]{0,50}$").test(String(e))],className:`${Ge} ${Ze}`,errorMsg:b.friendlyNameErrorMsg,extraAttrs:{"aria-label":b.friendlyNameAriaLabel,"data-automation":"nicknameInput"},helperTxt:b.friendlyNameHelper,label:b.friendlyNameLabel,maxLength:50,name:Ke.friendlyName,handleSyncChange:x(Ke.friendlyName),value:S&&a?`${a.friendlyName}`:"",onFocus:u})))};var pt;!function(e){e.phoneNumber="phoneNumber"}(pt||(pt={}));var ht={badgeDefault:"badgeDefault__accxdw",addressLabel:"addressLabel__accIL-",title:"title__accpqI",selectableContainer:"selectableContainer__accNkv",defaultText:"defaultText__accwxr",checkmark:"checkmark__acckcJ",container:"container__acckdX",oval:"oval__accUWe"};const gt=e=>{const t=(e=>{let{address:{isDefaultAddress:t},associatedAddressText:a,defaultAddressText:r,isAssociatedAddress:s,isShippingAddress:n,shippingAddressText:o}=e;return n&&o?o:s&&a?a:!0===t&&r?r:""})(e),{containerClassName:a,hideTitle:n,hidePhoneNumber:o,innerClassName:i,address:{friendlyName:c,firstName:l,lastName:d,suite:u,addressLine1:m,city:p,isDefaultAddress:h,regionCode:g,postalCode:C,primaryPhoneNumber:b,primaryPhoneExtension:f},isSelectable:E,isSelected:y,hideIconsFromScreenReader:v,checkmarkLogoAriaLabel:N}=e;return s.createElement("div",{className:`${ht.container} ${E?ht.selectableContainer:""}`},s.createElement("address",{className:`${ht.addressLabel} ${a||""}`},(t||c)&&s.createElement("h2",{className:`${ht.title} ${y?ht.select:""}`},s.createElement("span",{className:"addressLabelFriendlyName","data-automation":"address-nickname"},c),!n&&h&&s.createElement("span",{"data-automation":`address-${t}`},s.createElement(r.Cts,{className:ht.badgeDefault,title:t,appearance:"secondary"}))),s.createElement("div",{className:i||""},s.createElement("div",{"data-automation":"name"},`${l} ${d}`),s.createElement("div",{"data-automation":"address"},u&&`${u}-`,`${m},`),s.createElement("div",{"data-automation":"city-province-postalcode"},`${p}, ${g}, ${C.toUpperCase()}`),!o&&s.createElement("div",null,s.createElement("span",{"data-automation":"phone"},function(e){e=e.split(/[\s()-]+/).join("");const t=/^(\d{3})(\d{3})(\d{4})$/.exec(e);if(!t)return e;return`(${t[1]}) ${t[2]}-${t[3]}`}(b)),f&&s.createElement("span",{"data-automation":"phone-ext"},` ext. ${f}`)))),E&&(y?s.createElement(r.w2s,{className:ht.checkmark,isAriaHidden:v,"aria-label":N,"data-automation":"address-selected-checkmark"}):s.createElement("span",{className:ht.oval})))};var Ct="selectableAddressCard__acciF0",bt="chooseBillingAddressSelectorLabel__accov8",ft="addresses__accX8D",Et="newAddress__accSTh",yt="newAddressSelector__accgn6";const vt=e=>{let{addresses:t,associatedAddressId:a,associatedAddressText:n,defaultAddressText:o,disableSortByDefault:i,onSelect:c,selectedAddressId:l,shippingAddressId:d,shippingAddressText:u,otherAddressLabel:m,children:p,hideIconsFromScreenReader:h,checkmarkLogoAriaLabel:g,hideTitle:C=!0}=e;const b=i?t:t.slice().sort((e,t)=>e.isDefaultAddress?-1:t.isDefaultAddress?1:0),f=e=>t=>c(e),E=t?b.map((e,t)=>s.createElement(r.EUY,{key:e.id||t,name:e.id,className:Ct,selectedValue:e.id||t.toString(),onChange:f(e),extraAttrs:{"data-automation":"selectable-address-button"},label:s.createElement("div",{"data-automation":"selectable-address-card"},s.createElement(gt,{containerClassName:bt,address:e,associatedAddressText:n,defaultAddressText:o,isAssociatedAddress:e.id===a,isShippingAddress:e.id===d,shippingAddressText:u,isSelected:l===e.id,isSelectable:!0,hideTitle:C,hideIconsFromScreenReader:h,checkmarkLogoAriaLabel:g}))})):"";return s.createElement("div",{className:ft},s.createElement(r.FXm,{name:"address",hideCheckmarks:!0,value:l},E,s.createElement(r.EUY,{className:`${Et} ${yt}`,selectedValue:"new",label:m,onChange:f(void 0),extraAttrs:{"data-automation":"new-address-button"}},p)))};var Nt;!function(e){e.VISA="VISA",e.MC="MC",e.AMEX="AMEX",e.BBYCC="BBYCC"}(Nt||(Nt={}));var At,wt=Nt;!function(e){e.card="#### #### #### ####",e.amex="#### ###### #####",e.postalcode="### ###",e.phone="(###) ###-####",e.gcid="### ###### ## ####",e.gcidLong="### ###### ## #### ####"}(At||(At={}));const St=(e,t)=>{if(void 0===e)return e;let a=0;switch(e=e.split(" ").join(""),t){case At.postalcode:e=e.toUpperCase();break;case At.gcid:e.length>15&&(t=At.gcidLong)}return t.replace(/#/g,()=>e[a++]||"")},Lt=(e,t)=>({formatted:`**** **** **** ${t}`,lastFour:`**** **** **** ${t}`,masked:e===wt.AMEX?`**** ****** ${t}`:`**** **** **** ${t}`}),Mt={debitCardLabel:"Debit"},xt={debitCardLabel:"Débit"};var It={creditCardCvv:"creditCardCvv__acch0j",creditCardLabel:"creditCardLabel__acc7zk",creditCardDefaultLabel:"creditCardDefaultLabel__accMjp",nickNameContainer:"nickNameContainer__accxLI",creditCardNickname:"creditCardNickname__acccy2",selectableContainer:"selectableContainer__accoAU",selected:"selected__accjDg",debitCarLabel:"debitCarLabel__accve-",creditCardLogoImg:"creditCardLogoImg__accUXa",amex:"amex__accVE8",bbycc:"bbycc__accyzr",mc:"mc__accJQC",visa:"visa__accDBe",creditCardNumber:"creditCardNumber__accrgS",creditCardExpiryLabel:"creditCardExpiryLabel__acc4ye",creditCardExpired:"creditCardExpired__accT1E",ccContainer:"ccContainer__acc8YE",ccColumnCardInformation:"ccColumnCardInformation__acce45",showCreditCardForm:"showCreditCardForm__acc8Uo",ccContainerLogoText:"ccContainerLogoText__acc4am"};const _t=e=>{let{creditCard:{expirationMonth:t,expirationYear:a,isDefaultCreditCard:r,last4Digits:n,type:o,paymentType:i},cvvField:c,defaultLabelText:l="",editExpiryDate:d=!1,expirationText:u="",formatter:m,isSelected:p=!1,locale:h,nickName:g,isExpired:C,hideExpiration:b,isLogoWithText:f,isSelectable:E}=e;const y="fr-CA"===h?a%100+"/"+("0"+t).slice(-2):("0"+t).slice(-2)+"/"+a%100,v=(null==h?void 0:h.startsWith("fr"))?xt:Mt,N=r&&!!l,A=`${It.creditCardLabel} ${It.ccContainer} ${E?It.selectableContainer:""} ${f?` ${It.ccContainerLogoText}`:""}`;return s.createElement("div",{className:A,"data-automation":"credit-card-label"},s.createElement("div",{className:It.ccColumnCardInformation},"debit"===(null==i?void 0:i.toLocaleLowerCase())?s.createElement("span",{"data-automation":"debit-card-label",className:`${It.creditCardLogoImg} ${It.debitCarLabel}`},v.debitCardLabel):s.createElement("span",{"data-automation":"credit-card-logo",className:`${It.creditCardLogoImg} ${It[o.toLowerCase()]}`}),s.createElement("div",{className:It.nickNameContainer},g&&((e,t)=>s.createElement("span",{className:`${It.creditCardNickname} ${e?` ${It.selected}`:""} `,"data-automation":"credit-card-nickname"},t))(p,g),N&&s.createElement("span",{"data-automation":"credit-card-default-label",className:It.creditCardDefaultLabel},l)),m&&s.createElement("span",{className:It.creditCardNumber,"data-automation":"credit-card-number","aria-hidden":"true"},St(Lt(wt[o],n).masked,m)),!b&&s.createElement("div",{className:`${It.creditCardExpiryLabel} ${C?`${It.creditCardExpired}`:null}`,"data-automation":"credit-card-expiry-label","aria-hidden":"true"},`${u} ${y}`),p&&c&&s.createElement("div",null,s.createElement("div",{className:It.creditCardCvv,"data-automation":"credit-card-cvv"},c))))},Pt=e=>new RegExp("^([0-9]*)$").test(String(e)),kt=e=>!!String(e).length,Tt=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"0",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"2020";const a=new Date;return parseInt(t,10)!==a.getFullYear()||parseInt(e,10)>=a.getMonth()+1};var Dt;!function(e){e.VISA="VISA",e.MC="MC",e.AMEX="AMEX",e.BBYCC="BBYCC"}(Dt||(Dt={}));const Bt=[{cardType:Dt.VISA,exact:/^4\d*$/,lengths:[13,16],prefix:/^4$/},{cardType:Dt.MC,exact:/^(5[1-5]|2[2-7])\d*$/,lengths:[16],prefix:/^(5|5[1-5]|2|2[2-7])$/},{cardType:Dt.BBYCC,exact:/^(50284900|50284901|50284980|50284990|453094)\d*$/,lengths:[16],prefix:/^(50|502|5028|50284|502849|502849[089]|453094)$/},{cardType:Dt.AMEX,exact:/^3[47]\d*$/,lengths:[15],prefix:/^3$/}],$t=e=>""!==Ft(e),Ot=e=>Ft(e)!==Dt.BBYCC,Ft=e=>{const t=e.replace(/\s+/g,"");let a="";return Bt.forEach(e=>{(e.exact.test(t)||e.prefix.test(t))&&(a=e.cardType)}),a},Vt=e=>e===Dt.AMEX?4:3,Ut=e=>{e=e.replace(/\s+/g,"");const t=Ft(e),a=(e=>Bt.find(t=>t.cardType===e))(t);return""!==t&&null!=a&&null!=a.lengths.find(t=>t===e.length)&&(e=>{const t=[];for(let a=(e=e.replace(/ /gi,"")).length-2;a>=0;a-=2)t[t.length]=2*parseInt(e.charAt(a).toString(),10);let a=0;for(let e=0;e<=t.length-1;e++){let r=0;if(parseInt(t[e],10)>9){const a=parseInt(t[e],10).toString().length;for(let s=0;s<a;s++)r+=parseInt(parseInt(t[e],10).toString().charAt(s).toString(),10)}else r=parseInt(t[e],10);a+=r}let r=0;for(let t=e.length-1;t>=0;t-=2)r+=parseInt(e.charAt(t).toString(),10);return(r+a)%10==0})(e)};var zt;!function(e){e.card="#### #### #### ####",e.amex="#### ###### #####"}(zt||(zt={}));var Ht={container:"container__accXDB",cardNumber:"cardNumber__accnQw",formItem:"formItem__acctCP",expirationContainer:"expirationContainer__acc1FA",inputSmall:"inputSmall__accK5s",inputMedium:"inputMedium__accGVa",creditCardDetailsContainer:"creditCardDetailsContainer__accAbX",cardsSubText:"cardsSubText__acc08G",creditCardLogo:"creditCardLogo__accwZ7",inline:"inline__accWr2",hasType:"hasType__accpEL",visa:"visa__acc9rZ",mc:"mc__acc1qN",amex:"amex__accLo1"};const Rt={bestBuyCard:"Best Buy Card",cardNumber:"Card Number",cvv:"CVV",cvvErrorMsg:"Please enter a valid 3 or 4-digit CVV.",defaultLabelText:"Default",desjardinsCardFieldValidationError:"Your Desjardins Best Buy Card is inactive. Please select another payment method.",endingIn:"ending in",expiryMonth:"Expiry Month",expiryMonthErrorMsg:"Please enter a future expiry date.",expiryYear:"Expiry Year",expiryYearErrorMsg:"Please select your card's expiry year.",invalidCreditCard:"Please enter a valid credit card number.",month:"Month",newCardFormDescription:"We accept the following:",requiredMonthErrorMsg:"Please select your card's expiry month.",year:"Year",expiryMonthAriaLabel:"Select Expiry Month from list",expiryYearAriaLabel:"Select Expiry Year from list"},jt={bestBuyCard:"Carte Best Buy",cardNumber:"Numéro de la carte",cvv:"Numéro CVV",cvvErrorMsg:"Veuillez entrer un code CVV à 3 ou 4 chiffres valide.",defaultLabelText:"Défaut",desjardinsCardFieldValidationError:"Votre carte Best Buy Desjardins n’est plus active. Veuillez sélectionner une autre méthode de paiement.",endingIn:"se terminant en",expiryMonth:"Mois d'expiration",expiryMonthErrorMsg:"Veuillez entrer une date d'expiration future.",expiryYear:"Année d'expiration",expiryYearErrorMsg:"Veuillez sélectionner l'année d'expiration de votre carte.",invalidCreditCard:"Veuillez entrer un numéro de carte de crédit valide.",month:"Mois",newCardFormDescription:"Nous acceptons les cartes suivantes :",requiredMonthErrorMsg:"Veuillez sélectionner le mois d'expiration de votre carte.",year:"Année",expiryMonthAriaLabel:"Sélectionnez l’option Mois d’expiration dans la liste",expiryYearAriaLabel:"Sélectionnez l’option Année d'expiration dans la liste"};var Wt;!function(e){e.ccNumber="shownCardNumber",e.ccExpiryMonth="expirationMonth",e.ccExpiryYear="expirationYear",e.ccCvv="cvv"}(Wt||(Wt={}));class Yt extends s.Component{constructor(e){super(e),this.mastercardLabel="Mastercard",this.isEditing=()=>{const{actionToPerform:e}=this.props;return e===Fe.EDIT},this.getValueToEdit=e=>{const{creditCardDetails:t={}}=this.props;return this.isEditing()&&t[e]||""},this.cvvInput=e=>{return s.createElement(r.IIB,{asyncValidators:[Pt],className:`${Ht.formItem} ${Ht.inputSmall}`,errorMsg:e.cvvErrorMsg,extraAttrs:{"data-automation":`${Wt.ccCvv}Input`,autoComplete:"cc-csc"},label:e.cvv,maxLength:Vt(this.state.creditCardType),name:Wt.ccCvv,handleSyncChange:this.handleCCInputsUpdate(Wt.ccCvv),validators:[kt,(a=Vt(this.state.creditCardType),e=>!!e&&e.replace(/ +?/g,"").length>=a),(t=Vt(this.state.creditCardType),e=>!e||e.replace(/ +?/g,"").length<=t)]});var t,a},this.creditCardLabel=e=>{const{creditCardDetails:t}=this.props;if(!t)return;const a=t&&"AMEX"===t.type?zt.amex:zt.card,r={[Dt.MC]:this.mastercardLabel,[Dt.BBYCC]:e.bestBuyCard,[Dt.VISA]:Dt.VISA,[Dt.AMEX]:Dt.AMEX};return s.createElement(_t,{creditCard:t,cvvField:null,isSelected:!1,formatter:a,enabledNewVersion:!0,isLogoWithText:!0,defaultLabelText:e.defaultLabelText,nickName:`${r[t.type]}\n                    ${e.endingIn}\n                    ${t.last4Digits}`,hideExpiration:!0})},this.creditCardInput=e=>{const t=this.state.creditCardType&&`${Ht.hasType} ${Ht[this.state.creditCardType.toLocaleLowerCase()]}`,a=this.state.creditCardType===Dt.AMEX?zt.amex:zt.card;let n;const o=[kt];n=[$t,Ot];const i=this.state.creditCardType===Dt.BBYCC?e.desjardinsCardFieldValidationError:e.invalidCreditCard;return o.push(Ut),s.createElement(s.Fragment,null,s.createElement("p",{className:Ht.cardsSubText},e.newCardFormDescription),s.createElement("span",{className:`${Ht.creditCardLogo} space ${Ht.visa} ${Ht.inline}`}),s.createElement("span",{className:`${Ht.creditCardLogo} space ${Ht.mc} ${Ht.inline}`}),s.createElement("span",{className:`${Ht.creditCardLogo} space ${Ht.amex} ${Ht.inline}`}),s.createElement(r.x1X,{name:"ccType",value:this.state.creditCardType}),s.createElement(r.IIB,{asyncValidators:n,className:`${Ht.formItem} ${Ht.inputMedium} clear ${Ht.cardNumber} `+t,errorMsg:i,extraAttrs:{autoComplete:"cc-number","data-automation":`${Wt.ccNumber}Input`},formatter:a,handleAsyncChange:this.handleCcChange,handleSyncChange:this.handleCCInputsUpdate(Wt.ccNumber),label:e.cardNumber,name:Wt.ccNumber,noSubmit:!1,pattern:"[*0-9 ]*",value:this.state.ccinfo.ccNumber,validators:o}),s.createElement(r.x1X,{"data-automation":"cardNumberInput",name:"cardNumber",value:this.state.ccinfo.ccNumber}))},this.handleCcChange=(e,t)=>{if("number"==typeof t)return;this.cardTypeChanged(e,t);const a=Object.assign(Object.assign({},this.state.ccinfo),{ccNumber:t});this.setState({ccinfo:a})},this.cardTypeChanged=(e,t)=>{const a=Ft(t);this.state.creditCardType!==a&&this.setState({creditCardType:a}),this.state.hideCardTypeIndicator&&this.setState({hideCardTypeIndicator:!1})},this.optionRange=(e,t,a)=>{const r=[];for(let n=e;n<=t;n++){const e=n>9?""+n:"0"+n,t={key:e,value:n};r.push(s.createElement("option",Object.assign({},t),a?e:n))}return r},this.handleCCInputsUpdate=e=>(t,a)=>{if("number"==typeof a)return;const r=this.state.ccinfo;r[e]=a,this.setState({ccinfo:r})};const t=this.isEditing()?this.getValueToEdit(Wt.ccExpiryMonth):"",a=this.isEditing()?this.getValueToEdit(Wt.ccExpiryYear):"";this.state={ccinfo:{ccNumber:"",cvv:"",expirationMonth:t,expirationYear:a},creditCardType:"",expiryChanged:!1,hideCardTypeIndicator:!1}}componentDidMount(){if(!1!==this.props.autoFocus){const e=document.querySelector(`input[name="${Wt.ccNumber}"]`);e&&e.focus()}}render(){const{locale:e,hasCvv:t=!0,actionToPerform:a="add",creditCardDetails:n}=this.props,{ccinfo:o}=this.state,i="en-CA"===e?Rt:jt,c=!Tt(o.expirationMonth,o.expirationYear);return s.createElement("div",{className:Ht.container,"data-automation":"new-credit-card-form"},!this.isEditing()&&this.creditCardInput(i)||this.creditCardLabel(i),s.createElement("div",{className:Ht.expirationContainer},s.createElement(r.PhF,{className:`${Ht.formItem} ${Ht.inputSmall}`,error:c,errorMsg:c?i.expiryMonthErrorMsg:i.requiredMonthErrorMsg,extraAttrs:{autoComplete:"cc-exp-month","data-automation":`${Wt.ccExpiryMonth}Input`,"aria-label":i.expiryMonthAriaLabel,"aria-required":!0},handleSyncChange:this.handleCCInputsUpdate(Wt.ccExpiryMonth),label:i.expiryMonth,name:Wt.ccExpiryMonth,validators:[kt],value:n&&n.expirationMonth&&this.isEditing()?`${n.expirationMonth}`:void 0},"add"===a&&s.createElement("option",{value:""},i.month),this.optionRange(1,12,!0)),s.createElement(r.PhF,{"aria-required":!0,className:`${Ht.formItem} ${Ht.inputSmall}`,errorMsg:i.expiryYearErrorMsg,extraAttrs:{autoComplete:"cc-exp-year","data-automation":`${Wt.ccExpiryYear}Input`,"aria-label":i.expiryYearAriaLabel,"aria-required":!0},handleSyncChange:this.handleCCInputsUpdate(Wt.ccExpiryYear),label:i.expiryYear,name:Wt.ccExpiryYear,validators:[kt],value:n&&n.expirationYear&&this.isEditing()?`${n.expirationYear}`:void 0},!this.isEditing()&&s.createElement("option",{value:""},i.year),this.optionRange((new Date).getFullYear(),(new Date).getFullYear()+15)),t&&this.cvvInput(i)))}}const Kt={password:{defaultLabel:"Password",emptyErrorMsg:"Please enter your new password.",errorMsg:"Please review the password requirements.",passwordAriaLabel:"Enter a new password"},retypePassword:{defaultLabel:"Confirm Password",emptyErrorMsg:"Please enter your new password.",errorMsg:"This password doesn't match your new password. Please try again.",passwordAriaLabel:"Enter your new password again"},confirmPasswordAriaLabel:"Enter your new password again"},Xt={password:{defaultLabel:"Mot de passe",emptyErrorMsg:"Veuillez entrer votre nouveau mot de passe.",errorMsg:"Veuillez prendre connaissance des exigences relatives au mot de passe.",passwordAriaLabel:"Enter a new password"},retypePassword:{defaultLabel:"Confirmer le mot de passe",emptyErrorMsg:"Veuillez entrer votre nouveau mot de passe.",errorMsg:"Ce mot de passe ne correspond pas à votre nouveau mot de passe. Veuillez essayer à nouveau.",passwordAriaLabel:"Entrez à nouveau votre nouveau mot de passe"},confirmPasswordAriaLabel:"Entrez à nouveau votre nouveau mot de passe"},qt={containsEightToThirtyCharacters:"be at least 8 characters long.",containsLetter:"contain a letter.",containsNumber:"contain a number.",containsSymbol:"contain a symbol.",title:"Your password must:"},Gt={containsEightToThirtyCharacters:"comporter au moins 8 caractères.",containsLetter:"contenir une lettre.",containsNumber:"contenir un nombre.",containsSymbol:"contenir un symbole.",title:"Votre mot de passe doit : "};var Zt="passwordChecklist__accKdo",Jt="message__accGxj",Qt="invalid__acc-FX",ea="valid__acckNc";const ta=e=>/^.{8,30}$/.test(String(e)),aa=e=>/^(?=.*\d).+$/.test(String(e)),ra=e=>/^(?=.*[a-zA-Z]).+$/.test(String(e)),sa=e=>!!e&&!/^[a-z0-9]+$/i.test(String(e));var na={containsEightToThirtyCharacters:ta,containsLetter:ra,containsNumber:aa,containsSymbol:sa,isValidPassword:e=>e.length>0&&sa(e)&&ra(e)&&aa(e)&&ta(e)};class oa extends s.Component{constructor(e){super(e),this.validatePassword=e=>{const t=na.containsNumber(e),a=na.containsSymbol(e),r=na.containsLetter(e),s=na.containsEightToThirtyCharacters(e);this.setState({containsEightToThirtyCharacters:s,containsLetter:r,containsNumber:t,containsSymbol:a})},this.renderMessage=e=>this.messages[e],this.getItem=(e,t)=>s.createElement("li",{key:t,"data-automation":"password-checklist-item"},s.createElement("span",{className:`${e?`${e} `:""}${Jt}`},this.renderMessage(t))),this.state={containsEightToThirtyCharacters:!1,containsLetter:!1,containsNumber:!1,containsSymbol:!1}}componentWillReceiveProps(e){e.password!==this.props.password&&this.validatePassword(e.password)}render(){this.messages="fr"===this.props.locale.substring(0,2)?Gt:qt;const e=[];for(const t in this.state)t&&(!0===this.state[t]?e.push(this.getItem(ea,t)):!1===this.state[t]&&this.props.shouldCauseValidation?e.push(this.getItem(Qt,t)):e.push(this.getItem("",t)));return s.createElement("div",{className:Zt,"data-automation":"password-checklist"},this.messages.title,s.createElement("ul",null,e))}}var ia="passwordField__accN-n",ca="passwordChecklist__accXs2",la="passwordInputContainer__acczvq",da="confirmPassword__acc-7U",ua="confirmPasswordNoChecklist__accuD-";class ma extends s.Component{constructor(e){super(e),this.handlePasswordFocus=()=>{this.state.shouldDisplayPasswordChecklist||this.setState({shouldDisplayPasswordChecklist:!0})},this.handlePasswordSyncChange=(e,t)=>{na.isValidPassword(t.toString())?this.setState({passwordError:void 0}):this.setState({password:t.toString(),passwordError:!0,shouldCauseValidation:!0}),this.props.handleSyncChange&&na.isValidPassword(t.toString())&&this.state.confirmPassword===t&&!this.state.confirmPasswordError&&this.props.handleSyncChange(e,t.toString())},this.renderPasswordChecklist=()=>{if(this.state.shouldDisplayPasswordChecklist)return s.createElement(oa,{password:this.state.password,shouldCauseValidation:this.state.shouldCauseValidation,locale:this.props.locale})},this.handlePasswordAsyncChange=(e,t)=>{this.setState({password:t.toString(),passwordError:void 0}),this.props.handleAsyncChange&&(this.state.confirmPassword!==t||this.state.passwordError||this.state.confirmPasswordError?this.props.handleAsyncChange(this.props.name,""):this.props.handleAsyncChange(this.props.name,t.toString()))},this.confirmPasswordAsyncValidator=e=>{const{password:t}=this.state;for(let a=0;a<e.length;a++)if(t[a]!==e[a])return!1;return!0},this.handleConfirmPasswordAsyncChange=(e,t)=>{this.setState({confirmPassword:t.toString(),confirmPasswordError:void 0}),this.props.handleAsyncChange&&(this.state.password!==t||this.state.passwordError?this.props.handleAsyncChange(this.props.name,""):this.props.handleAsyncChange(this.props.name,t.toString()))},this.handleConfirmPasswordSyncChange=(e,t)=>{this.doPasswordsMatch?this.setState({confirmPasswordError:void 0}):this.setState({confirmPassword:t.toString(),confirmPasswordError:!0,shouldCauseValidation:!0})},this.doPasswordsMatch=()=>this.state.password===this.state.confirmPassword,this.state={confirmPassword:"",password:"",shouldCauseValidation:!1,shouldDisplayPasswordChecklist:!1}}render(){const e="fr"===this.props.locale.substring(0,2)?"fr":"en";this.messages="fr"===e?Xt:Kt;const t=this.state.password?this.messages.password.errorMsg:this.messages.password.emptyErrorMsg,a=this.state.confirmPassword?this.messages.retypePassword.errorMsg:this.messages.retypePassword.emptyErrorMsg;return s.createElement("div",{className:la},s.createElement(r.rop,{extraAttrs:{"aria-required":"true","data-automation":"new-password-input","aria-label":this.messages.password.passwordAriaLabel},className:ia,name:this.props.name,errorMsg:t,label:this.props.passwordLabel||this.messages.password.defaultLabel,error:this.state.passwordError,maxLength:30,lang:e,validators:[na.isValidPassword,r.C1W],handleAsyncChange:this.handlePasswordAsyncChange,handleSyncChange:this.handlePasswordSyncChange,onFocus:this.handlePasswordFocus,autoComplete:"off",type:"password",value:this.state.password}),s.createElement("div",{className:ca,"data-automation":"password-requirements-checklist"},this.renderPasswordChecklist()),s.createElement(r.rop,{extraAttrs:{"aria-required":"true","data-automation":"confirm-new-password-input","aria-label":this.messages.confirmPasswordAriaLabel},className:this.state.shouldDisplayPasswordChecklist?da:ua,name:this.props.retypePasswordName||"retypePassword",error:this.state.confirmPasswordError,errorMsg:a,label:this.props.confirmPasswordLabel||this.messages.retypePassword.defaultLabel,maxLength:30,lang:e,handleAsyncChange:this.handleConfirmPasswordAsyncChange,handleSyncChange:this.handleConfirmPasswordSyncChange,validators:[this.doPasswordsMatch],asyncValidators:[this.confirmPasswordAsyncValidator,r.C1W],autoComplete:"off",type:"password",value:this.state.confirmPassword}))}componentWillReceiveProps(e){const{error:t}=e;void 0!==t&&t&&this.setState(e=>({confirmPasswordError:t&&na.isValidPassword(e.password)&&!this.doPasswordsMatch(),passwordError:t&&!na.isValidPassword(e.password),shouldCauseValidation:t,shouldDisplayPasswordChecklist:t}))}}ma.defaultProps={controllable:!0};var pa;!function(e){e.CHECKOUT="checkout",e.GLOBAL="global",e.ORDER="order"}(pa||(pa={}));var ha=pa;class ga extends me{constructor(e){var t;let a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:ha.GLOBAL,s=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"";super(e,a),t=this,this.apiVerion=a,this.ACCEPTED_STATUSES=[J.OK,J.MultiStatus],this.generateHttpHeaders=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return q(t,void 0,void 0,function*(){const t=Object.assign(Object.assign({},e),{Accept:"application/vnd.bestbuy+json","Content-Type":"application/vnd.bestbuy+json"});return yield this.addCsrfToken(t),t})},this.addCsrfToken=e=>q(this,void 0,void 0,function*(){let t=m.getCsrfToken();const a=new he(this.cieServiceUrl);t||(yield a.getCsrfToken(),t=m.getCsrfToken()),t&&(e["X-TX"]=t)}),this.cieServiceUrl=e,this.contextId=r,this.bffProxyUrl=s}createAccount(e){const t=Object.create(null,{handleError:{get:()=>super.handleError}});return q(this,void 0,void 0,function*(){let a;a=this.bffProxyUrl?o.parse(`${this.bffProxyUrl}/createAccount?contextId=${this.contextId}`):o.parse(`${this.apiUrl}/accounts?contextId=${this.contextId}`);const r=o.format(a),s=yield this.generateHttpHeaders(),n=yield pe(r,{body:JSON.stringify(e),credentials:"include",headers:s,method:"post"});let i;try{i=yield n.json()}catch(e){Promise.reject(new Z(r,e.message))}if(!(this.ACCEPTED_STATUSES.indexOf(n.status)<0)){return{firstName:i.firstName,id:i.id,redirectUrl:i.redirectUrl,statusCode:n.status}}switch(i.message){case"ALREADY_EXISTS":return Promise.reject(new te(r,i.message));case"PASSWORD_BASIC_CRITERIA_FAILED":return Promise.reject(new oe(r,i.message));case"PASSWORD_BLACKLISTED":return Promise.reject(new ie(r,i.message));default:return t.handleError.call(this,n.status,r)}})}}const Ca={emailInputErrorMsg:"This is not a valid email address.",emailInputLabel:"Email",emailInputAriaLabel:"Enter your email address",firstNameInputErrorMsg:"Please enter a valid first name.",firstNameInputLabel:"First Name",firstNameAriaLabel:"Enter your first name",lastNameInputLabel:"Last Name",lastNameAriaLabel:"Enter your last name",lasttNameInputErrorMsg:"Please enter a valid last name.",password:{errorMsg:"Please review the password requirements.",label:"Password",ariaLabel:"Enter your password"}},ba={emailInputErrorMsg:"Veuillez entrer une adresse courriel valide.",emailInputLabel:"Adresse de courriel",emailInputAriaLabel:"Entrez votre adresse courriel",firstNameInputErrorMsg:"Veuillez entrer votre prénom.",firstNameInputLabel:"Prénom",firstNameAriaLabel:"Entrez votre prénom",lastNameInputLabel:"Nom de famille",lastNameAriaLabel:"Entrez votre nom de famille",lasttNameInputErrorMsg:"Veuillez entrer votre nom de famille.",password:{errorMsg:"Veuillez prendre connaissance des exigences relatives au mot de passe.",label:"Mot de passe",ariaLabel:"Entrez votre mot de passe"}},fa={containsEightToThirtyCharacters:"be at least 8 characters long.",containsLetter:"contain a letter.",containsNumber:"contain a number.",containsSymbol:"contain a symbol.",title:"Your password must:",acceptedItem:"You have met this requirement.",unAcceptedItem:"You have not met this requirement."},Ea={containsEightToThirtyCharacters:"comporter au moins 8 caractères.",containsLetter:"contenir une lettre.",containsNumber:"contenir un nombre.",containsSymbol:"contenir un symbole.",title:"Votre mot de passe doit : ",acceptedItem:"Vous respectez cette exigence.",unAcceptedItem:"Vous ne respectez pas cette exigence."};var ya="passwordChecklist__accfTa",va="message__accfDq",Na="icon__accvZe",Aa="invalid__acciOW",wa="invalidIcon__accdSD",Sa="valid__accOBo",La="validIcon__acczPB",Ma="srOnly__accLtX";const xa=e=>/^.{8,30}$/.test(String(e)),Ia=e=>/^(?=.*\d).+$/.test(String(e)),_a=e=>/^(?=.*[a-zA-Z]).+$/.test(String(e)),Pa=e=>!!e&&!/^[a-z0-9]+$/i.test(String(e));var ka,Ta={containsEightToThirtyCharacters:xa,containsLetter:_a,containsNumber:Ia,containsSymbol:Pa,isValidPassword:e=>e.length>0&&Pa(e)&&_a(e)&&Ia(e)&&xa(e)};class Da extends s.Component{constructor(e){super(e),this.validatePassword=e=>{const t=Ta.containsNumber(e),a=Ta.containsSymbol(e),r=Ta.containsLetter(e),s=Ta.containsEightToThirtyCharacters(e);this.setState({containsEightToThirtyCharacters:s,containsLetter:r,containsNumber:t,containsSymbol:a})},this.renderMessage=e=>this.messages[e],this.getItem=(e,t)=>s.createElement("li",{key:t,"aria-live":"assertive","aria-atomic":"true","data-automation":"create-account-password-checklist-item"},s.createElement("span",{"aria-hidden":!0,className:`${e?`${e===Sa?La:wa} `:""}${Na}`}),s.createElement("span",{className:`${e?`${e} `:""}${va}`},this.renderMessage(t)),s.createElement("span",{className:Ma},`${this.renderMessage(e===Sa?"acceptedItem":"unAcceptedItem")}`)),this.state={containsEightToThirtyCharacters:!1,containsLetter:!1,containsNumber:!1,containsSymbol:!1}}componentWillReceiveProps(e){e.password!==this.props.password&&this.validatePassword(e.password)}render(){this.messages="fr"===this.props.locale.substring(0,2)?Ea:fa;const e=[];for(const t in this.state)t&&(!0===this.state[t]?e.push(this.getItem(Sa,t)):!1===this.state[t]&&this.props.shouldCauseValidation?e.push(this.getItem(Aa,t)):e.push(this.getItem("",t)));return s.createElement("div",{className:ya,"data-automation":"create-account-password-checklist"},this.messages.title,s.createElement("ul",null,e))}}class Ba extends s.Component{constructor(e){super(e),this.handlePasswordFocus=()=>{this.state.shouldDisplayPasswordChecklist||this.setState({shouldDisplayPasswordChecklist:!0})},this.handlePasswordSyncChange=(e,t)=>{Ta.isValidPassword(t.toString())?this.setState({passwordError:void 0}):this.setState({password:t.toString(),passwordError:!0,shouldCauseValidation:!0}),this.props.handleSyncChange&&Ta.isValidPassword(t.toString())&&this.state.confirmPassword===t&&!this.state.confirmPasswordError&&this.props.handleSyncChange(e,t)},this.handlePasswordAsyncChange=(e,t)=>{this.setState({password:t.toString(),passwordError:void 0}),this.props.handleAsyncChange&&(this.state.confirmPassword!==t||this.state.passwordError||this.state.confirmPasswordError?this.props.handleAsyncChange(this.props.name,""):this.props.handleAsyncChange(this.props.name,t.toString()))},this.doPasswordsMatch=()=>this.state.password===this.state.confirmPassword,this.state={confirmPassword:"",password:"",shouldCauseValidation:!1,shouldDisplayPasswordChecklist:!1}}render(){const e="fr"===this.props.locale.substring(0,2)?"fr":"en";return this.messages="fr"===e?ba:Ca,s.createElement("div",null,s.createElement(r.rop,{extraAttrs:{"aria-label":this.messages.password.ariaLabel,"aria-required":"true","data-automation":"passwordInput"},name:"password",errorMsg:this.messages.password.errorMsg,label:this.props.passwordLabel||this.messages.password.label,error:this.state.passwordError,maxLength:30,lang:e,validators:[Ta.isValidPassword],handleAsyncChange:this.handlePasswordAsyncChange,handleSyncChange:this.handlePasswordSyncChange,onFocus:this.handlePasswordFocus,autoComplete:"off",value:this.state.password}),this.state.shouldDisplayPasswordChecklist&&s.createElement(Da,{password:this.state.password,shouldCauseValidation:this.state.shouldCauseValidation,locale:this.props.locale}))}componentWillReceiveProps(e){const{error:t}=e;void 0!==t&&t&&this.setState(e=>({confirmPasswordError:t&&Ta.isValidPassword(e.password)&&!this.doPasswordsMatch(),passwordError:t&&!Ta.isValidPassword(e.password),shouldCauseValidation:t,shouldDisplayPasswordChecklist:t}))}}Ba.defaultProps={controllable:!0},function(e){e["006"]="Sorry, we couldn't create your account. Please try again.",e["007"]="Sorry, the password you’ve chosen has been blacklisted for security reasons. Please choose another password.",e["009"]="An account with this email already exists. Click below to link your order."}(ka||(ka={}));const $a={createAccountCheckoutFormEmail:"Email Address",createAccountCheckoutFormIntro:"You’re almost there! Simply create a password and we’ll connect this guest order to your new account.",createAccountCheckoutFormSubmit:"Create Account",createAccountCheckoutFormSubtext:"You'll be able to get your receipt, check your order status, and checkout faster.",createAccountCheckoutFormTitle:"Want an account?",createAccountCheckoutSuccessConfirmation:"Your account has been created!",disclaimer:"By continuing you agree to our",disclaimerSeparation:"and",globalErrorMessagesBadRequestError:ka["006"],globalErrorMessagesInternalServerError:ka["006"],globalErrorMessagesPasswordBasicCriteriaFailedError:ka["006"],globalErrorMessagesPasswordBlacklistedError:ka["007"],globalErrorMessagesResourceAlreadyExistsError:ka["009"],keepBrowsing:"Keep browsing",linkOrderButton:"Link order",privacyPolicy:"Privacy Policy",termsCondition:"Terms and Conditions",underFourteenConsent:", and confirm you have reached the age of majority (18 or 19) in your province or territory of residence."};var Oa;!function(e){e["006"]="Désolés, la création de votre compte a échoué. Veuillez réessayer.",e["007"]="Désolés, pour des raisons de sécurité, le mot de passe choisi a été mis sur liste noire. Veuillez choisir un nouveau mot de passe.",e["009"]="Il existe déjà un compte avec cette adresse courriel. Cliquez ci-dessous pour lier votre commande."}(Oa||(Oa={}));const Fa={createAccountCheckoutFormEmail:"Adresse de courriel",createAccountCheckoutFormIntro:"Vous y êtes presque! Il vous suffit de créer un mot de passe pour activer votre compte.",createAccountCheckoutFormSubmit:"Créer un compte",createAccountCheckoutFormSubtext:"Vous pourrez recevoir votre reçu, vérifier l'état de votre commande et procéder plus rapidement au paiement.",createAccountCheckoutFormTitle:"Vous aimeriez avoir un compte?",createAccountCheckoutSuccessConfirmation:"Votre compte a correctement été créé!",disclaimer:"En continuant, vous acceptez les",disclaimerSeparation:"et la",globalErrorMessagesBadRequestError:Oa["006"],globalErrorMessagesInternalServerError:Oa["006"],globalErrorMessagesPasswordBasicCriteriaFailedError:Oa["006"],globalErrorMessagesPasswordBlacklistedError:Oa["007"],globalErrorMessagesResourceAlreadyExistsError:Oa["009"],keepBrowsing:"Continuer à naviguer",linkOrderButton:"Lier la commande",privacyPolicy:"politique de confidentialité",termsCondition:"conditions",underFourteenConsent:" et confirmez que vous avez atteint l'âge de la majorité (18 ou 19 ans) dans votre province ou territoire de résidence."};var Va="passwordInput__accsuK",Ua="createAccountButton__accRof",za="createAccountFormContainer__accDZk",Ha="createAccountFormIntro__accttD",Ra="createAccountFormEmail__accfy9",ja="linkOrderButton__accfUB",Wa="disclaimerMessage__accN0v",Ya="chevronRight__accc8-";class Ka extends s.Component{constructor(e){super(e),this.reCaptcha=null,this.handleOnSubmit=(e,t,a)=>q(this,void 0,void 0,function*(){t.preventDefault(),this.setState({globalErrorMessage:"",isSubmitting:!0,password:a.password.value}),this.reCaptcha&&this.reCaptcha.execute()}),this.required=e=>!!e.length,this.resetRecaptcha=()=>{this.reCaptcha&&this.reCaptcha.reset()},this.getGlobalErrorMessage=()=>{this.messages=this.props.locale.startsWith("fr")?Fa:$a;const{accountAlreadyExist:e,globalErrorMessage:t}=this.state;if(t)return s.createElement(r.ffo,{message:this.state.globalErrorMessage},e&&s.createElement(r.zxk,{appearance:"transparent",onClick:this.handlelinkOrderClick,className:ja},this.messages.linkOrderButton,s.createElement(r._Qn,{color:"blue",className:Ya})))},this.handlelinkOrderClick=()=>{this.props.onCreateAccountAlreadyExists&&this.props.onCreateAccountAlreadyExists()},this.handleRecaptchaExpired=()=>{this.resetRecaptcha()},this.handleRecaptchaChange=e=>q(this,void 0,void 0,function*(){const{email:t,isBillingSameAsShipping:a,isQPU:r,orderNumber:s,locale:n,tid:o}=this.props,{password:i}=this.state,c=Object.assign(Object.assign({captchaResponse:e,email:t,isBillingSameAsShipping:a},r&&{isQPU:!0}),{locale:n,orderNumber:s,password:i,tid:o});try{const e=yield this.apiCreateAccountProvider.createAccount(c);this.props.onCreateAccountSuccess&&this.props.onCreateAccountSuccess(e),this.setState({isSubmitting:!1})}catch(e){this.handleError(e)}}),this.getDisclaimerMessage=()=>{const{privacyPolicyLink:e,termsConditionLink:t,locale:a}=this.props;return this.messages=a.startsWith("fr")?Fa:$a,s.createElement("div",{className:Wa,"data-automation":"disclaimer"},s.createElement("span",null,this.messages.disclaimer,s.createElement("a",{href:t,"data-automation":"terms-and-conditions"},` ${this.messages.termsCondition} `," "),this.messages.disclaimerSeparation,s.createElement("a",{href:e,"data-automation":"privacy-policy"},` ${this.messages.privacyPolicy}`),this.messages.underFourteenConsent))},this.handleError=e=>{this.resetRecaptcha();let t="";t=e instanceof te?this.messages.globalErrorMessagesResourceAlreadyExistsError:e instanceof oe?this.messages.globalErrorMessagesPasswordBasicCriteriaFailedError:e instanceof ie?this.messages.globalErrorMessagesPasswordBlacklistedError:e instanceof ee?this.messages.globalErrorMessagesBadRequestError:this.messages.globalErrorMessagesInternalServerError;const a=t.match(/\[(.*)\]/);this.props.analyticsTracker&&this.props.analyticsTracker(Ka.createAccountFormAnalyticsEventNames.accountCreationFailure,a&&a[1]||void 0),this.setState(a=>Object.assign(Object.assign({},a),{accountAlreadyExist:e instanceof te,globalErrorMessage:t,isSubmitting:!1}))},this.state={accountAlreadyExist:!1,globalErrorMessage:"",isSubmitting:!1,password:""},this.apiCreateAccountProvider=new ga(e.cieServiceUrl,2,ha.CHECKOUT)}render(){if(this.props.recaptchaSitekey&&this.props.cieServiceUrl)return this.messages=this.props.locale.startsWith("fr")?Fa:$a,s.createElement("div",{className:za},s.createElement("div",{"data-automation":"global-error-message"},this.getGlobalErrorMessage()),s.createElement("div",{className:Ha},this.messages.createAccountCheckoutFormIntro),s.createElement("div",{className:Ra,"data-automation":"create-account-email"},this.messages.createAccountCheckoutFormEmail,s.createElement("span",null,this.props.email)),s.createElement(r.l09,{name:"createAccount",onSubmit:this.handleOnSubmit,autoComplete:"off"},s.createElement("fieldset",{className:Va,"data-automation":"password-form"},s.createElement(Ba,{name:"password",locale:this.props.locale,validators:[this.required]})),s.createElement(r.zxk,{extraAttrs:{"data-automation":"submitButton"},className:Ua,type:"submit",appearance:"primary",shouldFitContainer:!0,isDisabled:this.state.isSubmitting},this.messages.createAccountCheckoutFormSubmit),this.getDisclaimerMessage(),s.createElement(i.ZP,{ref:e=>this.reCaptcha=e,sitekey:this.props.recaptchaSitekey,onChange:this.handleRecaptchaChange,onExpired:this.handleRecaptchaExpired,size:"invisible"})))}componentDidMount(){this.props.analyticsTracker&&this.props.analyticsTracker(Ka.createAccountFormAnalyticsEventNames.componentLoaded)}}Ka.createAccountFormAnalyticsEventNames={accountCreationFailure:"analytics-create-account-error-order-confirmation",accountCreationSuccess:"analytics-create-account-success-order-confirmation",componentLoaded:"analytics-create-account-loaded-order-confirmation"};s.Component;var Xa="iframeWrapper__accyiw",qa="iframe__accnqk",Ga="inlineError__acczR1";const Za="cc-iframe",Ja=e=>{let{ccIframeDomain:t,onError:a,onSuccess:r,onIframeError:n,locale:i,hasCvv:c=!1,hasCSRContext:l=!1}=e;const[d,u]=s.useState(!1),[m,p]=s.useState(!1),[h,g]=s.useState(`${qa}`),C=`${t}/${i.toLowerCase()}`,b=o.parse(C);b.search=`hasCvv=${c}${l?"&context=CSR":""}`,s.useEffect(()=>(void 0!==typeof window&&window.addEventListener("message",f),()=>{void 0!==typeof window&&window.removeEventListener("message",f)}),[]),s.useEffect(()=>{const e=setTimeout(()=>{d||n()},3e3);return()=>{clearTimeout(e)}},[d]),s.useEffect(()=>{g(`${qa} ${m?Ga:""}`)},[m]);const f=s.useCallback(e=>{let{data:t,origin:s}=e;s===`${b.protocol}//${b.host}`&&(t.hasLoaded&&u(!0),p(t.addFieldError),t.addSuccess&&r(t.ccInfo),a(t.addError,t.addFieldError))},[r,a]),E=o.format(b);return s.createElement("div",{className:Xa},s.createElement("iframe",{id:Za,title:"cc",sandbox:"allow-scripts allow-same-origin",className:h,src:E,scrolling:"no"}))},Qa={addNewAddress:"Add a new address",addressErrorMsg:"Please enter a valid address.",addressLabel:"Address",billingAddressHeader:"Choose a billing address",cancelButton:"Cancel",cardNicknameFieldLabel:"Name This Card (Optional)",cardOptionsHeader:"Card Options",checkmarkLogoAriaLabel:"Selected Address",cityErrorMsg:"Please enter a valid city.",cityLabel:"City",countryErrorMsg:"Please select a country.",countryLabel:"Country",countryOptionCanada:"Canada",countryOptionUS:"United States",creditCardNumberFieldLabel:"Card Number",default:"Default Shipping Address",defaultCreditCardSelector:"Set as default credit card",editBillingAddressHeader:"Billing Address",errorMessage:"Sorry, there was a problem deleting this card. Please try again.",expiryMonthFieldLabel:"Expiry Month",expiryYearFieldLabel:"Expiry Year",firstNameErrorMsg:"Please enter your first name.",firstNameLabel:"First Name",lastNameErrorMsg:"Please enter your last name.",lastNameLabel:"Last Name",newBillingAddressHeader:"Add a new address",newCardHeader:"Add a new card",newCardSubtext:"We accept the following cards.",nicknameLabel:"Name This Address (Optional)",phoneExtensionErrorMsg:"Please enter a valid phone extension.",phoneExtensionLabel:"Ext. (Optional)",phoneNumberErrorMsg:"Please enter a 10-digit phone number, including the area code.",phoneNumberLabel:"Phone Number",postalCodeErrorMsg:"Please enter a valid postal code.",postalCodeLabel:"Postal Code",provinceErrorMsg:"Please select a province.",provinceLabel:"Province",saveButton:"Save",stateErrorMsg:"Please select a state.",stateLabel:"State",zipCodeErrorMsg:"Please enter a valid zip code.",zipCodeLabel:"Zip Code"},er={addNewAddress:"Ajouter une nouvelle adresse",addressErrorMsg:"Veuillez entrer une adresse valide.",addressLabel:"Adresse",billingAddressHeader:"Sélectionner une adresse de facturation",cancelButton:"Annuler",cardNicknameFieldLabel:"Donnez un nom à cette carte (facultatif)",cardOptionsHeader:"Options de la carte",checkmarkLogoAriaLabel:"Adresse sélectionnée",cityErrorMsg:"Veuillez entrer une ville valide.",cityLabel:"Ville",countryErrorMsg:"Veuillez sélectionner un pays.",countryLabel:"Pays",countryOptionCanada:"Canada",countryOptionUS:"États Unis",creditCardNumberFieldLabel:"Numéro de la carte",default:"Défaut",defaultCreditCardSelector:"Définir comme carte de crédit par défaut",editBillingAddressHeader:"Adresse de facturation",errorMessage:"Désolé, une erreur s’est produite lors de la suppression de cette carte. Veuillez réessayer.",expiryMonthFieldLabel:"Mois d’expiration",expiryYearFieldLabel:"Année d’expiration",firstNameErrorMsg:"Veuillez entrer votre prénom.",firstNameLabel:"Prénom",lastNameErrorMsg:"Veuillez entrer votre nom de famille.",lastNameLabel:"Nom de famille",newBillingAddressHeader:"Ajouter une nouvelle adresse",newCardHeader:"Ajouter une nouvelle carte",newCardSubtext:"Nous acceptons les cartes suivantes.",nicknameLabel:"Donnez un nom à cette adresse (facultatif)",phoneExtensionErrorMsg:"Veuillez entrer un poste téléphonique valide.",phoneExtensionLabel:"Ext. (facultatif)",phoneNumberErrorMsg:"Veuillez entrer un numéro de téléphone de 10 chiffres, incluant l’indicatif régional.",phoneNumberLabel:"Numéro de téléphone",postalCodeErrorMsg:"Veuillez entrer un code postal valide.",postalCodeLabel:"Code postal",provinceErrorMsg:"Veuillez sélectionner une province.",provinceLabel:"Province",saveButton:"Enregistrer",stateErrorMsg:"Veuillez sélectionner une state.",stateLabel:"State",zipCodeErrorMsg:"Veuillez entrer un code postal valide.",zipCodeLabel:"Code postal"};var tr="addNewAddressBtn__accuXW",ar="addressFormOpened__accnXu",rr="ccFormTitle__accjx8",sr="addressesSection__accBDn",nr="ccFormBillingTitle__accENP";class or extends s.Component{constructor(e){super(e),this.getCreditCardFieldsProps=()=>{const{actionToPerform:e,creditCardDetails:t,hasCvv:a,locale:r,autoFocus:s}=this.props,n={actionToPerform:e,autoFocus:s,hasCvv:a||!1,locale:r};return t?Object.assign(Object.assign({},n),{creditCardDetails:t}):n},this.selectDefaultAddress=()=>{if(this.props.addresses.length){const e=this.state.selectableAddresses.map((e,t)=>Object.assign(Object.assign({},e),{id:e.id||`${t}`})),t=e.find(e=>!0===e.isDefaultAddress)||e[0];this.setState({defaultAddressId:t&&t.id,selectableAddresses:e}),this.props.setSelectedAddress(t)}else this.setState({createNewAddress:!0,defaultAddressId:void 0})},this.scrollToAddressForm=()=>{const e=document.querySelector(`.${tr}`);if(!e)return;const t=e.getBoundingClientRect().top+window.pageYOffset-30;(0,r.eFH)(t)},this.onHandleIframeError=()=>{this.props.onIframeError&&this.props.onIframeError()},this.onChangeCard=e=>{e||this.scrollToAddressForm(),this.setState({createNewAddress:!e}),this.props.setSelectedAddress(e)},this.renderAddNewAddressButton=()=>s.createElement("div",{className:`${tr} ${this.state.createNewAddress?ar:""}`,"data-automation":"add-new-address-btn","aria-labelledby":"addNewAddressButton"},s.createElement("span",{"aria-hidden":"true",id:"addNewAddressButton"},this.messages.addNewAddress)),this.renderBillingAddress=()=>{const{selectableAddresses:e,createNewAddress:t}=this.state,a=this.props.selectedAddress?this.props.selectedAddress.id:"";if(!e.length||this.isEditForm()){const e=this.props.creditCardDetails?this.props.creditCardDetails.billingAddress:void 0;return s.createElement(mt,{actionToPerform:this.isEditForm()?"edit":"add",addressDetails:e,locale:this.props.locale})}return s.createElement(vt,{addresses:e,defaultAddressText:this.messages.default,onSelect:this.onChangeCard,selectedAddressId:a,otherAddressLabel:this.renderAddNewAddressButton(),checkmarkLogoAriaLabel:this.messages.checkmarkLogoAriaLabel,hideIconsFromScreenReader:!0},t&&s.createElement(mt,{actionToPerform:"add",locale:this.props.locale}))},this.isEditForm=()=>{const{actionToPerform:e}=this.props;return e===Fe.EDIT};const t=this.isEditForm();this.state={createNewAddress:!1,selectableAddresses:t?[]:e.addresses||[]}}componentDidMount(){this.selectDefaultAddress()}componentDidUpdate(e){this.props.addresses!==e.addresses&&this.selectDefaultAddress()}render(){const e=this.isEditForm()?"editBillingAddressHeader":"billingAddressHeader";return this.messages=this.props.locale.startsWith("fr")?er:Qa,s.createElement(s.Fragment,null,!this.isEditForm()&&this.props.isPaymentWebappEnabled?s.createElement(Ja,{onSuccess:this.props.onAddCreditCardSuccess,onError:this.props.onAddCreditCardError,onIframeError:this.onHandleIframeError,ccIframeDomain:this.props.ccIframeDomain||"",locale:this.props.locale,hasCSRContext:this.props.hasCSRContext||!1}):s.createElement(Yt,Object.assign({},this.getCreditCardFieldsProps())),s.createElement("div",{className:sr},s.createElement("h2",{className:`${rr} ${nr}`},this.messages[e]),this.renderBillingAddress()))}}or.defaultProps={actionToPerform:Fe.ADD};const ir={addNewAddress:"Add a new address",addressErrorMsg:"Please enter a valid address.",addressLabel:"Address",cancelButton:"Cancel",cardNicknameFieldLabel:"Name This Card (Optional)",cardOptionsHeader:"Card Options",cityErrorMsg:"Please enter a valid city.",cityLabel:"City",countryErrorMsg:"Please select a country.",countryLabel:"Country",countryOptionCanada:"Canada",countryOptionUS:"United States",creditCardNumberFieldLabel:"Card Number",default:"Default Shipping Address",defaultCreditCardSelector:"Set as default credit card",editBillingAddressHeader:"Billing Address",editCardCSRHeader:"Edit this credit card",editCardHeader:"Edit your credit card",editCardHint:"You can change the expiry details and billing address:",errorMessage:"Sorry, there was a problem deleting this card. Please try again.",expiryMonthFieldLabel:"Expiry Month",expiryYearFieldLabel:"Expiry Year",firstNameErrorMsg:"Please enter your first name.",firstNameLabel:"First Name",formAccessibilityErrorMsg:"Error: Sorry, something went wrong. Please check required fields and try saving again.",lastNameErrorMsg:"Please enter your last name.",lastNameLabel:"Last Name",newBillingAddressHeader:"Add a new address",newCardHeader:"Add a new credit card",newCardSubtext:"We accept the following:",nicknameLabel:"Name This Address (Optional)",phoneExtensionErrorMsg:"Please enter a valid phone extension.",phoneExtensionLabel:"Ext. (Optional)",phoneNumberErrorMsg:"Please enter a 10-digit phone number, including the area code.",phoneNumberLabel:"Phone Number",postalCodeErrorMsg:"Please enter a valid postal code.",postalCodeLabel:"Postal Code",provinceErrorMsg:"Please select a province.",provinceLabel:"Province",saveButton:"Save",saveButtonAriaLabel:"Save new payment method",stateErrorMsg:"Please select a state.",stateLabel:"State",zipCodeErrorMsg:"Please enter a valid zip code.",zipCodeLabel:"Zip Code"},cr={addNewAddress:"Ajouter une nouvelle adresse",addressErrorMsg:"Veuillez entrer une adresse valide.",addressLabel:"Adresse",cancelButton:"Annuler",cardNicknameFieldLabel:"Donnez un nom à cette carte (facultatif)",cardOptionsHeader:"Options de la carte",cityErrorMsg:"Veuillez entrer une ville valide.",cityLabel:"Ville",countryErrorMsg:"Veuillez sélectionner un pays.",countryLabel:"Pays",countryOptionCanada:"Canada",countryOptionUS:"États Unis",creditCardNumberFieldLabel:"Numéro de la carte",default:"Défaut",defaultCreditCardSelector:"Définir comme carte de crédit par défaut",editBillingAddressHeader:"Adresse de facturation",editCardCSRHeader:"Éditer cette carte de crédit",editCardHeader:"Modifier votre carte de crédit",editCardHint:"Vous pouvez changer les détails d'expiration et l'adresse de facturation :",errorMessage:"Désolé, une erreur s’est produite lors de la suppression de cette carte. Veuillez réessayer.",expiryMonthFieldLabel:"Mois d’expiration",expiryYearFieldLabel:"Année d’expiration",firstNameErrorMsg:"Veuillez entrer votre prénom.",firstNameLabel:"Prénom",formAccessibilityErrorMsg:"Erreur : Désolés, un problème est survenu. Veuillez vérifier les champs obligatoires et réessayer d'enregistrer.",lastNameErrorMsg:"Veuillez entrer votre nom de famille.",lastNameLabel:"Nom de famille",newBillingAddressHeader:"Ajouter une nouvelle adresse",newCardHeader:"Ajouter une nouvelle carte de crédit",newCardSubtext:"Nous acceptons les cartes suivantes :",nicknameLabel:"Donnez un nom à cette adresse (facultatif)",phoneExtensionErrorMsg:"Veuillez entrer un poste téléphonique valide.",phoneExtensionLabel:"Ext. (facultatif)",phoneNumberErrorMsg:"Veuillez entrer un numéro de téléphone de 10 chiffres, incluant l’indicatif régional.",phoneNumberLabel:"Numéro de téléphone",postalCodeErrorMsg:"Veuillez entrer un code postal valide.",postalCodeLabel:"Code postal",provinceErrorMsg:"Veuillez sélectionner une province.",provinceLabel:"Province",saveButton:"Enregistrer",saveButtonAriaLabel:"Enregistrer le nouveau mode de paiement",stateErrorMsg:"Veuillez sélectionner une state.",stateLabel:"State",zipCodeErrorMsg:"Veuillez entrer un code postal valide.",zipCodeLabel:"Code postal"};var lr="ccFormBtns__accxlv",dr="ccFormCancelBtn__accOa-",ur="ccFormAddTitle__accdov",mr="ccFormEditTitle__acc3-q",pr="ccFormEditHint__acclx7",hr="additionalCardDetails__accltl",gr="additionalCardDetailsLabel__acc1gG",Cr="isChecked__acc7GI",br="sr-only__accQ2z";class fr extends s.Component{constructor(e){super(e),this.creditCardFieldIFrame=null,this.handleIsDefaultChecked=(e,t)=>{this.setState({isDefaultChecked:!!t})},this.isDefaultCheckboxDisabled=()=>this.isEditForm()&&this.props.creditCardDetails&&this.props.creditCardDetails.isDefaultCreditCard,this.getCreditCardFormBaseProps=()=>{const{actionToPerform:e,addresses:t,creditCardDetails:a,hasCvv:r,hasCSRContext:s,locale:n,ccIframeDomain:o,isPaymentWebappEnabled:i}=this.props;return{actionToPerform:e,addresses:t,ccIframeDomain:o,creditCardDetails:a,hasCSRContext:s,hasCvv:r,isPaymentWebappEnabled:i,locale:n,onAddCreditCardError:this.handleAddCreditCardError,onAddCreditCardSuccess:this.handleAddCreditCardSubmit,onIframeError:this.handleIframeErrorModal,selectedAddress:this.state.selectedAddress,setSelectedAddress:this.onChangeCard}},this.onChangeCard=e=>{this.setState({selectedAddress:e})},this.isEditForm=()=>{const{actionToPerform:e}=this.props;return e===Fe.EDIT},this.scrollToCcFieldIframe=()=>{const e=document.getElementsByTagName("iframe")[0];if(!e)return;const t=e.getBoundingClientRect().top+window.pageYOffset-30;(0,r.eFH)(t)},this.handleAddCreditCardError=(e,t)=>{if(t&&this.scrollToCcFieldIframe(),!t&&this.state.hasAddressFieldErrors){const e=document.querySelector(".validation-error");if(!e)return;const t=e.getBoundingClientRect().top+window.pageYOffset;(0,r.eFH)(t)}e&&this.props.handleCreditCardSubmitError&&this.props.handleCreditCardSubmitError()},this.handleIframeErrorModal=()=>{this.props.onErrorModal&&this.props.onErrorModal()},this.getCcIframeUrlOrigin=()=>{const e=o.parse(this.props.ccIframeDomain);return`${e.protocol}//${e.host}`},this.handleFormError=(e,t)=>{this.creditCardFieldIFrame&&this.creditCardFieldIFrame.postMessage("",this.getCcIframeUrlOrigin());const a=document.getElementById("error-alert");a.innerText=this.messages.formAccessibilityErrorMsg,a.focus(),this.setState({hasAddressFieldErrors:!0})},this.handleAddCreditCardSubmit=e=>{const{billingAddress:t,isDefaultChecked:a}=this.state,r=Object.assign(Object.assign({},e),{isDefaultCreditCard:a});t&&this.props.handleCreditCardSubmit(r)},this.handleSubmit=(e,t,a)=>{let r;t.preventDefault();const{selectedAddress:s}=this.state,{creditCardDetails:n,locale:o}=this.props,i="en-CA"===o?Ve:Ue,c="en-CA"===o?ze:He;if(!this.isEditForm()&&s?r={addressLine1:s.addressLine1,city:s.city,countryCode:s.countryCode,countryName:Re[s.countryCode],firstName:s.firstName,friendlyName:s.friendlyName,isDefaultAddress:s.isDefaultAddress,lastName:s.lastName,postalCode:s.postalCode,primaryPhoneExtension:s.primaryPhoneExtension,primaryPhoneNumber:s.primaryPhoneNumber,regionCode:s.regionCode,regionName:"CA"===s.countryCode?i[s.regionCode]:c[s.regionCode],suite:s.suite}:(r=Object.assign(Object.assign({},n&&n.billingAddress),{addressLine1:a[Ke.addressLine1].value,city:a[Ke.city].value,countryCode:a[Ke.countryCode].value,countryName:Re[a[Ke.countryCode].value],firstName:a[Ke.firstName].value,friendlyName:a[Ke.friendlyName].value,isDefaultAddress:a.isDefault&&!!a.isDefault.value,lastName:a[Ke.lastName].value,postalCode:a[Ke.postalCode].value,primaryPhoneExtension:a[Ke.primaryPhoneExtension].value,primaryPhoneNumber:a[Ke.phoneNumber].value,regionCode:a[Ke.regionCode].value,regionName:"CA"===a[Ke.countryCode].value?i[a[Ke.regionCode].value]:c[a[Ke.regionCode].value]}),a[Ke.friendlyName].value||delete r.friendlyName),this.setState({billingAddress:r,hasAddressFieldErrors:!1}),!this.isEditForm()&&this.props.isPaymentWebappEnabled)this.creditCardFieldIFrame&&this.creditCardFieldIFrame.postMessage(r,this.getCcIframeUrlOrigin());else{const e=Object.assign(Object.assign({expirationMonth:parseInt(a.expirationMonth.value,10),expirationYear:parseInt(a.expirationYear.value,10),isDefaultCreditCard:this.isEditForm()&&n&&n.isDefaultCreditCard?n.isDefaultCreditCard:!!a.isDefault.value,last4Digits:this.isEditForm()&&n?n.last4Digits:a.shownCardNumber.value.slice(-4),type:this.isEditForm()&&n?n.type:a.ccType.value},a.shownCardNumber&&{number:a.shownCardNumber.value}),n&&{id:n.id});this.props.handleCreditCardSubmit(e,r)}},this.state={hasAddressFieldErrors:!1,isDefaultChecked:!!e.creditCardDetails&&!!e.creditCardDetails.isDefaultCreditCard}}componentDidMount(){if(this.props.isPaymentWebappEnabled){const e=document.querySelector(`iframe#${Za}`);this.creditCardFieldIFrame=e&&e.contentWindow}}render(){const{locale:e,actionToPerform:t,cancelCreditCard:a,formAriaLabel:n}=this.props;return this.messages=e.startsWith("fr")?cr:ir,s.createElement(s.Fragment,null,t===Fe.ADD?s.createElement("h2",{className:ur},this.messages.newCardHeader):s.createElement(s.Fragment,null,s.createElement("h2",{className:mr},this.props.hasCSRContext?this.messages.editCardCSRHeader:this.messages.editCardHeader),s.createElement("div",{className:pr},this.messages.editCardHint)),s.createElement("span",{role:"alert",className:br,id:"error-alert",tabIndex:-1}),s.createElement(r.l09,{action:"/",name:"ccForm",method:"post",onSubmit:this.handleSubmit,onError:this.handleFormError,scrollToErrors:!1,ariaLabel:n},s.createElement(or,Object.assign({},this.getCreditCardFormBaseProps())),s.createElement("div",{className:`${hr} ${!!this.state.isDefaultChecked&&Cr}`},s.createElement(r.XZJ,{disabled:this.isDefaultCheckboxDisabled(),className:gr,extraAttrs:{"data-automation":"isDefaultCheckbox"},label:this.messages.defaultCreditCardSelector,name:"isDefault",handleAsyncChange:this.handleIsDefaultChecked,tabIndex:0,value:this.state.isDefaultChecked?"checked":""})),s.createElement("div",{className:lr,"data-automation":"add-credit-card-form-btns"},s.createElement(r.zxk,{appearance:"secondary",extraAttrs:{"aria-label":this.messages.saveButtonAriaLabel,"data-automation":"cc-form-save-btn"},shouldFitContainer:!0,type:"submit"},this.messages.saveButton),s.createElement(r.zxk,{appearance:"transparent",className:dr,extraAttrs:{"aria-label":this.messages.cancelButton,"data-automation":"cc-form-cancel-btn"},onClick:a,shouldFitContainer:!0,type:"submit"},this.messages.cancelButton))))}}fr.defaultProps={actionToPerform:Fe.ADD};var Er;!function(e){e.extraLarge="extraLarge",e.large="large",e.medium="medium",e.small="small",e.extraSmall="extraSmall"}(Er||(Er={}));var yr=Er;const vr=(e,t)=>!!t&&(e===t||vr(e,t.parentNode)),Nr=["touchstart","mousedown"],Ar=e=>Nr.forEach(t=>document.addEventListener(t,e,{passive:!1})),wr=e=>Nr.forEach(t=>document.removeEventListener(t,e));class Sr extends s.Component{constructor(){super(...arguments),this.handleClickAway=e=>{var t,a;if(e.defaultPrevented)return;const r=c.findDOMNode(this);document.documentElement.contains(e.target)&&(vr(r,e.target)||(e.target.classList.contains("x-global-overlay")&&e.preventDefault(),null===(a=(t=this.props).onClickAway)||void 0===a||a.call(t,e)))}}componentDidMount(){this.props.onClickAway&&this.props.active&&Ar(this.handleClickAway)}componentDidUpdate(e){this.props.active!==e.active&&(wr(this.handleClickAway),!0===this.props.active&&this.props.onClickAway&&Ar(this.handleClickAway))}componentWillUnmount(){wr(this.handleClickAway)}render(){return this.props.children}}var Lr="flyoutMenuContent__accIIk";const Mr=e=>{let{accountDashboardUrl:t,cieServiceUrl:a,display:r,locale:n,onSignOutSuccess:o,onMenuClose:i,flyoutMenuButtonRef:c}=e;return s.createElement("div",{style:{display:r?"block":"none"},className:`${Lr} ${De}`,"data-automation":"account-flyout-menu-content"},s.createElement(Be,{cieServiceUrl:a,accountDashboardUrl:t,locale:n,isFlyoutMenu:!0,onSignOutSuccess:o,onMenuClose:i,flyoutMenuButtonRef:c}))},xr=(e,t)=>s.createElement(W,{locale:t,firstName:e,profileInitialClassName:$.flyoutContainerProfile}),Ir=e=>{let{accountDashboardUrl:t,cieServiceUrl:a,locale:o,firstName:i,onSignOutSuccess:c,toggleFlyoutOverlay:l,screenBreakpoint:d,ariaLabel:u=""}=e;const m=(0,s.useRef)(null),[p,h]=s.useState(!1),g=t+"/"+o,C=s.useCallback(()=>{d===yr.small?Y("Greetings; SignedIn"):Y("Icon; Signed In")},[d]),b=s.useCallback(()=>{h(!p),l&&l(!p),p||n.N8.customLink("Nav:account:Click")},[p,l]),f=s.useCallback(()=>{p&&(h(!1),l&&l(!1))},[p,l]);return d!==yr.extraSmall&&d!==yr.small?s.createElement(Sr,{active:p,onClickAway:f},s.createElement("div",{className:$.flyoutMenuWrapper},s.createElement("div",{className:$.flyoutMenu,"data-automation":"flyout-menu"},s.createElement("button",{ref:m,className:$.flyoutMenuButton,onClick:b,"data-automation":"greeting-link","aria-label":u},s.createElement("span",{className:$.greetingMessageWrapper},xr(i,o)),s.createElement("span",{className:$.flyoutChevronContainer},s.createElement(r._ME,{color:"white",className:$.flyoutMenuChevron,viewBox:"0 0 32 32"})))),((e,t,a,r,n,o,i)=>s.createElement(Mr,{cieServiceUrl:t,display:a,locale:r,accountDashboardUrl:e,onSignOutSuccess:n,onMenuClose:o,flyoutMenuButtonRef:i}))(t,a,p,o,c,f,m))):s.createElement("div",{className:$.myAccountLinkContainer},s.createElement("a",{className:$.myAccountLink,"data-automation":"my-account-link-flyout",href:g,onClick:C,"aria-label":u},s.createElement("div",{className:$.iconGreetingLinkContainer},(e=>e?s.createElement(U,{firstName:e,isAriaHidden:!0}):s.createElement("span",{className:$.unknownUserIconContainer,"data-automation":"authenticated-unknown-user"},s.createElement(O,{className:$.authenticatedUnknown,isAriaHidden:!0})))(i)),s.createElement("div",{className:$.greetingMenuContainer},xr(i,o))))};s.Component;s.Component;s.Component;var _r,Pr;s.Component;!function(e){e.ACCOUNT_PERSONAL_DETAILS_EDIT_NAME="ACCOUNT_PERSONAL_DETAILS_EDIT_NAME"}(_r||(_r={}));class kr extends r.VjB{constructor(e){super(kr.customerIdCookieName,e),this.secure=!0}}kr.customerIdCookieName="cid",function(e){e.AUTHENTICATED="AUTHENTICATED",e.RECOGNIZED="RECOGNIZED",e.UNAUTHENTICATED="UNAUTHENTICATED"}(Pr||(Pr={}));const Tr=e=>{let t;return e&&e===yr.extraSmall&&(t="Icon; Anonymous"),t},Dr=e=>{let{accountDashboardUrl:t,cieServiceUrl:a,locale:r,toggleFlyoutOverlay:n,screenBreakpoint:o,redirectUrl:i,onSignOutSuccess:c}=e;const l=m.getCustomerIdCookie(),[d,u]=s.useState(l&&l.firstName?l.firstName:""),[p,h]=s.useState(!1),[g,C]=s.useState(!1),b=s.useCallback(()=>q(void 0,void 0,void 0,function*(){c&&(yield c()),n&&n(!1);const e=!!m.getCustomerIdCookie()&&(m.getCustomerIdCookie()||{}).authenticationState!==Pr.UNAUTHENTICATED,t=m.isUserSignedIn();C(e),h(t)}),[c,n]),f=s.useCallback(()=>{const e=m.getCustomerIdCookie();u(e&&e.firstName?e.firstName:"")},[d]);s.useEffect(()=>{"undefined"!=typeof window&&window.addEventListener(_r.ACCOUNT_PERSONAL_DETAILS_EDIT_NAME,f);const e=!!m.getCustomerIdCookie()&&(m.getCustomerIdCookie()||{}).authenticationState!==Pr.UNAUTHENTICATED,t=m.isUserSignedIn();return C(e),h(t),()=>{"undefined"!=typeof window&&window.removeEventListener(_r.ACCOUNT_PERSONAL_DETAILS_EDIT_NAME,f)}},[]);const E=r.startsWith("fr")?D:T;return g||p?s.createElement(Ir,{accountDashboardUrl:t,cieServiceUrl:a,locale:r,firstName:d,toggleFlyoutOverlay:n,onSignOutSuccess:b,screenBreakpoint:o,ariaLabel:E.signInNav}):s.createElement(B,{locale:r,cieServiceUrl:a,redirectUrl:i,hiddenAnalyticsLabel:Tr(o)})};var Br;!function(e){e.Primary="primary",e.Secondary="secondary",e.Tertiary="tertiary",e.Transparent="transparent"}(Br||(Br={}));class $r extends me{constructor(e){super(e)}getCustomerInfo(e){const t=Object.create(null,{handleError:{get:()=>super.handleError}});return q(this,void 0,void 0,function*(){const a=o.parse(`${this.apiUrl}/customer`),r=o.format(a),s=yield pe(r,{credentials:"include",headers:{Accept:"application/json",Authorization:`bearer ${e.accessToken}`},method:"get"});let n;try{n=yield s.json()}catch(e){const t=e;return Promise.reject(new Z(r,t.message,t))}if(s.status===J.OK.valueOf()){return{accountCreatedDate:n.accountCreatedDate,defaultLanguage:n.defaultLanguage,email:n.email,firstName:n.firstName,hasEmailVerified:n.hasEmailVerified,hasPhoneNumberVerified:n.hasPhoneNumberVerified,id:n.id,lastName:n.lastName,passwordDateLastChanged:n.passwordDateLastChanged,phoneNumber:n.phoneNumber||"",ucpID:n.ucpID,zipCode:n.zipCode}}return t.handleError.call(this,s.status,r,n.error)})}updateCustomerPasswordInfo(e){const t=Object.create(null,{handleError:{get:()=>super.handleError}});return q(this,void 0,void 0,function*(){const a=o.parse(`${this.apiUrl}/customers/${e.customerId}/password`),r=o.format(a),s=yield pe(r,{body:JSON.stringify({currentPassword:e.currentPassword,locale:e.locale,password:e.password}),credentials:"include",headers:{Accept:"application/vnd.bestbuy+json",Authorization:`bearer ${e.accessToken}`,"Content-Type":"application/vnd.bestbuy+json"},method:"put"});let n;try{n=yield s.json()}catch(e){const t=e;return Promise.reject(new Z(r,t.message,t))}if(s.status===J.OK.valueOf()){return{passwordDateLastChanged:n.passwordDateLastChanged}}return n.error_list?t.handleError.call(this,s.status,r,n.error,n.error_list):t.handleError.call(this,s.status,r,n.error)})}updateCustomerInfo(e){const t=Object.create(null,{handleError:{get:()=>super.handleError}});return q(this,void 0,void 0,function*(){const a=o.parse(`${this.apiUrl}/customers/${e.customerId}`),r=o.format(a),s=yield pe(r,{body:JSON.stringify({defaultLanguage:e.defaultLanguage,email:e.email,firstName:e.firstName,lastName:e.lastName,locale:e.locale,password:e.password,phoneNumber:e.phoneNumber,zipCode:e.zipCode}),credentials:"include",headers:{Accept:"application/vnd.bestbuy+json",Authorization:`bearer ${e.accessToken}`,"Content-Type":"application/vnd.bestbuy+json"},method:"put"});let n;try{n=yield s.json()}catch(e){const t=e;return Promise.reject(new Z(r,t.message,t))}if(s.status===J.OK.valueOf()){return{defaultLanguage:n.defaultLanguage,email:n.email,firstName:n.firstName,id:n.id,lastName:n.lastName,phoneNumber:n.phoneNumber,zipCode:n.zipCode}}return n.error_list?t.handleError.call(this,s.status,r,n.error,n.error_list):t.handleError.call(this,s.status,r,n.error)})}}var Or,Fr;!function(e){e.Active="ACTIVE",e.Suspended="SUSPENDED",e.Cancelled="CANCELLED"}(Or||(Or={})),function(e){e.A="A",e.M="M",e.LS="LS"}(Fr||(Fr={}));class Vr extends r.VjB{constructor(e){super(Vr.createAccountCheckoutCookieName,e),this.secure=!0}}Vr.createAccountCheckoutCookieName="createAccountCheckout";const Ur=["https://cdn.cookielaw.org/consent/3c45100b-d4c0-4bf2-8e0b-d709c9ee9a25","https://cdn.cookielaw.org/scripttemplates/otSDKStub"];var zr;!function(e){e.essential="C0001",e.performance="C0002",e.functional="C0003",e.targeting="C0004"}(zr||(zr={}));const Hr=!0,Rr=!1,jr=!1,Wr=!1,Yr=["1","0"],Kr=()=>{const e=r.lew.getCookie("OptanonConsent");if(!e){return Xr("C0001:1,C0002:0,C0003:0,C0004:0")}const t=new URLSearchParams(e.value).get("groups")||"";return Xr(t)},Xr=e=>{const t={};return e.split(",").forEach(e=>{const a=e.split(":");t[a[0]]=a[1]}),t};var qr={getCookieConsentGroups:Kr,getEssentialCookieConsentStatus:()=>{const e=Kr();return Yr.indexOf(null==e?void 0:e[zr.essential])>-1?!!Number(null==e?void 0:e[zr.essential]):Hr},getFunctionalCookieConsentStatus:()=>{const e=Kr();return Yr.indexOf(null==e?void 0:e[zr.functional])>-1?!!Number(null==e?void 0:e[zr.functional]):Rr},getIsOneTrustAlertBoxClosed:()=>!!r.lew.getCookie("OptanonAlertBoxClosed"),getIsOneTrustEnabled:()=>"undefined"!=typeof window&&"undefined"!=typeof document&&Ur.every(e=>document.querySelector(`script[src^="${e}"]`)),getPerformanceCookieConsentStatus:()=>{const e=Kr();return Yr.indexOf(null==e?void 0:e[zr.performance])>-1?!!Number(null==e?void 0:e[zr.performance]):jr},getTargetingCookieConsentStatus:()=>{const e=Kr();return Yr.indexOf(null==e?void 0:e[zr.targeting])>-1?!!Number(null==e?void 0:e[zr.targeting]):Wr}}}}]);